<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyse Juridique : Article 23 & Principe de Standstill</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Chosen Palette: Legal Neutral -->
    <!-- Colors: 
         Background: #F9FAFB (Cool Gray 50) - Warm Neutral base
         Primary Text: #1F2937 (Gray 800)
         Accent Blue (Court): #3B82F6 (Blue 500)
         Alert Red (Danger/Chaos): #EF4444 (Red 500)
         Warning Yellow (Uncertainty): #F59E0B (Amber 500)
    -->

    <!-- Application Structure Plan: 
         1. Hero Section: "L'√âp√©e de Damocl√®s" - Immediate visual impact regarding the threat.
         2. Context & Timeline (Horizontal Scroll/Steps): Visualizes the long wait from Oct 2025 to End 2026.
         3. The Mechanics (Interactive Cards): Explains "Standstill" and "Article 23" simply.
         4. Scenario Simulator (The Core Interaction): A toggle switch that changes the entire dashboard state between "Status Quo" and "Annulation (Chaos)". 
            - Updates text, budget charts, and risk gauges dynamically.
         5. Sector Impact (Education Permanente): Specific focus on the moratorium consequences.
    -->

    <!-- Visualization & Content Choices:
         1. Timeline: HTML/CSS Flexbox Timeline. Goal: Show the long duration of uncertainty.
         2. Risk Gauge (Chart.js Doughnut): Visualizes the "Threat Level".
         3. Budgetary Impact (Chart.js Bar): Compares "Current Budget" vs "Potential Retroactive Cost".
         4. Sector Status (HTML/CSS Grid): Visualizes "Frozen" vs "Active" projects using CSS classes.
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #F9FAFB; }
        
        /* Chart Container Styling per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        .tab-active {
            border-bottom: 2px solid #3B82F6;
            color: #1d4ed8;
            font-weight: 600;
        }

        .tab-inactive {
            color: #6b7280;
        }

        .scenario-card {
            transition: all 0.3s ease;
        }
        
        /* Custom scrollbar for timeline */
        .timeline-scroll::-webkit-scrollbar {
            height: 8px;
        }
        .timeline-scroll::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        .timeline-scroll::-webkit-scrollbar-thumb {
            background: #d1d5db; 
            border-radius: 4px;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Navigation / Header -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <span class="text-2xl">‚öñÔ∏è</span>
                    <h1 class="text-xl font-bold text-gray-900 tracking-tight">Observatoire Article 23</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <button onclick="switchTab('contexte')" id="nav-contexte" class="tab-active py-2 px-1 text-sm">Le Contexte</button>
                    <button onclick="switchTab('simulateur')" id="nav-simulateur" class="tab-inactive py-2 px-1 text-sm">Simulateur d'Impact</button>
                    <button onclick="switchTab('secteur')" id="nav-secteur" class="tab-inactive py-2 px-1 text-sm">√âducation Permanente</button>
                </div>
            </div>
            <!-- Mobile Nav -->
            <div class="flex md:hidden justify-around pb-2">
                <button onclick="switchTab('contexte')" class="text-xs font-medium text-blue-600">Contexte</button>
                <button onclick="switchTab('simulateur')" class="text-xs text-gray-500">Simulateur</button>
                <button onclick="switchTab('secteur')" class="text-xs text-gray-500">Secteur</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- SECTION 1: CONTEXTE (Default) -->
        <section id="contexte" class="space-y-8 animate-fade-in">
            <div class="text-center space-y-4 max-w-3xl mx-auto">
                <div class="inline-block px-3 py-1 bg-amber-100 text-amber-800 rounded-full text-sm font-semibold mb-2">Recours en cours</div>
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900">L'√âp√©e de Damocl√®s</h2>
                <p class="text-lg text-gray-600 leading-relaxed">
                    Une analyse interactive de la situation juridique actuelle concernant le <strong>Principe de Standstill</strong> (Article 23). 
                    Le recours introduit le 29 octobre 2025 plonge le secteur de l'√âducation Permanente en F√©d√©ration Wallonie-Bruxelles 
                    dans une incertitude majeure jusqu'√† l'arr√™t attendu fin 2026.
                </p>
            </div>

            <!-- Key Metrics Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center text-center">
                    <span class="text-4xl mb-2">üìÖ</span>
                    <h3 class="font-semibold text-gray-900">Date du Recours</h3>
                    <p class="text-blue-600 font-bold text-xl">29/10/2025</p>
                    <p class="text-xs text-gray-500 mt-2">D√©but de la p√©riode d'ins√©curit√©</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center text-center">
                    <span class="text-4xl mb-2">‚è≥</span>
                    <h3 class="font-semibold text-gray-900">Arr√™t Attendu</h3>
                    <p class="text-amber-600 font-bold text-xl">Fin 2026</p>
                    <p class="text-xs text-gray-500 mt-2">~14 mois d'attente</p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center text-center">
                    <span class="text-4xl mb-2">üõë</span>
                    <h3 class="font-semibold text-gray-900">Situation Actuelle</h3>
                    <p class="text-red-600 font-bold text-xl">Moratoire</p>
                    <p class="text-xs text-gray-500 mt-2">Gel des reconnaissances</p>
                </div>
            </div>

            <!-- Interactive Timeline -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                <h3 class="text-xl font-bold mb-4">Chronologie de la Proc√©dure</h3>
                <p class="text-gray-600 mb-6 text-sm">D√©filez horizontalement pour voir les √©tapes cl√©s de la proc√©dure devant la Cour Constitutionnelle.</p>
                
                <div class="timeline-scroll overflow-x-auto pb-4">
                    <div class="flex min-w-[800px] relative">
                        <!-- Line -->
                        <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-200 -translate-y-1/2 z-0"></div>
                        
                        <!-- Step 1 -->
                        <div class="relative z-10 flex-1 flex flex-col items-center group cursor-pointer hover:scale-105 transition-transform">
                            <div class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold text-xs border-4 border-white shadow">1</div>
                            <div class="mt-4 text-center px-2">
                                <span class="block text-xs font-bold text-gray-500">29 Oct 2025</span>
                                <span class="block text-sm font-bold text-gray-900">Introduction</span>
                                <span class="block text-xs text-gray-500 mt-1">D√©p√¥t du recours</span>
                            </div>
                        </div>

                        <!-- Step 2 -->
                        <div class="relative z-10 flex-1 flex flex-col items-center group cursor-pointer hover:scale-105 transition-transform">
                            <div class="w-8 h-8 rounded-full bg-amber-500 text-white flex items-center justify-center font-bold text-xs border-4 border-white shadow">2</div>
                            <div class="mt-4 text-center px-2">
                                <span class="block text-xs font-bold text-gray-500">Nov '25 - Juin '26</span>
                                <span class="block text-sm font-bold text-gray-900">Instruction</span>
                                <span class="block text-xs text-gray-500 mt-1">√âchange de m√©moires</span>
                            </div>
                        </div>

                        <!-- Step 3 -->
                        <div class="relative z-10 flex-1 flex flex-col items-center group cursor-pointer hover:scale-105 transition-transform">
                            <div class="w-8 h-8 rounded-full bg-gray-400 text-white flex items-center justify-center font-bold text-xs border-4 border-white shadow">3</div>
                            <div class="mt-4 text-center px-2">
                                <span class="block text-xs font-bold text-gray-500">Sept 2026</span>
                                <span class="block text-sm font-bold text-gray-900">Audience</span>
                                <span class="block text-xs text-gray-500 mt-1">Plaidoiries publiques</span>
                            </div>
                        </div>

                        <!-- Step 4 -->
                        <div class="relative z-10 flex-1 flex flex-col items-center group cursor-pointer hover:scale-105 transition-transform">
                            <div class="w-8 h-8 rounded-full bg-red-500 text-white flex items-center justify-center font-bold text-xs border-4 border-white shadow">4</div>
                            <div class="mt-4 text-center px-2">
                                <span class="block text-xs font-bold text-gray-500">Fin 2026</span>
                                <span class="block text-sm font-bold text-gray-900">Arr√™t</span>
                                <span class="block text-xs text-gray-500 mt-1">Annulation ou Rejet</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- What is Article 23? -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-blue-50 p-6 rounded-xl border border-blue-100">
                    <h3 class="text-lg font-bold text-blue-900 mb-2">üìú Article 23 & Standstill</h3>
                    <p class="text-sm text-blue-800 leading-relaxed mb-4">
                        L'article 23 de la Constitution garantit le droit √† une vie conforme √† la dignit√© humaine. Le <strong>"principe de standstill"</strong> (ou effet cliquet) interdit au l√©gislateur de r√©duire significativement le niveau de protection sociale existant sans motifs d'int√©r√™t g√©n√©ral imp√©rieux.
                    </p>
                    <div class="bg-white bg-opacity-60 p-3 rounded text-xs text-blue-900 font-mono">
                        "On ne peut pas reculer sur les droits acquis."
                    </div>
                </div>
                <div class="bg-red-50 p-6 rounded-xl border border-red-100">
                    <h3 class="text-lg font-bold text-red-900 mb-2">‚öîÔ∏è L'Enjeu du Recours</h3>
                    <p class="text-sm text-red-800 leading-relaxed mb-4">
                        Si la Cour juge que la nouvelle l√©gislation ou les coupes budg√©taires violent le standstill, l'annulation pourrait √™tre <strong>r√©troactive</strong>. Cela signifie que l'√âtat devrait payer tout ce qu'il a "√©conomis√©" ill√©galement.
                    </p>
                    <div class="bg-white bg-opacity-60 p-3 rounded text-xs text-red-900 font-mono">
                        Risque = Indemnisation R√©troactive + Chaos Budg√©taire.
                    </div>
                </div>
            </div>
            
            <div class="flex justify-center pt-4">
                <button onclick="switchTab('simulateur')" class="bg-gray-900 text-white px-6 py-3 rounded-lg shadow hover:bg-gray-800 transition flex items-center gap-2">
                    Explorer les Sc√©narios Futurs <span class="text-lg">‚ûî</span>
                </button>
            </div>
        </section>


        <!-- SECTION 2: SIMULATEUR (Interactive) -->
        <section id="simulateur" class="hidden space-y-8 animate-fade-in">
            <div class="text-center max-w-3xl mx-auto mb-8">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Simulateur de D√©cision</h2>
                <p class="text-gray-600">
                    Utilisez le s√©lecteur ci-dessous pour visualiser l'impact des deux issues possibles de l'arr√™t attendu fin 2026. 
                    Observez comment les indicateurs de risque et budg√©taires r√©agissent.
                </p>
            </div>

            <!-- The Toggle Controls -->
            <div class="flex justify-center mb-8">
                <div class="bg-gray-200 p-1 rounded-lg flex shadow-inner">
                    <button onclick="setScenario('rejet')" id="btn-rejet" class="px-6 py-2 rounded-md text-sm font-semibold transition-all duration-300 bg-white text-gray-800 shadow">
                        Sc√©nario A : Rejet du Recours
                    </button>
                    <button onclick="setScenario('annulation')" id="btn-annulation" class="px-6 py-2 rounded-md text-sm font-semibold text-gray-500 hover:text-gray-700 transition-all duration-300">
                        Sc√©nario B : Annulation (Chaos)
                    </button>
                </div>
            </div>

            <!-- Dashboard Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- Left: Textual Analysis -->
                <div class="space-y-6">
                    <div id="scenario-description-card" class="bg-white p-6 rounded-xl shadow-sm border-l-4 border-green-500 transition-colors duration-500">
                        <h3 id="scenario-title" class="text-xl font-bold text-gray-900 mb-2">Status Quo Confirm√©</h3>
                        <p id="scenario-text" class="text-gray-600 leading-relaxed">
                            La Cour Constitutionnelle rejette le recours. Les r√©formes actuelles sont valid√©es. Le moratoire est lev√©, mais sous les nouvelles conditions restrictives. Pas d'impact budg√©taire r√©troactif.
                        </p>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                        <h4 class="font-semibold text-gray-800 mb-4">Cons√©quences Directes</h4>
                        <ul id="consequences-list" class="space-y-3">
                            <li class="flex items-start gap-3">
                                <span class="text-green-500 mt-1">‚úî</span>
                                <span class="text-sm text-gray-600">S√©curit√© juridique r√©tablie.</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <span class="text-green-500 mt-1">‚úî</span>
                                <span class="text-sm text-gray-600">Budget 2027 pr√©visible.</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <span class="text-green-500 mt-1">‚úî</span>
                                <span class="text-sm text-gray-600">Reprise des dossiers en attente.</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Right: Charts -->
                <div class="space-y-6">
                    <!-- Gauge Chart: Risk Level -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center">
                        <h4 class="font-semibold text-gray-800 mb-2 text-sm uppercase tracking-wide">Niveau de Risque Budg√©taire</h4>
                        <div class="chart-container" style="height: 200px;">
                            <canvas id="riskGauge"></canvas>
                        </div>
                        <p id="risk-label" class="text-center font-bold text-green-600 mt-2">Faible</p>
                    </div>

                    <!-- Bar Chart: Financial Impact -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                        <h4 class="font-semibold text-gray-800 mb-2 text-sm uppercase tracking-wide">Impact Financier (Hypoth√©tique)</h4>
                        <div class="chart-container">
                            <canvas id="budgetChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- SECTION 3: SECTEUR EDUCATION PERMANENTE -->
        <section id="secteur" class="hidden space-y-8 animate-fade-in">
            <div class="text-center max-w-3xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Le Moratoire & L'√âducation Permanente</h2>
                <p class="text-gray-600">
                    En attendant l'arr√™t, le secteur vit une p√©riode de gel administratif. 
                    Voici l'√©tat des lieux pour les associations et les op√©rateurs de terrain en F√©d√©ration Wallonie-Bruxelles.
                </p>
            </div>

            <!-- Status Indicators -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div class="text-xs font-bold text-gray-400 uppercase">Nouvelles demandes</div>
                    <div class="text-lg font-bold text-red-600 mt-1 flex items-center gap-2">
                        <span>‚õî Bloqu√©es</span>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div class="text-xs font-bold text-gray-400 uppercase">Subsides Index√©s</div>
                    <div class="text-lg font-bold text-amber-600 mt-1 flex items-center gap-2">
                        <span>‚ö†Ô∏è Incertains</span>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div class="text-xs font-bold text-gray-400 uppercase">Dossiers en cours</div>
                    <div class="text-lg font-bold text-blue-600 mt-1 flex items-center gap-2">
                        <span>‚è∏Ô∏è Suspendus</span>
                    </div>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <div class="text-xs font-bold text-gray-400 uppercase">Droits acquis</div>
                    <div class="text-lg font-bold text-green-600 mt-1 flex items-center gap-2">
                        <span>‚úÖ Maintenus</span>
                    </div>
                </div>
            </div>

            <!-- Detailed Impact Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">Pourquoi un moratoire ?</h3>
                    <p class="text-gray-600 mb-4 text-sm leading-relaxed">
                        L'administration anticipe le risque d'annulation. Si la Cour annule la base l√©gale actuelle, toute nouvelle reconnaissance accord√©e aujourd'hui pourrait devenir ill√©gale ou infond√©e demain.
                    </p>
                    <div class="bg-amber-50 border-l-4 border-amber-400 p-4">
                        <p class="text-sm text-amber-800 font-medium">
                            "Le principe de prudence paralyse l'innovation dans le secteur."
                        </p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">L'√âp√©e de Damocl√®s sur le Budget</h3>
                    <p class="text-gray-600 mb-4 text-sm leading-relaxed">
                        Si l'arr√™t impose une indemnisation r√©troactive (remboursement des montants "√©conomis√©s" sur le dos du secteur), la FWB devra trouver des liquidit√©s imm√©diatement.
                    </p>
                    <ul class="space-y-2 text-sm text-gray-700">
                        <li class="flex items-center gap-2">
                            <span class="w-2 h-2 bg-red-500 rounded-full"></span>
                            Impact potentiel sur d'autres budgets (Culture, Jeunesse).
                        </li>
                        <li class="flex items-center gap-2">
                            <span class="w-2 h-2 bg-red-500 rounded-full"></span>
                            Risque de coupes drastiques en 2027 pour compenser.
                        </li>
                    </ul>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-900 text-gray-400 py-8 mt-12">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <p class="text-sm">Analyse bas√©e sur le recours introduit le 29/10/2025.</p>
            <p class="text-xs mt-2">Cet outil est une simulation √† but informatif. Les projections budg√©taires sont hypoth√©tiques.</p>
        </div>
    </footer>

    <script>
        // State Management
        let currentScenario = 'rejet'; // 'rejet' or 'annulation'

        // Chart Instances
        let riskGaugeChart = null;
        let budgetBarChart = null;

        // --- Data Definitions ---
        const scenarioData = {
            rejet: {
                title: "Status Quo Confirm√©",
                color: "green",
                text: "La Cour Constitutionnelle rejette le recours. Les r√©formes actuelles sont valid√©es. Le moratoire est lev√©, mais sous les nouvelles conditions restrictives. Pas d'impact budg√©taire r√©troactif.",
                consequences: [
                    { icon: "‚úî", text: "S√©curit√© juridique r√©tablie", color: "text-green-500" },
                    { icon: "‚úî", text: "Budget 2027 pr√©visible", color: "text-green-500" },
                    { icon: "‚úî", text: "Reprise des dossiers en attente", color: "text-green-500" }
                ],
                riskLevel: 10, // Low risk
                riskLabel: "Faible (Stable)",
                budgetData: [100, 105, 110] // Normal growth
            },
            annulation: {
                title: "Annulation & Chaos",
                color: "red",
                text: "La Cour annule la r√©forme pour violation du standstill. L'√âtat doit compenser r√©troactivement les pertes subies par le secteur depuis la mise en ≈ìuvre de la mesure. Le budget explose.",
                consequences: [
                    { icon: "üí•", text: "Indemnisation R√©troactive exig√©e", color: "text-red-600" },
                    { icon: "üìâ", text: "D√©s√©quilibre budg√©taire imm√©diat", color: "text-red-600" },
                    { icon: "üõë", text: "Incertitude juridique totale pour 2027", color: "text-red-600" }
                ],
                riskLevel: 90, // High risk
                riskLabel: "Critique (Budget Explos√©)",
                budgetData: [100, 105, 145] // Spike in 2027 due to retroactivity
            }
        };

        // --- Navigation Logic ---
        function switchTab(tabId) {
            // Hide all sections
            ['contexte', 'simulateur', 'secteur'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
                // Update nav classes
                const navBtn = document.getElementById(`nav-${id}`);
                if(navBtn) {
                    navBtn.classList.remove('tab-active', 'text-blue-600');
                    navBtn.classList.add('tab-inactive', 'text-gray-500');
                }
            });

            // Show selected section
            document.getElementById(tabId).classList.remove('hidden');
            
            // Update active nav
            const activeBtn = document.getElementById(`nav-${tabId}`);
            if(activeBtn) {
                activeBtn.classList.remove('tab-inactive', 'text-gray-500');
                activeBtn.classList.add('tab-active', 'text-blue-600');
            }

            // Init charts if Simulateur is chosen and charts not created yet
            if (tabId === 'simulateur') {
                setTimeout(() => {
                    initCharts();
                }, 100);
            }
        }

        // --- Scenario Logic ---
        function setScenario(scenario) {
            currentScenario = scenario;
            const data = scenarioData[scenario];

            // Update Buttons
            const btnRejet = document.getElementById('btn-rejet');
            const btnAnnulation = document.getElementById('btn-annulation');
            const card = document.getElementById('scenario-description-card');

            if (scenario === 'rejet') {
                btnRejet.className = "px-6 py-2 rounded-md text-sm font-semibold transition-all duration-300 bg-white text-gray-800 shadow";
                btnAnnulation.className = "px-6 py-2 rounded-md text-sm font-semibold text-gray-500 hover:text-gray-700 transition-all duration-300";
                card.className = "bg-white p-6 rounded-xl shadow-sm border-l-4 border-green-500 transition-colors duration-500";
            } else {
                btnAnnulation.className = "px-6 py-2 rounded-md text-sm font-semibold transition-all duration-300 bg-white text-red-700 shadow";
                btnRejet.className = "px-6 py-2 rounded-md text-sm font-semibold text-gray-500 hover:text-gray-700 transition-all duration-300";
                card.className = "bg-white p-6 rounded-xl shadow-sm border-l-4 border-red-500 transition-colors duration-500";
            }

            // Update Text Content
            document.getElementById('scenario-title').innerText = data.title;
            document.getElementById('scenario-text').innerText = data.text;
            document.getElementById('risk-label').innerText = data.riskLabel;
            document.getElementById('risk-label').className = `text-center font-bold mt-2 ${scenario === 'rejet' ? 'text-green-600' : 'text-red-600'}`;

            // Update List
            const list = document.getElementById('consequences-list');
            list.innerHTML = '';
            data.consequences.forEach(item => {
                const li = document.createElement('li');
                li.className = "flex items-start gap-3 animate-fade-in";
                li.innerHTML = `<span class="${item.color} mt-1 text-lg">${item.icon}</span><span class="text-sm text-gray-600">${item.text}</span>`;
                list.appendChild(li);
            });

            // Update Charts
            updateCharts(data);
        }

        // --- Chart Implementation ---
        function initCharts() {
            if (riskGaugeChart || budgetBarChart) return; // Already initialized

            // 1. Risk Gauge (Doughnut)
            const ctxGauge = document.getElementById('riskGauge').getContext('2d');
            riskGaugeChart = new Chart(ctxGauge, {
                type: 'doughnut',
                data: {
                    labels: ['Risque', 'S√©curit√©'],
                    datasets: [{
                        data: [10, 90], // Default 'Rejet' state
                        backgroundColor: ['#10B981', '#E5E7EB'], // Green & Gray
                        borderWidth: 0,
                        cutout: '75%'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: { enabled: false },
                        legend: { display: false }
                    },
                    animation: { animateRotate: true, animateScale: true }
                }
            });

            // 2. Budget Chart (Bar)
            const ctxBar = document.getElementById('budgetChart').getContext('2d');
            budgetBarChart = new Chart(ctxBar, {
                type: 'bar',
                data: {
                    labels: ['2025 (Actuel)', '2026 (Attente)', '2027 (Post-Arr√™t)'],
                    datasets: [{
                        label: 'Indice de Co√ªt Budg√©taire',
                        data: [100, 105, 110], // Default
                        backgroundColor: '#3B82F6',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, display: false },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function updateCharts(data) {
            if (!riskGaugeChart || !budgetBarChart) return;

            // Update Gauge
            riskGaugeChart.data.datasets[0].data = [data.riskLevel, 100 - data.riskLevel];
            riskGaugeChart.data.datasets[0].backgroundColor = currentScenario === 'rejet' 
                ? ['#10B981', '#E5E7EB'] // Green
                : ['#EF4444', '#E5E7EB']; // Red
            riskGaugeChart.update();

            // Update Bar
            budgetBarChart.data.datasets[0].data = data.budgetData;
            budgetBarChart.data.datasets[0].backgroundColor = currentScenario === 'rejet' 
                ? '#3B82F6' // Blue
                : ['#3B82F6', '#3B82F6', '#EF4444']; // Last bar red for impact
            budgetBarChart.update();
        }

        // Initialize default tab (optional logic if we want to ensure context loads first)
        // Note: Charts are lazy-loaded when tab is clicked.
    </script>
</body>
</html>
