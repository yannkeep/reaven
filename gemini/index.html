<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>BROL 2.0 ‚Äì Dashboard Central | Le Reste Peut Attendre</title>
  <meta name="description" content="Acc√©dez au Hub BROL 2.0. Fichiers confidentiels, IA fictives, univers √©tendus et jeux. Interface d'administration niveau 0.">
  <meta name="robots" content="index, follow">
  <meta name="author" content="Yann Keep">
  
  <link rel="canonical" href="https://yannkeep.github.io/base/" />

  <meta property="og:title" content="BROL 2.0 ‚Äì Dashboard Central" />
  <meta property="og:description" content="Hub centralis√© : modules IA, fichiers classifi√©s et jeux narratifs. Entrez dans le syst√®me." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://yannkeep.github.io/base/" />
  <meta property="og:image" content="https://yannkeep.github.io/base/assets/cover-brol.jpg" />
  <meta property="og:site_name" content="Le Reste Peut Attendre" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="BROL 2.0 ‚Äì Dashboard Central">
  <meta name="twitter:description" content="Hub centralis√© : modules IA, fichiers classifi√©s et jeux narratifs. Entrez dans le syst√®me.">
  <meta name="twitter:image" content="https://yannkeep.github.io/base/assets/cover-brol.jpg">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "BROL 2.0 - Dashboard Central",
    "url": "https://yannkeep.github.io/base/",
    "applicationCategory": "UtilitiesApplication",
    "operatingSystem": "Web",
    "author": {
      "@type": "Person",
      "name": "Yann Keep",
      "url": "https://yannkeep.github.io"
    },
    "description": "Interface d'administration centrale pour l'univers √©tendu BROL. Acc√®s aux archives, outils de simulation, et communications internes.",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "EUR"
    }
  }
  </script>

  <style>
    /* Le CSS reste inchang√©, c'est d√©j√† du solide */
    :root {
      --bg: #020617;
      --card: #020617;
      --accent: #22c55e;
      --accent2: #38bdf8;
      --accent3: #f97316;
      --accent4: #a855f7;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: rgba(148, 163, 184, 0.6);
      --font-main: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      --font-mono: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --radius-xl: 18px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.95);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      min-height: 100vh;
      font-family: var(--font-main);
      background:
        radial-gradient(circle at 0 0, rgba(56,189,248,0.26), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(34,197,94,0.26), transparent 55%),
        var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image: linear-gradient(
        rgba(15,23,42,0.25) 1px,
        transparent 1px
      );
      background-size: 100% 2px;
      mix-blend-mode: soft-light;
      opacity: 0.7;
      z-index: 1;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(14px);
      background:
        radial-gradient(circle at 0 0, rgba(56,189,248,0.3), transparent 60%),
        rgba(3,7,18,0.96);
      border-bottom: 1px solid rgba(30,64,175,0.8);
      padding: 8px 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      box-shadow: 0 16px 40px rgba(0,0,0,0.95);
    }

    .header-left { display: flex; align-items: center; gap: 8px; }

    .logo-frame {
      width: 46px; height: 46px; border-radius: 16px; padding: 2px;
      background: conic-gradient(from 180deg, #22c55e, #38bdf8, #f97316, #a855f7, #22c55e);
      box-shadow: 0 0 0 1px #020617, 0 0 26px rgba(56,189,248,0.9);
    }

    .logo-inner {
      width: 100%; height: 100%; border-radius: 14px;
      background: radial-gradient(circle at 30% 20%, #0f172a, #020617);
      display: flex; align-items: center; justify-content: center;
      font-family: var(--font-mono); font-size: 0.9rem; font-weight: 700;
      letter-spacing: 0.08em; color: #bbf7d0;
    }

    .header-titles { display: flex; flex-direction: column; gap: 2px; }
    .title-main { font-size: 1.05rem; letter-spacing: 0.14em; text-transform: uppercase; font-weight: 600; }
    .title-sub { font-size: 0.8rem; color: var(--muted); max-width: 360px; }
    .header-right { text-align: right; font-size: 0.78rem; color: var(--muted); max-width: 280px; }
    .header-right strong { color: #e5e7eb; }

    main {
      flex: 1; padding: 12px; position: relative; z-index: 2;
      display: grid; grid-template-columns: minmax(0, 1.4fr) minmax(0, 2fr) minmax(0, 1.2fr); gap: 10px;
    }

    @media (max-width: 1100px) {
      main { grid-template-columns: minmax(0, 1.2fr) minmax(0, 1.8fr); grid-template-rows: auto auto; }
    }
    @media (max-width: 840px) {
      main { grid-template-columns: 1fr; grid-template-rows: auto auto auto; }
    }

    .panel {
      background: rgba(3,7,18,0.98); border-radius: var(--radius-xl); border: 1px solid var(--border);
      box-shadow: var(--shadow-soft); padding: 10px 10px 11px; position: relative; overflow: hidden; font-size: 0.82rem;
    }

    .panel::before {
      content: ""; position: absolute; inset: 0; pointer-events: none;
      background: radial-gradient(circle at 0 0, rgba(56,189,248,0.3), transparent 60%), radial-gradient(circle at 100% 100%, rgba(168,85,247,0.22), transparent 60%);
      mix-blend-mode: soft-light; opacity: 0.7;
    }

    .panel-inner { position: relative; z-index: 2; height: 100%; display: flex; flex-direction: column; gap: 6px; }
    .panel h2 { font-size: 0.96rem; margin-bottom: 2px; }
    .muted { color: var(--muted); font-size: 0.8rem; }
    
    .search-row { margin-top: 4px; display: flex; flex-wrap: wrap; gap: 6px; align-items: center; }
    input[type="search"], select {
      border-radius: 999px; border: 1px solid rgba(51,65,85,0.98); background: rgba(15,23,42,0.98);
      color: var(--text); font-size: 0.8rem; font-family: var(--font-main); outline: none;
    }
    input[type="search"] { padding: 5px 9px; min-width: 0; flex: 1; }
    input[type="search"]::placeholder { color: #6b7280; }
    select { padding: 4px 7px; }

    .badge-small {
      border-radius: 999px; border: 1px solid rgba(148,163,184,0.7); padding: 2px 7px;
      font-size: 0.74rem; color: var(--muted); font-family: var(--font-mono);
    }

    .modules-list {
      margin-top: 6px; border-radius: 13px; border: 1px solid rgba(55,65,81,0.98);
      background: #020617; padding: 5px 5px 6px; flex: 1; overflow: hidden; display: flex; flex-direction: column; gap: 4px;
    }
    .modules-scroll { overflow-y: auto; max-height: 486px; padding-right: 3px; }
    
    .group-title {
      font-size: 0.74rem; color: var(--muted); text-transform: uppercase;
      letter-spacing: 0.16em; margin: 4px 4px 3px; font-family: var(--font-mono);
    }
    .module-item {
      border-radius: 11px; border: 1px solid rgba(55,65,81,0.95); background: rgba(15,23,42,0.98);
      padding: 5px 7px; font-size: 0.8rem; margin-bottom: 3px; cursor: pointer;
      display: flex; justify-content: space-between; gap: 6px; align-items: center;
      transition: background 0.15s, border-color 0.15s, transform 0.15s, box-shadow 0.15s;
    }
    .module-item:hover {
      background: rgba(15,23,42,1); border-color: rgba(148,163,184,0.9);
      transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,0.9);
    }
    .module-item.active {
      background: rgba(22,163,74,0.18); border-color: rgba(34,197,94,0.9);
      box-shadow: 0 10px 24px rgba(0,0,0,0.95);
    }

    .module-main { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
    .module-title { font-size: 0.84rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .module-sub { font-size: 0.75rem; color: var(--muted); }
    .module-file {
      font-family: var(--font-mono); font-size: 0.7rem; color: #9ca3af;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 130px;
    }
    .module-kind {
      font-size: 0.72rem; padding: 1px 6px; border-radius: 999px;
      border: 1px solid rgba(75,85,99,0.9); text-transform: lowercase; white-space: nowrap;
    }

    .kind-base   { border-color: rgba(34,197,94,0.9); color: #bbf7d0; }
    .kind-brol   { border-color: rgba(56,189,248,0.9); color: #bae6fd; }
    .kind-univ   { border-color: rgba(168,85,247,0.9); color: #e9d5ff; }
    .kind-intra  { border-color: rgba(249,115,22,0.9); color: #fed7aa; }
    .kind-ia     { border-color: rgba(248,113,113,0.9); color: #fecaca; }
    .kind-meta   { border-color: rgba(148,163,184,0.9); color: #e5e7eb; }

    /* VIEWER CENTRAL */
    .viewer-panel {
      background: rgba(3,7,18,0.98); border-radius: var(--radius-xl); border: 1px solid var(--border);
      box-shadow: var(--shadow-soft); padding: 10px 10px 11px; position: relative; overflow: hidden;
      display: flex; flex-direction: column; gap: 6px;
    }
    .viewer-panel::before {
      content: ""; position: absolute; inset: 0; pointer-events: none;
      background: radial-gradient(circle at 50% 0, rgba(56,189,248,0.3), transparent 60%), radial-gradient(circle at 100% 100%, rgba(34,197,94,0.2), transparent 60%);
      mix-blend-mode: soft-light; opacity: 0.7;
    }

    .viewer-inner { position: relative; z-index: 2; display: flex; flex-direction: column; gap: 6px; height: 100%; }
    .viewer-header { display: flex; justify-content: space-between; align-items: baseline; gap: 6px; flex-wrap: wrap; }
    .viewer-title-block { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
    .viewer-title { font-size: 0.96rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .viewer-subtitle { font-size: 0.78rem; color: var(--muted); }
    
    .viewer-badges { display: flex; flex-wrap: wrap; gap: 4px; justify-content: flex-end; }
    .viewer-badge {
      border-radius: 999px; border: 1px solid rgba(148,163,184,0.9); padding: 2px 7px;
      font-size: 0.74rem; font-family: var(--font-mono); color: var(--muted); display: inline-flex; align-items: center; gap: 4px;
    }
    .viewer-dot {
      width: 7px; height: 7px; border-radius: 999px; background: #22c55e; box-shadow: 0 0 8px rgba(34,197,94,0.95);
    }

    .viewer-body {
      border-radius: 13px; border: 1px solid rgba(55,65,81,0.98); background: #020617;
      flex: 1; display: flex; flex-direction: column; overflow: hidden; min-height: 200px;
    }
    .viewer-iframe-wrapper {
      flex: 1; min-height: 180px; border-bottom: 1px solid rgba(31,41,55,0.98); background: #020617; overflow: hidden;
    }
    #viewerFrame { width: 100%; height: 100%; border: none; border-radius: 11px 11px 0 0; background: #020617; }
    
    .viewer-info {
      padding: 5px 7px; font-size: 0.78rem; color: var(--muted);
      display: flex; justify-content: space-between; gap: 6px; flex-wrap: wrap; align-items: center;
    }
    .viewer-file {
      font-family: var(--font-mono); font-size: 0.74rem; color: #9ca3af;
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 260px;
    }
    
    .btn-open {
      border-radius: 999px; border: 1px solid rgba(56,189,248,0.9); background: rgba(15,23,42,0.98);
      color: #e0f2fe; font-size: 0.76rem; padding: 3px 8px; cursor: pointer;
      font-family: var(--font-mono); text-decoration: none;
    }
    .btn-open:hover { background: rgba(15,23,42,1); box-shadow: 0 8px 20px rgba(0,0,0,0.95); }

    /* PANEL DROIT */
    .side-panel {
      background: rgba(3,7,18,0.98); border-radius: var(--radius-xl); border: 1px solid var(--border);
      box-shadow: var(--shadow-soft); padding: 10px 10px 11px; position: relative; overflow: hidden;
      display: flex; flex-direction: column; gap: 7px; font-size: 0.8rem;
    }
    .side-panel::before {
      content: ""; position: absolute; inset: 0; pointer-events: none;
      background: radial-gradient(circle at 100% 0, rgba(56,189,248,0.3), transparent 60%), radial-gradient(circle at 0 100%, rgba(234,179,8,0.2), transparent 60%);
      mix-blend-mode: soft-light; opacity: 0.7;
    }

    .side-inner { position: relative; z-index: 2; display: flex; flex-direction: column; gap: 7px; height: 100%; }
    .side-section h2 { font-size: 0.9rem; margin-bottom: 3px; }
    
    .embed-row { display: flex; flex-wrap: wrap; gap: 5px; margin-top: 4px; }
    .embed-btn {
      border-radius: 999px; border: 1px solid rgba(55,65,81,0.98); background: #020617;
      color: #e5e7eb; font-size: 0.76rem; padding: 3px 7px; cursor: pointer;
      display: inline-flex; align-items: center; gap: 4px; font-family: var(--font-mono);
      transition: background 0.15s, border-color 0.15s, transform 0.15s;
    }
    .embed-btn:hover {
      background: rgba(15,23,42,1); border-color: rgba(148,163,184,0.9);
      transform: translateY(-1px); box-shadow: 0 8px 20px rgba(0,0,0,0.9);
    }

    footer {
      padding: 6px 12px 8px; font-size: 0.74rem; color: var(--muted);
      border-top: 1px solid rgba(30,64,175,0.7); background: rgba(3,7,18,0.98);
      display: flex; justify-content: space-between; gap: 6px; flex-wrap: wrap; position: relative; z-index: 2;
    }
    footer a { color: var(--accent2); text-decoration: none; font-weight: bold; }
    footer a:hover { text-decoration: underline; }

    @media (max-width: 720px) {
      header { flex-direction: column; align-items: flex-start; }
      .header-right { text-align: left; max-width: none; }
      footer { flex-direction: column; }
    }
  </style>
</head>
<body>

<header>
  <div class="header-left">
    <div class="logo-frame">
      <div class="logo-inner">BROL</div>
    </div>
    <div class="header-titles">
      <h1 class="title-main">BROL 2.0 ‚Äì Dashboard central</h1>
    </div>
  </div>
  <div class="header-right">
    <div>. - Vous √™tes niveau 0<br>. - Bienvenue au niveau 1</div>
  </div>
</header>

<main>
  
  <nav class="panel" aria-label="Modules de navigation">
    <div class="panel-inner">
      <div>
        <h2>Pages & modules</h2>
        <div class="search-row">
          <input type="search" id="moduleSearch" placeholder="Rechercher (nom ou fichier)‚Ä¶" aria-label="Barre de recherche">
          <select id="moduleCategory" aria-label="Filtrer par cat√©gorie">
            <option value="all" selected>Toutes cat√©gories</option>
            <option value="base">La Base</option>
            <option value="brol">BROL & fichiers</option>
            <option value="univ">Univers & jeu</option>
            <option value="intra">Liens en vrac</option>
            <option value="ia">IA fictive</option>
            <option value="meta">Tests</option>
          </select>
        </div>
        <div style="margin-top:4px;display:flex;justify-content:space-between;gap:6px;flex-wrap:wrap;">
          <span class="badge-small" id="modulesCount">9 modules</span>
          <span class="muted">.</span>
        </div>
      </div>

      <div class="modules-list">
        <div class="modules-scroll" id="modulesContainer">
          </div>
      </div>
    </div>
  </nav>

  <section class="viewer-panel" aria-label="Visionneuse de contenu">
    <div class="viewer-inner">
      <div class="viewer-header">
        <div class="viewer-title-block">
          <h2 class="viewer-title" id="viewerTitle">Chargement...</h2>
          <div class="viewer-subtitle" id="viewerSubtitle">Initialisation du syst√®me.</div>
        </div>
        <div class="viewer-badges">
          <span class="viewer-badge">
            <span class="viewer-dot"></span>
            <span id="viewerCategoryBadge">Syst√®me</span>
          </span>
          <span class="viewer-badge" id="viewerKindBadge">boot</span>
        </div>
      </div>

      <div class="viewer-body">
        <div class="viewer-iframe-wrapper">
          <iframe id="viewerFrame" src="about:blank" title="Visionneuse de module BROL"></iframe>
        </div>
        <div class="viewer-info">
          <div class="viewer-file" id="viewerFile">Attente de requ√™te...</div>
          <div class="viewer-actions">
            <a href="#" id="viewerOpenNew" class="btn-open" target="_blank" rel="noopener noreferrer">Ouvrir dans un nouvel onglet</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <aside class="side-panel" aria-label="Annexes et distractions externes">
    <div class="side-inner">
      <section class="side-section">
        <h2>Distractions & annexes</h2>
        <div class="embed-row">
          <button type="button" class="embed-btn" data-embed="penguin"><span class="icon">üêß</span> Tarot</button>
          <button type="button" class="embed-btn" data-embed="youtubeu"><span class="icon">‚ñ∂Ô∏è</span> D√âM¬∑OS</button>
          <button type="button" class="embed-btn" data-embed="intranet"><span class="icon">üêß</span> Intranet</button>
          <button type="button" class="embed-btn" data-embed="pdf-plaidoyer-1"><span class="icon">üìÑ</span> !NYX√∂-II</button>
          </div>
      </section>
      
      <iframe width="100%" height="220" style="border-radius:8px; margin-top:8px;" src="https://www.youtube-nocookie.com/embed/gk-dZo37IJA?si=OC8uFwTSgpVYtKQi" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    </div>
  </aside>

</main>

<footer>
  <span>BROL 2.0 ‚Äì Dashboard central</span>
  <nav aria-label="Navigation secondaire">
    <p>
      . - Base Centrale | 
      . - Relais r√©seau : <a href="https://ouaisfieu.github.io/base/" target="_blank" rel="noopener" title="Base satellite de donn√©es annexes">Archives Ouaisfieu</a> |
      . - <a href="https://dl.ouaisfi.eu/usba/" target="_blank">Niveau pr√©c√©dent</a>
    </p>
  </nav>
</footer>

<script>
  // LE SCRIPT RESTE IDENTIQUE (C'est ton moteur interne)
  const modules = [
    { id: "site-ultime", title: "LE SITE ULTIME (index)", file: "google.html", category: "base", kind: "niveaux -1 ‚Üí 3", description: "Le fichier qui permet de partir de z√©ro et monter progressivement." },
    { id: "scratchy", title: "Support technique", file: "404.html", category: "base", kind: "au cas o√π", description: "Il faut √©teindre et rallumer." },
    { id: "branques2", title: "Politique des Cookies", file: "cookies.html", category: "base", kind: "d√©butant+", description: "Devine quoi √† la fin..." },
    { id: "hub-illustre", title: "Hub illustr√©", file: "test-propagande.html", category: "brol", kind: "codigic", description: "Pour faire tout √† fait autre chose." },
    { id: "stic-anarchie", title: "STIC de l‚Äôanarchie", file: "stic-anarchie.html", category: "univ", kind: "jeu pas fun", description: "Version ultra color√©e / Scratch-like pour jouer avec le capitalisme." },
    { id: "detective", title: "Agence d√©tective publique", file: "veilleuxses.html", category: "intra", kind: "site m√©tier", description: "Vitrine + intranet l√©ger pour d√©tective." },
    { id: "gork", title: "GORK / Pauvre Gork", file: "gork.html", category: "ia", kind: "graph", description: "Il voudrait √™tre d√©branch√©." },
    { id: "test-1", title: "√Ä r√©ussir d'urgence", file: "test-1.html", category: "meta", kind: "bisous", description: "C'est √ßa ou rien." },
    { id: "mon-projet", title: "Le projet d√©voil√©", file: "veille-1160.html", category: "univ", kind: "univers perso", description: "Description courte de ce que contient cette page." }
  ];

  const embeds = {
    penguin: { label: "Tarot pas illustr√©", url: "https://ouaisfieu.appsmith.com/app/tarotboulotproto-v3-1/tarotsimpletirage-68555a12a22d7c48aa0d27ad", description: "Tarot de Boulot et de Marseille sans illustration." },
    intranet: { label: "Intranet", url: "https://boot-a-rat.vercel.app/", description: "C'est par l√† que √ßa se passe." },
    youtubeu: { label: "D√âM¬∑OS", url: "https://www.youtube-nocookie.com/embed/Sv063nzZIEk?si=KV3gRnNdT6Ncs91L", description: "Exemple d‚Äôembed YouTube." },
    "pdf-plaidoyer-1": { label: "plaidoyer-jp.pdf", url: "https://dl.ouaisfi.eu/bxl-242/Les_Deux_Belgiques_Carriere_Politique_vs_Citoyenne.pdf", description: "PDF externe" }
  };

  const moduleSearch   = document.getElementById("moduleSearch");
  const moduleCategory = document.getElementById("moduleCategory");
  const modulesContainer = document.getElementById("modulesContainer");
  const modulesCount   = document.getElementById("modulesCount");

  const viewerTitle    = document.getElementById("viewerTitle");
  const viewerSubtitle = document.getElementById("viewerSubtitle");
  const viewerCategoryBadge = document.getElementById("viewerCategoryBadge");
  const viewerKindBadge = document.getElementById("viewerKindBadge");
  const viewerFile     = document.getElementById("viewerFile");
  const viewerFrame    = document.getElementById("viewerFrame");
  const viewerOpenNew  = document.getElementById("viewerOpenNew");

  let filteredModules = [];
  let activeModuleId = null;

  function categoryLabel(cat) {
    switch (cat) {
      case "base": return "La Base"; case "brol": return "BAC √Ä SPAM";
      case "univ": return "Univers & jeu"; case "intra": return "Liens en vrac";
      case "ia": return "IA fictive"; case "meta": return "Tests"; default: return "Autre";
    }
  }

  function kindClass(cat) {
    switch (cat) {
      case "base": return "kind-base"; case "brol": return "kind-brol";
      case "univ": return "kind-univ"; case "intra": return "kind-intra";
      case "ia": return "kind-ia"; case "meta": return "kind-meta"; default: return "";
    }
  }

  function applyModuleFilter() {
    const q = moduleSearch.value.trim().toLowerCase();
    const cat = moduleCategory.value;
    filteredModules = modules.filter(m => {
      if (cat !== "all" && m.category !== cat) return false;
      if (!q) return true;
      const h = (m.title + " " + m.file + " " + (m.description || "")).toLowerCase();
      return h.includes(q);
    });
    renderModules();
  }

  function renderModules() {
    modulesContainer.innerHTML = "";
    if (!filteredModules.length) {
      modulesContainer.innerHTML = '<div class="muted" style="padding:4px 6px;">Aucun module trouv√©.</div>';
      modulesCount.textContent = "0 module"; return;
    }
    modulesCount.textContent = filteredModules.length + " module" + (filteredModules.length > 1 ? "s" : "");

    const groups = {};
    filteredModules.forEach(m => {
      if (!groups[m.category]) groups[m.category] = [];
      groups[m.category].push(m);
    });

    Object.keys(groups).sort().forEach(cat => {
      const groupEl = document.createElement("div");
      const title = document.createElement("div");
      title.className = "group-title"; title.textContent = categoryLabel(cat);
      groupEl.appendChild(title);

      groups[cat].forEach(m => {
        const item = document.createElement("div");
        item.className = "module-item";
        if (m.id === activeModuleId) item.classList.add("active");
        item.dataset.id = m.id;
        item.innerHTML = `
          <div class="module-main">
            <div class="module-title" title="${m.title}">${m.title}</div>
            <div class="module-sub">${m.description || ""}</div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:2px;min-width:0;">
            <div class="module-file" title="${m.file}">${m.file}</div>
            <div class="module-kind ${kindClass(m.category)}">${m.kind || ""}</div>
          </div>
        `;
        item.addEventListener("click", () => selectModule(m.id));
        groupEl.appendChild(item);
      });
      modulesContainer.appendChild(groupEl);
    });
  }

  function selectModule(id) {
    const m = modules.find(x => x.id === id);
    if (!m) return;
    activeModuleId = id;

    document.querySelectorAll(".module-item").forEach(el => {
      el.classList.toggle("active", el.dataset.id === id);
    });

    viewerTitle.textContent = m.title;
    viewerSubtitle.textContent = m.description || "";
    viewerCategoryBadge.textContent = categoryLabel(m.category);
    viewerKindBadge.textContent = m.kind || "";
    viewerFile.textContent = "Fichier / URL : " + m.file;
    viewerFrame.src = m.file;
    viewerOpenNew.href = m.file;
  }

  moduleSearch.addEventListener("input", applyModuleFilter);
  moduleCategory.addEventListener("change", applyModuleFilter);

  document.querySelectorAll(".embed-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      const key = btn.dataset.embed;
      const e = embeds[key];
      if (!e) return;
      activeModuleId = null;
      document.querySelectorAll(".module-item").forEach(el => el.classList.remove("active"));
      
      viewerTitle.textContent = e.label;
      viewerSubtitle.textContent = e.description || "";
      viewerCategoryBadge.textContent = "Embed externe";
      viewerKindBadge.textContent = "annexe";
      viewerFile.textContent = "Source : " + e.url;
      viewerFrame.src = e.url;
      viewerOpenNew.href = e.url;
    });
  });

  document.addEventListener("DOMContentLoaded", () => {
    applyModuleFilter();
    const defaultModule = modules.find(m => m.id === "site-ultime") || modules[0];
    if (defaultModule) selectModule(defaultModule.id);
  });
</script>
</body>
</html>
