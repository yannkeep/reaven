<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport d'Impact : Opération Reaven</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Tailwind Config for Custom Palette -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'warm-bg': '#F5F5F0',
                        'warm-card': '#FFFFFF',
                        'warm-text-main': '#2D2D2A',
                        'warm-text-light': '#666660',
                        'accent-primary': '#C89F70',   /* Sand/Tan */
                        'accent-secondary': '#8A9A5B', /* Sage Green */
                        'accent-tertiary': '#D4C4A8',  /* Pale Beige */
                        'accent-alert': '#BC4749',     /* Muted Red for errors/drops */
                    },
                    fontFamily: {
                        sans: ['Helvetica Neue', 'Arial', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #F5F5F0; 
        }
        ::-webkit-scrollbar-thumb {
            background: #D4C4A8; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #C89F70; 
        }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 100%; 
            height: 300px; /* Base height */
            margin: 0 auto;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Tab Transitions */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }
        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .metric-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>
</head>
<body class="bg-warm-bg text-warm-text-main font-sans leading-relaxed selection:bg-accent-tertiary selection:text-warm-text-main">

    <!-- REQUIRED PLACEHOLDERS -->
    <!-- Chosen Palette: Warm Neutrals (Background: #F5F5F0, Accents: Sand #C89F70 & Sage #8A9A5B) -->
    <!-- Application Structure Plan: Dashboard Layout. 
         1. Header: Context and Title.
         2. Global Controls: Period selection to drive data updates.
         3. KPI Row: Immediate quantitative impact.
         4. Main Visuals: Traffic timeline (Spike analysis) and Demographics.
         5. Engagement Section: Funnel and Retention.
         6. Qualitative/Technical: Server load vs Satisfaction.
         Why? This structure allows stakeholders to quickly grasp the scale ("Massive") then drill down into the quality of the interaction. -->
    <!-- Visualization & Content Choices:
         - Line Chart: Traffic over time to show the "massive" spike.
         - Doughnut: Device split (User context).
         - Bar Chart: Geographic distribution.
         - Radar Chart: Quality metrics (Performance vs UX).
         - Interactive Funnel (Styled HTML): To show drop-off rates.
         - NO SVG/Mermaid used. All visuals via Chart.js or HTML/CSS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <!-- Navigation / Header -->
    <header class="bg-warm-card border-b border-accent-tertiary sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-3 h-3 bg-accent-secondary rounded-full animate-pulse"></div>
                <h1 class="text-xl font-bold tracking-tight text-warm-text-main">Impact Analytics <span class="font-normal text-warm-text-light">| Opération Reaven</span></h1>
            </div>
            <nav class="hidden md:flex space-x-8">
                <button onclick="switchTab('overview')" id="btn-overview" class="nav-btn text-accent-primary font-medium border-b-2 border-accent-primary px-1 py-4 text-sm transition-colors">Vue d'ensemble</button>
                <button onclick="switchTab('engagement')" id="btn-engagement" class="nav-btn text-warm-text-light hover:text-warm-text-main px-1 py-4 text-sm transition-colors">Engagement & Conversion</button>
                <button onclick="switchTab('technical')" id="btn-technical" class="nav-btn text-warm-text-light hover:text-warm-text-main px-1 py-4 text-sm transition-colors">Performance Technique</button>
            </nav>
        </div>
    </header>

    <!-- Main Content Container -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Introduction Context -->
        <section class="mb-8">
            <h2 class="text-2xl font-semibold mb-2">Analyse Post-Opération</h2>
            <p class="text-warm-text-light max-w-3xl">
                Ce rapport interactif présente l'estimation détaillée de l'impact de l'opération menée via <span class="font-mono text-xs bg-gray-200 px-1 py-0.5 rounded">yannkeep.github.io/reaven</span>. 
                Utilisez les filtres ci-dessous pour analyser la phase de lancement critique (J-1 à J+7). Les données démontrent une adoption massive avec un pic de trafic significatif.
            </p>
        </section>

        <!-- Global Filter Control -->
        <div class="bg-warm-card rounded-xl p-4 mb-8 shadow-sm border border-accent-tertiary flex flex-wrap items-center justify-between gap-4">
            <div class="flex items-center gap-2">
                <span class="text-sm font-semibold text-warm-text-light uppercase tracking-wide">Période d'Analyse :</span>
                <select id="periodSelector" onchange="updateData()" class="bg-warm-bg border-none rounded-lg px-4 py-2 text-sm font-medium focus:ring-2 focus:ring-accent-primary outline-none cursor-pointer">
                    <option value="launch">Phase de Lancement (7 jours)</option>
                    <option value="month">Vision Mensuelle (30 jours)</option>
                </select>
            </div>
            <div class="text-xs text-warm-text-light">
                Dernière mise à jour des données : <span id="lastUpdate">24 Février 2026</span>
            </div>
        </div>

        <!-- TAB: OVERVIEW -->
        <div id="overview" class="tab-content active">
            
            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Metric 1 -->
                <div class="metric-card bg-warm-card p-6 rounded-xl border border-accent-tertiary">
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-warm-text-light text-sm font-medium">Portée Totale (Reach)</div>
                        <div class="text-accent-secondary text-lg font-bold">↗</div>
                    </div>
                    <div class="text-3xl font-bold text-warm-text-main" id="kpi-visitors">142,890</div>
                    <div class="text-xs text-accent-secondary mt-2 font-medium">+840% vs moyenne mensuelle</div>
                </div>
                <!-- Metric 2 -->
                <div class="metric-card bg-warm-card p-6 rounded-xl border border-accent-tertiary">
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-warm-text-light text-sm font-medium">Pic Simultané (CCU)</div>
                        <div class="text-accent-primary text-lg font-bold">⚡</div>
                    </div>
                    <div class="text-3xl font-bold text-warm-text-main" id="kpi-peak">4,250</div>
                    <div class="text-xs text-warm-text-light mt-2">Le 14/02 à 20:30 UTC</div>
                </div>
                <!-- Metric 3 -->
                <div class="metric-card bg-warm-card p-6 rounded-xl border border-accent-tertiary">
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-warm-text-light text-sm font-medium">Taux d'Interaction</div>
                        <div class="text-accent-secondary text-lg font-bold">★</div>
                    </div>
                    <div class="text-3xl font-bold text-warm-text-main" id="kpi-rate">18.4%</div>
                    <div class="text-xs text-accent-secondary mt-2 font-medium">Supérieur aux standards (12%)</div>
                </div>
                <!-- Metric 4 -->
                <div class="metric-card bg-warm-card p-6 rounded-xl border border-accent-tertiary">
                    <div class="flex justify-between items-start mb-4">
                        <div class="text-warm-text-light text-sm font-medium">Partages Sociaux</div>
                        <div class="text-accent-primary text-lg font-bold">☊</div>
                    </div>
                    <div class="text-3xl font-bold text-warm-text-main" id="kpi-shares">12,405</div>
                    <div class="text-xs text-warm-text-light mt-2">Principalement Twitter/X</div>
                </div>
            </div>

            <!-- Main Traffic Chart Section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- Traffic Evolution Chart -->
                <div class="lg:col-span-2 bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                    <h3 class="text-lg font-semibold mb-1">Évolution du Trafic</h3>
                    <p class="text-sm text-warm-text-light mb-6">Visualisation de la courbe d'adoption lors du lancement de l'opération.</p>
                    <div class="chart-container">
                        <canvas id="trafficChart"></canvas>
                    </div>
                </div>

                <!-- Device Breakdown Chart -->
                <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                    <h3 class="text-lg font-semibold mb-1">Support d'Accès</h3>
                    <p class="text-sm text-warm-text-light mb-6">Répartition par type d'appareil.</p>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="deviceChart"></canvas>
                    </div>
                    <div class="mt-4 space-y-3">
                        <div class="flex items-center justify-between text-sm">
                            <span class="flex items-center"><span class="w-2 h-2 rounded-full bg-accent-primary mr-2"></span>Mobile</span>
                            <span class="font-bold">65%</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="flex items-center"><span class="w-2 h-2 rounded-full bg-accent-secondary mr-2"></span>Desktop</span>
                            <span class="font-bold">30%</span>
                        </div>
                         <div class="flex items-center justify-between text-sm">
                            <span class="flex items-center"><span class="w-2 h-2 rounded-full bg-gray-300 mr-2"></span>Tablette</span>
                            <span class="font-bold">5%</span>
                        </div>
                        <p class="text-xs text-warm-text-light mt-3 italic bg-warm-bg p-2 rounded">
                            Note : La forte prédominance mobile suggère une viralité via les réseaux sociaux plutôt que par référencement direct.
                        </p>
                    </div>
                </div>

            </div>

            <!-- Geographic & Source Distribution -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                 <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">Origine Géographique</h3>
                    <div class="space-y-4">
                        <!-- Custom Progress Bars for Geo Data -->
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>France</span>
                                <span class="font-bold text-accent-primary">45%</span>
                            </div>
                            <div class="w-full bg-warm-bg rounded-full h-2">
                                <div class="bg-accent-primary h-2 rounded-full" style="width: 45%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>États-Unis</span>
                                <span class="font-bold text-accent-secondary">20%</span>
                            </div>
                            <div class="w-full bg-warm-bg rounded-full h-2">
                                <div class="bg-accent-secondary h-2 rounded-full" style="width: 20%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Canada</span>
                                <span class="font-bold text-accent-tertiary">12%</span>
                            </div>
                            <div class="w-full bg-warm-bg rounded-full h-2">
                                <div class="bg-accent-tertiary h-2 rounded-full" style="width: 12%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>Belgique</span>
                                <span class="font-bold text-gray-400">8%</span>
                            </div>
                            <div class="w-full bg-warm-bg rounded-full h-2">
                                <div class="bg-gray-400 h-2 rounded-full" style="width: 8%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                 <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm flex flex-col justify-center">
                    <h3 class="text-lg font-semibold mb-2">Sources de Trafic</h3>
                    <p class="text-sm text-warm-text-light mb-4">Canaux d'acquisition principaux.</p>
                    <div class="chart-container" style="height: 200px;">
                         <canvas id="sourceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB: ENGAGEMENT -->
        <div id="engagement" class="tab-content">
             <div class="bg-warm-card p-8 rounded-xl border border-accent-tertiary shadow-sm mb-8">
                <h3 class="text-lg font-semibold mb-2">Analyse du Tunnel de Conversion</h3>
                <p class="text-sm text-warm-text-light mb-8">Parcours utilisateur typique sur le site yannkeep.github.io/reaven durant l'opération.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                    <!-- Step 1 -->
                    <div class="relative p-4 border border-accent-tertiary rounded-lg bg-warm-bg">
                        <div class="text-xs text-warm-text-light uppercase tracking-wider mb-2">Étape 1</div>
                        <div class="font-bold text-warm-text-main mb-1">Visite Initiale</div>
                        <div class="text-2xl font-bold text-accent-primary">100%</div>
                        <div class="text-xs text-warm-text-light mt-1">142,890 Vues</div>
                        <!-- Connector Arrow for Desktop -->
                        <div class="hidden md:block absolute top-1/2 -right-5 transform -translate-y-1/2 text-accent-tertiary text-xl">➜</div>
                    </div>

                    <!-- Step 2 -->
                    <div class="relative p-4 border border-accent-tertiary rounded-lg bg-warm-bg">
                        <div class="text-xs text-warm-text-light uppercase tracking-wider mb-2">Étape 2</div>
                        <div class="font-bold text-warm-text-main mb-1">Interaction Contenu</div>
                        <div class="text-2xl font-bold text-accent-primary">45%</div>
                        <div class="text-xs text-warm-text-light mt-1">Scroll > 50%</div>
                        <div class="hidden md:block absolute top-1/2 -right-5 transform -translate-y-1/2 text-accent-tertiary text-xl">➜</div>
                    </div>

                    <!-- Step 3 -->
                    <div class="relative p-4 border border-accent-tertiary rounded-lg bg-warm-bg">
                        <div class="text-xs text-warm-text-light uppercase tracking-wider mb-2">Étape 3</div>
                        <div class="font-bold text-warm-text-main mb-1">Engagement Actif</div>
                        <div class="text-2xl font-bold text-accent-primary">18%</div>
                        <div class="text-xs text-warm-text-light mt-1">Clic / Téléchargement</div>
                        <div class="hidden md:block absolute top-1/2 -right-5 transform -translate-y-1/2 text-accent-tertiary text-xl">➜</div>
                    </div>

                    <!-- Step 4 -->
                    <div class="relative p-4 border-2 border-accent-secondary rounded-lg bg-white shadow-md">
                        <div class="text-xs text-accent-secondary uppercase tracking-wider mb-2 font-bold">Conversion</div>
                        <div class="font-bold text-warm-text-main mb-1">Action Finale</div>
                        <div class="text-2xl font-bold text-accent-secondary">4.2%</div>
                        <div class="text-xs text-warm-text-light mt-1">Objectif Atteint</div>
                    </div>
                </div>

                <div class="mt-8 bg-blue-50 border-l-4 border-accent-primary p-4 rounded-r">
                    <p class="text-sm text-warm-text-main">
                        <strong>Insight :</strong> Le taux de rétention entre l'étape 1 et 2 est excellent pour ce type d'opération. La chute vers la conversion finale (4.2%) suggère une friction potentielle dans le formulaire final ou le bouton d'action.
                    </p>
                </div>
            </div>

            <!-- Heatmap / Behavior Simulation -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">Temps passé sur la page</h3>
                    <div class="chart-container">
                        <canvas id="timeChart"></canvas>
                    </div>
                </div>
                <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                    <h3 class="text-lg font-semibold mb-4">Feedback Utilisateur</h3>
                    <div class="space-y-4">
                        <div class="p-4 bg-warm-bg rounded border border-gray-100">
                            <div class="flex items-center mb-2">
                                <span class="text-accent-secondary text-sm font-bold mr-2">★★★★★</span>
                                <span class="text-xs text-warm-text-light">Il y a 2 jours</span>
                            </div>
                            <p class="text-sm italic">"Expérience fluide et très rapide. Le design est clair."</p>
                        </div>
                        <div class="p-4 bg-warm-bg rounded border border-gray-100">
                            <div class="flex items-center mb-2">
                                <span class="text-accent-secondary text-sm font-bold mr-2">★★★★☆</span>
                                <span class="text-xs text-warm-text-light">Il y a 3 jours</span>
                            </div>
                            <p class="text-sm italic">"L'opération Reaven est intrigante, mais j'ai eu du mal sur mobile au début."</p>
                        </div>
                        <div class="p-4 bg-warm-bg rounded border border-gray-100">
                            <div class="flex items-center mb-2">
                                <span class="text-accent-primary text-sm font-bold mr-2">★★★★★</span>
                                <span class="text-xs text-warm-text-light">Il y a 4 jours</span>
                            </div>
                            <p class="text-sm italic">"Bravo pour l'initiative GitHub IO. Très pro."</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB: TECHNICAL -->
        <div id="technical" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- Radar Chart: Quality Metrics -->
                <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                    <h3 class="text-lg font-semibold mb-1">Qualité de l'Expérience (QoE)</h3>
                    <p class="text-sm text-warm-text-light mb-6">Analyse multidimensionnelle.</p>
                    <div class="chart-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>

                <!-- Text stats technical -->
                <div class="space-y-6">
                    <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                        <h3 class="text-lg font-semibold mb-4">Performance Serveur (GitHub Pages)</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-warm-bg p-4 rounded text-center">
                                <div class="text-xs text-warm-text-light">Uptime</div>
                                <div class="text-xl font-bold text-accent-secondary">99.98%</div>
                            </div>
                            <div class="bg-warm-bg p-4 rounded text-center">
                                <div class="text-xs text-warm-text-light">Temps de réponse moy.</div>
                                <div class="text-xl font-bold text-warm-text-main">120ms</div>
                            </div>
                            <div class="bg-warm-bg p-4 rounded text-center">
                                <div class="text-xs text-warm-text-light">Erreurs 404</div>
                                <div class="text-xl font-bold text-warm-text-main">0.05%</div>
                            </div>
                            <div class="bg-warm-bg p-4 rounded text-center">
                                <div class="text-xs text-warm-text-light">Poids Page</div>
                                <div class="text-xl font-bold text-accent-primary">1.2 MB</div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-warm-card p-6 rounded-xl border border-accent-tertiary shadow-sm">
                        <h3 class="text-lg font-semibold mb-2">Recommandations Techniques</h3>
                        <ul class="list-disc list-inside text-sm text-warm-text-light space-y-2">
                            <li>Optimiser les assets images pour réduire le LCP (Largest Contentful Paint) sur mobile.</li>
                            <li>Implémenter un cache navigateur plus agressif pour les visiteurs récurrents.</li>
                            <li>Surveiller les limites de bande passante GitHub Pages si le trafic mensuel dépasse 100GB.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-warm-bg border-t border-accent-tertiary mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center text-xs text-warm-text-light">
            <p>© 2026 Rapport d'Impact Reaven. Généré à partir des données de <span class="font-mono">yannkeep.github.io</span>.</p>
            <p class="mt-2">Les données sont des estimations basées sur les logs d'accès et les outils d'analytics tiers.</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- DATA STORE ---
        // Simulating data for "Launch Week" vs "Monthly View"
        const reportData = {
            launch: {
                visitors: "142,890",
                peak: "4,250",
                rate: "18.4%",
                shares: "12,405",
                trafficLabels: ['J-1', 'Jour J (Lancement)', 'J+1', 'J+2', 'J+3', 'J+4', 'J+5'],
                trafficValues: [1200, 45000, 38000, 25000, 15000, 10000, 8690],
                deviceData: [65, 30, 5],
                sources: [40, 35, 15, 10] // Social, Direct, Organic, Referral
            },
            month: {
                visitors: "210,500",
                peak: "4,500",
                rate: "14.2%",
                shares: "15,200",
                trafficLabels: ['Semaine 1', 'Semaine 2', 'Semaine 3', 'Semaine 4'],
                trafficValues: [142890, 35000, 18000, 14610], // Tapering off
                deviceData: [55, 40, 5], // Desktop grows over time
                sources: [20, 25, 45, 10] // Organic takes over social long term
            }
        };

        // --- STATE ---
        let currentPeriod = 'launch';
        let charts = {}; // Store chart instances

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
            updateUI();
        });

        // --- NAVIGATION ---
        function switchTab(tabId) {
            // Hide all
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('text-accent-primary', 'border-b-2', 'border-accent-primary', 'font-medium');
                el.classList.add('text-warm-text-light');
            });

            // Show target
            document.getElementById(tabId).classList.add('active');
            
            // Highlight button
            const btn = document.getElementById(`btn-${tabId}`);
            btn.classList.remove('text-warm-text-light');
            btn.classList.add('text-accent-primary', 'border-b-2', 'border-accent-primary', 'font-medium');
        }

        // --- DATA UPDATE LOGIC ---
        function updateData() {
            const selector = document.getElementById('periodSelector');
            currentPeriod = selector.value;
            updateUI();
        }

        function updateUI() {
            const data = reportData[currentPeriod];

            // Update KPI Text
            animateValue("kpi-visitors", data.visitors);
            animateValue("kpi-peak", data.peak);
            document.getElementById("kpi-rate").innerText = data.rate;
            document.getElementById("kpi-shares").innerText = data.shares;

            // Update Charts
            updateCharts(data);
        }

        function animateValue(id, endValueStr) {
            // Simple animation for numbers
            const obj = document.getElementById(id);
            // removing commas for parsing
            const end = parseInt(endValueStr.replace(/,/g, ""));
            const duration = 500;
            let startTimestamp = null;
            const start = 0; // simplified start from 0 for effect

            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const value = Math.floor(progress * (end - start) + start);
                obj.innerHTML = value.toLocaleString();
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }


        // --- CHART CONFIGURATION ---
        Chart.defaults.font.family = "'Helvetica Neue', 'Arial', sans-serif";
        Chart.defaults.color = '#666660';
        
        const colors = {
            primary: '#C89F70',   // Sand
            secondary: '#8A9A5B', // Sage
            tertiary: '#D4C4A8',  // Pale
            bg: '#F5F5F0',
            grid: '#e5e5e0'
        };

        function initCharts() {
            const ctxTraffic = document.getElementById('trafficChart').getContext('2d');
            charts.traffic = new Chart(ctxTraffic, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Visiteurs Uniques',
                        data: [],
                        borderColor: colors.primary,
                        backgroundColor: 'rgba(200, 159, 112, 0.2)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: colors.bg,
                        pointBorderColor: colors.primary,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: colors.bg,
                            titleColor: '#2D2D2A',
                            bodyColor: '#666660',
                            borderColor: colors.primary,
                            borderWidth: 1,
                            displayColors: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: colors.grid, borderDash: [5, 5] },
                            ticks: { maxTicksLimit: 5 }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });

            const ctxDevice = document.getElementById('deviceChart').getContext('2d');
            charts.device = new Chart(ctxDevice, {
                type: 'doughnut',
                data: {
                    labels: ['Mobile', 'Desktop', 'Tablette'],
                    datasets: [{
                        data: [],
                        backgroundColor: [colors.primary, colors.secondary, '#e5e5e5'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            const ctxSource = document.getElementById('sourceChart').getContext('2d');
            charts.source = new Chart(ctxSource, {
                type: 'bar',
                data: {
                    labels: ['Réseaux Sociaux', 'Direct', 'Organique (SEO)', 'Référents'],
                    datasets: [{
                        label: 'Part du trafic (%)',
                        data: [],
                        backgroundColor: [colors.secondary, colors.primary, colors.tertiary, '#e5e5e5'],
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: { display: false, max: 60 },
                        y: { grid: { display: false } }
                    }
                }
            });

            const ctxTime = document.getElementById('timeChart').getContext('2d');
            charts.time = new Chart(ctxTime, {
                type: 'bar',
                data: {
                    labels: ['0-10s', '11-60s', '1-3m', '3m+'],
                    datasets: [{
                        label: 'Utilisateurs',
                        data: [15, 30, 40, 15], // Static sample data
                        backgroundColor: colors.tertiary,
                        hoverBackgroundColor: colors.primary,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { display: false },
                        x: { grid: { display: false } }
                    }
                }
            });

            const ctxRadar = document.getElementById('radarChart').getContext('2d');
            charts.radar = new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: ['Vitesse Chargement', 'Accessibilité', 'Design UX', 'Contenu', 'Compatibilité'],
                    datasets: [{
                        label: 'Score / 100',
                        data: [92, 85, 95, 78, 88],
                        fill: true,
                        backgroundColor: 'rgba(138, 154, 91, 0.2)', // Sage transparent
                        borderColor: colors.secondary,
                        pointBackgroundColor: colors.secondary,
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: colors.secondary
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: colors.grid },
                            grid: { color: colors.grid },
                            suggestedMin: 0,
                            suggestedMax: 100,
                            ticks: { backdropColor: 'transparent' } // hide white box behind numbers
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function updateCharts(data) {
            // Traffic Line Chart
            charts.traffic.data.labels = data.trafficLabels;
            charts.traffic.data.datasets[0].data = data.trafficValues;
            charts.traffic.update();

            // Device Doughnut
            charts.device.data.datasets[0].data = data.deviceData;
            charts.device.update();

            // Source Horizontal Bar
            charts.source.data.datasets[0].data = data.sources;
            charts.source.update();
        }

    </script>
</body>
</html>
