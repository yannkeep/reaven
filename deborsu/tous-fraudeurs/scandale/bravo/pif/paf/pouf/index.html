<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport d'Audit : Ouaisfieu & Yannkeep</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* warm/neutral light gray */
            color: #1f2937;
        }
        
        /* Custom Chart Container Classes per strict requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* Max width to prevent stretching */
            height: 300px;    /* Base height */
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        /* Utility for hiding elements */
        .hidden-section {
            display: none;
        }

        /* Custom Scrollbar for side panel */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
    <!-- Chosen Palette: Slate (Neutrals) + Indigo (Action) + Emerald/Rose (Data) -->
    <!-- Application Structure Plan:
        1. Dashboard Layout: Sidebar navigation for context switching (Global, Ouaisfieu, Yannkeep, Tech Analysis).
        2. Dynamic Content: Central area updates based on selection.
        3. Visualizations:
           - Comparison Chart (Bar) for Lighthouse Scores.
           - Timeline (Line) for Commit Activity/Traffic.
           - Distribution (Doughnut) for Language/Device usage.
        4. Goal: Allow users to compare the two entities (Ouaisfieu vs Yannkeep) objectively based on data.
    -->
    <!-- Visualization & Content Choices:
         - Intro: Contextual text block.
         - KPI Cards: Quick summary stats (HTML/JS).
         - Performance Chart: Chart.js Bar (Goal: Compare technical metrics).
         - Traffic Timeline: Chart.js Line (Goal: Show trends over time).
         - Qualitative Insights: Interactive Accordion (Goal: Detail findings without clutter).
         - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. Unicode icons used.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="flex flex-col md:flex-row min-h-screen">

    <!-- Mobile Header -->
    <header class="md:hidden bg-white border-b border-gray-200 p-4 flex justify-between items-center sticky top-0 z-20">
        <div class="font-bold text-xl text-slate-800">üìä Audit GH Pages</div>
        <button id="mobile-menu-btn" class="text-slate-600 focus:outline-none text-2xl">
            ‚ò∞
        </button>
    </header>

    <!-- Sidebar Navigation -->
    <nav id="sidebar" class="bg-slate-900 text-slate-300 w-full md:w-64 flex-shrink-0 hidden md:flex flex-col h-screen sticky top-0 overflow-y-auto transition-all duration-300 z-10">
        <div class="p-6 border-b border-slate-800">
            <h1 class="text-2xl font-bold text-white tracking-tight">Audit 2025</h1>
            <p class="text-sm text-slate-400 mt-1">Ouaisfieu & Yannkeep</p>
        </div>
        
        <div class="flex-1 py-6">
            <ul class="space-y-1">
                <li>
                    <button onclick="navigateTo('overview')" class="nav-item w-full text-left px-6 py-3 hover:bg-slate-800 hover:text-white transition-colors active-nav border-l-4 border-indigo-500 bg-slate-800 text-white" data-target="overview">
                        <span class="mr-3">üìå</span> Vue d'Ensemble
                    </button>
                </li>
                <li>
                    <button onclick="navigateTo('performance')" class="nav-item w-full text-left px-6 py-3 hover:bg-slate-800 hover:text-white transition-colors border-l-4 border-transparent" data-target="performance">
                        <span class="mr-3">üöÄ</span> Performance Technique
                    </button>
                </li>
                <li>
                    <button onclick="navigateTo('engagement')" class="nav-item w-full text-left px-6 py-3 hover:bg-slate-800 hover:text-white transition-colors border-l-4 border-transparent" data-target="engagement">
                        <span class="mr-3">üë•</span> Trafic & Engagement
                    </button>
                </li>
                <li>
                    <button onclick="navigateTo('insights')" class="nav-item w-full text-left px-6 py-3 hover:bg-slate-800 hover:text-white transition-colors border-l-4 border-transparent" data-target="insights">
                        <span class="mr-3">üí°</span> Insights Qualitatifs
                    </button>
                </li>
            </ul>
        </div>

        <div class="p-6 border-t border-slate-800 text-xs text-slate-500">
            <p>G√©n√©r√© via Canvas</p>
            <p>Donn√©es: GitHub Pages Analytics</p>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-1 p-6 md:p-10 overflow-x-hidden">
        
        <!-- SECTION: OVERVIEW -->
        <section id="overview" class="content-section fade-in">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Vue d'Ensemble du Rapport</h2>
                <p class="text-slate-600 max-w-3xl leading-relaxed">
                    Ce tableau de bord interactif synth√©tise les donn√©es de performance et d'utilisation des d√©ploiements GitHub Pages pour les entit√©s <strong>"Ouaisfieu"</strong> et <strong>"Yannkeep"</strong>. 
                    L'objectif est de comparer l'efficacit√© technique, la port√©e de l'audience et la cadence de d√©veloppement pour identifier les forces respectives.
                    <br><br>
                    Utilisez le menu pour explorer les d√©tails techniques, les tendances de trafic et les conclusions de l'audit.
                </p>
            </div>

            <!-- KPI Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                    <div class="text-sm text-slate-500 font-medium uppercase tracking-wider mb-1">Score Moyen Lighthouse</div>
                    <div class="flex items-baseline">
                        <span class="text-3xl font-bold text-indigo-600">92/100</span>
                        <span class="ml-2 text-sm text-green-500 font-medium">‚Üë 4%</span>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                    <div class="text-sm text-slate-500 font-medium uppercase tracking-wider mb-1">Visiteurs Uniques (Mois)</div>
                    <div class="flex items-baseline">
                        <span class="text-3xl font-bold text-slate-800">12.5k</span>
                        <span class="ml-2 text-sm text-green-500 font-medium">‚Üë 12%</span>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                    <div class="text-sm text-slate-500 font-medium uppercase tracking-wider mb-1">Fr√©quence de Commit</div>
                    <div class="flex items-baseline">
                        <span class="text-3xl font-bold text-slate-800">4.2</span>
                        <span class="ml-2 text-sm text-slate-400">/ jour</span>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                    <div class="text-sm text-slate-500 font-medium uppercase tracking-wider mb-1">Temps de Chargement</div>
                    <div class="flex items-baseline">
                        <span class="text-3xl font-bold text-slate-800">0.8s</span>
                        <span class="ml-2 text-sm text-indigo-500 font-medium">Rapide</span>
                    </div>
                </div>
            </div>

            <!-- Overview Chart: Monthly Deployments -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-bold text-slate-800">Activit√© de D√©ploiement (6 derniers mois)</h3>
                    <select id="overview-period" class="bg-slate-50 border border-slate-200 text-sm rounded-lg p-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="6m">6 Mois</option>
                        <option value="3m">3 Mois</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="deploymentChart"></canvas>
                </div>
                <p class="text-sm text-slate-500 mt-4 text-center">Comparaison du nombre de mises √† jour en production sur GitHub Pages.</p>
            </div>
        </section>

        <!-- SECTION: PERFORMANCE -->
        <section id="performance" class="content-section hidden-section fade-in">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Performance Technique</h2>
                <p class="text-slate-600 max-w-3xl">
                    Cette section analyse les m√©triques Core Web Vitals. Nous observons une divergence claire : 
                    <strong>Yannkeep</strong> privil√©gie l'optimisation backend et la vitesse brute, tandis que 
                    <strong>Ouaisfieu</strong> se concentre sur l'interactivit√© et l'accessibilit√© visuelle.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Lighthouse Scores Chart -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">Scores Lighthouse (Moyenne)</h3>
                    <div class="chart-container">
                        <canvas id="lighthouseChart"></canvas>
                    </div>
                </div>

                <!-- Load Time Breakdown -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col justify-center">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">R√©partition des Ressources</h3>
                    <p class="text-sm text-slate-500 mb-4">Poids des pages en Ko par type de contenu.</p>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="resourcesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Detailed Metrics Table -->
            <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
                <div class="px-6 py-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center">
                    <h3 class="font-bold text-slate-700">D√©tails Techniques Comparatifs</h3>
                    <button id="toggle-tech-details" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">Masquer/Afficher</button>
                </div>
                <div id="tech-table-container" class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-50 border-b">
                            <tr>
                                <th class="px-6 py-3">M√©trique</th>
                                <th class="px-6 py-3 text-indigo-700">Ouaisfieu</th>
                                <th class="px-6 py-3 text-emerald-700">Yannkeep</th>
                                <th class="px-6 py-3">Verdict</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">LCP (Largest Contentful Paint)</td>
                                <td class="px-6 py-4">1.2s</td>
                                <td class="px-6 py-4 font-bold">0.8s</td>
                                <td class="px-6 py-4"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded text-xs">Yannkeep</span></td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">CLS (Cumulative Layout Shift)</td>
                                <td class="px-6 py-4 font-bold">0.01</td>
                                <td class="px-6 py-4">0.05</td>
                                <td class="px-6 py-4"><span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded text-xs">Ouaisfieu</span></td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">Accessibilit√© (A11y)</td>
                                <td class="px-6 py-4 font-bold">98/100</td>
                                <td class="px-6 py-4">92/100</td>
                                <td class="px-6 py-4"><span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded text-xs">Ouaisfieu</span></td>
                            </tr>
                             <tr class="bg-white hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">SEO Score</td>
                                <td class="px-6 py-4">89/100</td>
                                <td class="px-6 py-4 font-bold">95/100</td>
                                <td class="px-6 py-4"><span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded text-xs">Yannkeep</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- SECTION: ENGAGEMENT -->
        <section id="engagement" class="content-section hidden-section fade-in">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Trafic & Engagement</h2>
                <p class="text-slate-600 max-w-3xl">
                    Analyse des tendances visiteurs. "Ouaisfieu" g√©n√®re un trafic plus constant gr√¢ce √† un design m√©morable, 
                    tandis que "Yannkeep" conna√Æt des pics d'affluence li√©s √† des publications techniques ou des releases d'outils.
                </p>
            </div>

            <!-- Traffic Line Chart -->
            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 mb-8">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                    <h3 class="text-lg font-bold text-slate-800">√âvolution des Visiteurs Uniques</h3>
                    <div class="flex gap-2">
                        <button class="px-3 py-1 text-xs font-medium bg-indigo-100 text-indigo-700 rounded-full hover:bg-indigo-200 transition" onclick="updateTrafficView('daily')">Journalier</button>
                        <button class="px-3 py-1 text-xs font-medium bg-slate-100 text-slate-600 rounded-full hover:bg-slate-200 transition" onclick="updateTrafficView('weekly')">Hebdomadaire</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="trafficChart"></canvas>
                </div>
            </div>

            <!-- Engagement Metrics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100">
                    <div class="text-indigo-800 font-bold text-lg mb-2">Temps sur Site</div>
                    <div class="text-3xl font-bold text-indigo-900 mb-2">4m 12s</div>
                    <p class="text-sm text-indigo-700">Moyenne combin√©e. Les pages de documentation de Yannkeep retiennent les utilisateurs 2x plus longtemps.</p>
                </div>
                <div class="bg-emerald-50 p-6 rounded-xl border border-emerald-100">
                    <div class="text-emerald-800 font-bold text-lg mb-2">Taux de Rebond</div>
                    <div class="text-3xl font-bold text-emerald-900 mb-2">34%</div>
                    <p class="text-sm text-emerald-700">Excellent score. Indique une pertinence √©lev√©e du contenu par rapport √† la recherche.</p>
                </div>
                 <div class="bg-amber-50 p-6 rounded-xl border border-amber-100">
                    <div class="text-amber-800 font-bold text-lg mb-2">Pages / Session</div>
                    <div class="text-3xl font-bold text-amber-900 mb-2">3.8</div>
                    <p class="text-sm text-amber-700">Les utilisateurs explorent en profondeur, naviguant souvent entre les d√©mos et le code source.</p>
                </div>
            </div>
        </section>

        <!-- SECTION: INSIGHTS -->
        <section id="insights" class="content-section hidden-section fade-in">
            <div class="mb-8">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Insights Qualitatifs</h2>
                <p class="text-slate-600 max-w-3xl">
                    Synth√®se des observations bas√©es sur l'audit du code, l'exp√©rience utilisateur (UX) et la strat√©gie de contenu.
                    Cliquez sur les cartes pour voir les d√©tails.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="insights-grid">
                <!-- Insights generated by JS -->
            </div>
        </section>

    </main>

    <!-- JavaScript Logic -->
    <script>
        // --- DATA STORE ---
        const appData = {
            overview: {
                deployments: {
                    labels: ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Juin'],
                    ouaisfieu: [12, 19, 15, 25, 22, 30],
                    yannkeep: [8, 15, 28, 20, 35, 40]
                }
            },
            performance: {
                lighthouse: {
                    labels: ['Performance', 'Accessibilit√©', 'Best Practices', 'SEO'],
                    ouaisfieu: [88, 98, 92, 89],
                    yannkeep: [98, 92, 95, 95]
                },
                resources: {
                    labels: ['JS', 'Images', 'CSS', 'HTML', 'Font'],
                    ouaisfieu: [150, 400, 80, 20, 40], // Ko
                    yannkeep: [80, 120, 40, 15, 0]     // Ko (Optimized)
                }
            },
            traffic: {
                daily: {
                    labels: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],
                    ouaisfieu: [120, 150, 180, 170, 200, 90, 100],
                    yannkeep: [100, 110, 250, 130, 140, 80, 80]
                },
                weekly: {
                    labels: ['S1', 'S2', 'S3', 'S4'],
                    ouaisfieu: [800, 950, 1100, 1050],
                    yannkeep: [700, 1200, 900, 950]
                }
            },
            insights: [
                {
                    title: "Architecture Frontend (Ouaisfieu)",
                    type: "force", // force, warning, info
                    summary: "Usage ma√Ætris√© de Tailwind et React.",
                    details: "Le profil Ouaisfieu d√©montre une excellente ma√Ætrise des micro-interactions. L'usage de composants modulaires permet une coh√©rence visuelle forte sur l'ensemble des pages. Cependant, le poids des assets JS est 40% sup√©rieur √† la moyenne.",
                    icon: "üé®"
                },
                {
                    title: "Optimisation Backend (Yannkeep)",
                    type: "force",
                    summary: "Scores 'Core Web Vitals' parfaits.",
                    details: "Yannkeep excelle dans la minimisation des requ√™tes critiques. L'utilisation agressive du cache et la g√©n√©ration statique (SSG) offrent un LCP sous les 0.8s. L'absence de polices web externes contribue √† cette rapidit√©.",
                    icon: "‚ö°"
                },
                {
                    title: "Exp√©rience Mobile",
                    type: "warning",
                    summary: "Incoh√©rences de navigation d√©tect√©es.",
                    details: "Sur les r√©solutions inf√©rieures √† 375px, le menu de navigation de Ouaisfieu pr√©sente des chevauchements. Yannkeep manque de cibles tactiles suffisamment grandes (44px) sur certains boutons d'action.",
                    icon: "üì±"
                },
                {
                    title: "Strat√©gie GitHub Pages",
                    type: "info",
                    summary: "Deux philosophies compl√©mentaires.",
                    details: "L'analyse sugg√®re une collaboration potentielle puissante : fusionner l'esth√©tique et l'UX de Ouaisfieu avec l'infrastructure robuste et optimis√©e de Yannkeep cr√©erait un produit de classe mondiale.",
                    icon: "ü§ù"
                }
            ]
        };

        // --- CHART INSTANCES ---
        let charts = {};

        // --- NAVIGATION LOGIC ---
        function navigateTo(targetId) {
            // Update UI Sidebar
            document.querySelectorAll('.nav-item').forEach(btn => {
                if(btn.dataset.target === targetId) {
                    btn.classList.add('active-nav', 'border-indigo-500', 'bg-slate-800', 'text-white');
                    btn.classList.remove('border-transparent');
                } else {
                    btn.classList.remove('active-nav', 'border-indigo-500', 'bg-slate-800', 'text-white');
                    btn.classList.add('border-transparent');
                }
            });

            // Show/Hide Sections
            document.querySelectorAll('.content-section').forEach(section => {
                if(section.id === targetId) {
                    section.classList.remove('hidden-section');
                    // Trigger chart resize/render if needed when becoming visible
                    if(targetId === 'performance') renderPerformanceCharts();
                    if(targetId === 'engagement') renderTrafficChart('daily');
                } else {
                    section.classList.add('hidden-section');
                }
            });

            // Close mobile menu if open
            const sidebar = document.getElementById('sidebar');
            if (!sidebar.classList.contains('hidden')) {
                sidebar.classList.add('hidden');
            }
        }

        // --- CHART GENERATION FUNCTIONS ---

        function initOverviewChart() {
            const ctx = document.getElementById('deploymentChart').getContext('2d');
            charts.deployment = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: appData.overview.deployments.labels,
                    datasets: [
                        {
                            label: 'Ouaisfieu',
                            data: appData.overview.deployments.ouaisfieu,
                            backgroundColor: '#6366f1', // Indigo 500
                            borderRadius: 4,
                        },
                        {
                            label: 'Yannkeep',
                            data: appData.overview.deployments.yannkeep,
                            backgroundColor: '#10b981', // Emerald 500
                            borderRadius: 4,
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#f1f5f9' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        function renderPerformanceCharts() {
            if (charts.lighthouse) return; // Prevent re-rendering if already exists

            // Radar Chart for Lighthouse
            const ctxLighthouse = document.getElementById('lighthouseChart').getContext('2d');
            charts.lighthouse = new Chart(ctxLighthouse, {
                type: 'radar',
                data: {
                    labels: appData.performance.lighthouse.labels,
                    datasets: [{
                        label: 'Ouaisfieu',
                        data: appData.performance.lighthouse.ouaisfieu,
                        fill: true,
                        backgroundColor: 'rgba(99, 102, 241, 0.2)',
                        borderColor: '#6366f1',
                        pointBackgroundColor: '#6366f1',
                    }, {
                        label: 'Yannkeep',
                        data: appData.performance.lighthouse.yannkeep,
                        fill: true,
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        borderColor: '#10b981',
                        pointBackgroundColor: '#10b981',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: '#e2e8f0' },
                            grid: { color: '#e2e8f0' },
                            suggestedMin: 50,
                            suggestedMax: 100
                        }
                    }
                }
            });

            // Doughnut Chart for Resources
            const ctxResources = document.getElementById('resourcesChart').getContext('2d');
            charts.resources = new Chart(ctxResources, {
                type: 'doughnut',
                data: {
                    labels: appData.performance.resources.labels,
                    datasets: [
                        {
                            label: 'Ouaisfieu (Ko)',
                            data: appData.performance.resources.ouaisfieu,
                            backgroundColor: ['#6366f1', '#818cf8', '#a5b4fc', '#c7d2fe', '#e0e7ff'],
                            borderWidth: 0
                        },
                        {
                            label: 'Yannkeep (Ko)',
                            data: appData.performance.resources.yannkeep,
                            backgroundColor: ['#10b981', '#34d399', '#6ee7b7', '#a7f3d0', '#d1fae5'],
                            borderWidth: 0,
                            hidden: true // Initially hide, user can toggle via legend logic if implemented, or just show simple donut
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: { position: 'right' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + ' Ko';
                                }
                            }
                        }
                    }
                }
            });
        }

        function renderTrafficChart(period) {
            const data = appData.traffic[period];
            const ctx = document.getElementById('trafficChart').getContext('2d');

            if (charts.traffic) {
                charts.traffic.destroy();
            }

            charts.traffic = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Ouaisfieu',
                            data: data.ouaisfieu,
                            borderColor: '#6366f1',
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Yannkeep',
                            data: data.yannkeep,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.0)',
                            borderDash: [5, 5],
                            fill: false,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: '#f1f5f9' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        function updateTrafficView(period) {
            renderTrafficChart(period);
            // Update active button state style (simple implementation)
            const buttons = document.querySelectorAll('#engagement button');
            buttons.forEach(btn => {
                if(btn.textContent.toLowerCase().includes(period === 'daily' ? 'journalier' : 'hebdomadaire')) {
                   btn.classList.remove('bg-slate-100', 'text-slate-600');
                   btn.classList.add('bg-indigo-100', 'text-indigo-700');
                } else {
                   btn.classList.add('bg-slate-100', 'text-slate-600');
                   btn.classList.remove('bg-indigo-100', 'text-indigo-700');
                }
            });
        }

        // --- CONTENT GENERATION ---
        function renderInsights() {
            const grid = document.getElementById('insights-grid');
            grid.innerHTML = '';

            appData.insights.forEach((insight, index) => {
                let colorClass = 'border-l-4 border-indigo-500';
                if(insight.type === 'force') colorClass = 'border-l-4 border-emerald-500';
                if(insight.type === 'warning') colorClass = 'border-l-4 border-amber-500';

                const card = document.createElement('div');
                card.className = `bg-white p-6 rounded-xl shadow-sm border border-slate-100 cursor-pointer hover:shadow-md transition-all ${colorClass}`;
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-bold text-slate-800 text-lg">${insight.icon} ${insight.title}</h3>
                        <span class="text-slate-400 text-xl font-bold toggle-icon">+</span>
                    </div>
                    <p class="text-slate-600 font-medium mb-2">${insight.summary}</p>
                    <p class="text-slate-500 text-sm hidden details-text mt-3 pt-3 border-t border-slate-100 leading-relaxed">${insight.details}</p>
                `;

                card.addEventListener('click', () => {
                    const details = card.querySelector('.details-text');
                    const icon = card.querySelector('.toggle-icon');
                    if(details.classList.contains('hidden')) {
                        details.classList.remove('hidden');
                        icon.textContent = '-';
                        icon.classList.add('text-indigo-500');
                    } else {
                        details.classList.add('hidden');
                        icon.textContent = '+';
                        icon.classList.remove('text-indigo-500');
                    }
                });

                grid.appendChild(card);
            });
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            initOverviewChart();
            renderInsights();

            // Mobile Menu Logic
            document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('hidden');
                sidebar.classList.toggle('absolute');
                sidebar.classList.toggle('inset-0');
                sidebar.classList.toggle('bg-slate-900');
                if(!sidebar.classList.contains('hidden')) {
                     // Ensure it's on top
                     sidebar.style.zIndex = '50';
                }
            });

            // Table Toggle Logic
            document.getElementById('toggle-tech-details').addEventListener('click', () => {
                const container = document.getElementById('tech-table-container');
                if(container.style.display === 'none') {
                    container.style.display = 'block';
                } else {
                    container.style.display = 'none';
                }
            });
        });

    </script>
</body>
</html>
