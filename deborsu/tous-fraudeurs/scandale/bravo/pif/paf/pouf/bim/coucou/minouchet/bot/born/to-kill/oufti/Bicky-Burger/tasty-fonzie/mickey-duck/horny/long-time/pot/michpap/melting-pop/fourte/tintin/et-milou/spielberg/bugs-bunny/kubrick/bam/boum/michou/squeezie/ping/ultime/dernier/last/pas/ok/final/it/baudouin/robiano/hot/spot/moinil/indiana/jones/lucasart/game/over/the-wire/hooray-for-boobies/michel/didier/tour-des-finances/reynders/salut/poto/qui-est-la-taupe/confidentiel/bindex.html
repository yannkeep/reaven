<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>LES PARCHEMINS DE BRUXELLES ‚Äî L'Affaire Reynders</title>
<meta name="description" content="RPG textuel d'investigation citoyenne. Disco Elysium meets Phoenix Wright dans le Palais de Justice de Bruxelles.">
<meta name="theme-color" content="#0a0b0f">
<link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400&family=JetBrains+Mono:wght@300;400;500;700&family=Outfit:wght@300;400;500;600;700;800;900&family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#0a0b0f;--bg2:#0f1117;--bg3:#141620;--bg4:#1a1c2a;
  --text:#c8c4ba;--bright:#ede9df;--dim:#706c62;--muted:#3e3c36;
  --rhet:#d4a843;--flair:#c43838;--reseau:#4488cc;--sang:#3ca85a;--proc:#8855bb;--arch:#33aaaa;
  --rhet-bg:rgba(212,168,67,.08);--flair-bg:rgba(196,56,56,.08);--reseau-bg:rgba(68,136,204,.08);
  --sang-bg:rgba(60,168,90,.08);--proc-bg:rgba(136,85,187,.08);--arch-bg:rgba(51,170,170,.08);
  --gold:#c9a43e;--red:#c43030;--red-glow:#ff4040;
  --serif:'Crimson Pro',Georgia,serif;--mono:'JetBrains Mono',monospace;--sans:'Outfit',sans-serif;
  --frak:'UnifrakturCook',cursive;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px;scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:var(--serif);line-height:1.7;overflow-x:hidden;min-height:100vh;min-height:100dvh;-webkit-font-smoothing:antialiased;-webkit-tap-highlight-color:transparent}
::selection{background:var(--red);color:#fff}
body::after{content:'';position:fixed;inset:0;background:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.02'/%3E%3C/svg%3E");pointer-events:none;z-index:9999}
@keyframes blink{50%{opacity:0}}

/* SCREENS */
.scr{display:none;min-height:100vh;min-height:100dvh;flex-direction:column;opacity:0;transition:opacity .5s}
.scr.on{display:flex}.scr.vis{opacity:1}

/* LOADING TIPS */
#loadTip{position:fixed;bottom:0;left:0;right:0;background:rgba(10,11,15,.95);backdrop-filter:blur(8px);padding:.8rem 1.2rem;font-family:var(--mono);font-size:.65rem;color:var(--dim);z-index:500;transform:translateY(100%);transition:transform .4s;display:flex;gap:.8rem;align-items:center;border-top:1px solid #1a1c2a}
#loadTip.show{transform:translateY(0)}
#loadTip .tip-icon{color:var(--gold);font-size:.9rem;flex-shrink:0}

/* DARK SOULS DEATH */
#deathScreen{position:fixed;inset:0;background:rgba(0,0,0,.95);z-index:600;display:none;justify-content:center;align-items:center;flex-direction:column;text-align:center}
#deathScreen.on{display:flex}
#deathScreen h2{font-family:var(--frak);font-size:clamp(2.5rem,10vw,5rem);color:var(--red);letter-spacing:.05em;opacity:0;animation:deathFade 3s ease forwards}
#deathScreen p{font-family:var(--mono);font-size:.7rem;color:var(--dim);margin-top:1.5rem;opacity:0;animation:deathFade 2s ease 1.5s forwards}
@keyframes deathFade{to{opacity:1}}

/* ACHIEVEMENT */
#achievePop{position:fixed;top:1rem;left:50%;transform:translateX(-50%) translateY(-120%);background:var(--bg3);border:1px solid var(--gold);padding:.6rem 1.2rem;z-index:550;font-family:var(--mono);font-size:.65rem;transition:transform .5s cubic-bezier(.34,1.56,.64,1);display:flex;align-items:center;gap:.6rem;max-width:90vw}
#achievePop.show{transform:translateX(-50%) translateY(0)}
#achievePop .ach-icon{font-size:1.2rem}
#achievePop .ach-title{color:var(--gold);font-weight:700;letter-spacing:.1em;text-transform:uppercase}
#achievePop .ach-desc{color:var(--dim);margin-top:.1rem}

/* CODEC (MGS) */
#codec{position:fixed;inset:0;background:rgba(0,20,0,.92);z-index:500;display:none;flex-direction:column;justify-content:center;align-items:center;padding:2rem}
#codec.on{display:flex}
.codec-frame{border:2px solid var(--sang);padding:2rem;max-width:500px;width:100%;position:relative}
.codec-frame::before{content:'CODEC 141.12';position:absolute;top:-10px;left:10px;background:rgba(0,20,0,1);padding:0 .5rem;font-family:var(--mono);font-size:.6rem;color:var(--sang);letter-spacing:.2em}
.codec-portrait{width:60px;height:60px;border:1px solid var(--sang);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;margin:0 auto 1rem;background:rgba(0,40,0,.5);animation:codecPulse 2s ease-in-out infinite}
@keyframes codecPulse{0%,100%{box-shadow:0 0 10px rgba(60,168,90,.3)}50%{box-shadow:0 0 30px rgba(60,168,90,.5)}}
.codec-name{font-family:var(--mono);font-size:.7rem;color:var(--sang);text-align:center;letter-spacing:.15em;margin-bottom:1rem}
.codec-text{font-family:var(--serif);font-size:.95rem;color:#aaffaa;line-height:1.7;margin-bottom:1rem}
.codec-close{font-family:var(--mono);font-size:.7rem;padding:.5rem 1.5rem;border:1px solid var(--sang);background:transparent;color:var(--sang);cursor:pointer;display:block;margin:0 auto}

/* OBJECTION (Phoenix Wright) */
.objection{position:fixed;inset:0;background:rgba(180,40,20,.95);z-index:550;display:none;justify-content:center;align-items:center}
.objection.on{display:flex}
.objection h2{font-family:var(--sans);font-size:clamp(3rem,15vw,7rem);font-weight:900;color:#fff;letter-spacing:-.02em;animation:objShake .5s ease;text-shadow:4px 4px 0 rgba(0,0,0,.5)}
@keyframes objShake{0%{transform:scale(3) rotate(-5deg);opacity:0}50%{transform:scale(1.1) rotate(2deg);opacity:1}100%{transform:scale(1) rotate(0)}}

/* ============ CHARACTER CREATION (DISCO ELYSIUM) ============ */
#createScreen{padding:1.5rem;padding-bottom:4rem;overflow-y:auto}
.create-title{font-family:var(--sans);font-size:1.8rem;font-weight:900;text-align:center;margin:1rem 0 .3rem;color:var(--bright)}
.create-sub{font-family:var(--serif);font-size:.9rem;font-style:italic;text-align:center;color:var(--dim);margin-bottom:2rem}
.create-points{text-align:center;margin-bottom:1.5rem;font-family:var(--mono);font-size:.8rem}
.create-points strong{font-size:1.3rem;color:var(--gold)}
.skill-grid{display:flex;flex-direction:column;gap:1rem;max-width:500px;margin:0 auto}
.skill-row{background:var(--bg2);border:1px solid var(--bg4);padding:1rem;transition:border-color .3s}
.skill-row:hover{border-color:var(--skill-color)}
.skill-row__top{display:flex;justify-content:space-between;align-items:center;margin-bottom:.3rem}
.skill-row__name{font-family:var(--sans);font-size:.9rem;font-weight:700;color:var(--skill-color)}
.skill-row__val{font-family:var(--mono);font-size:1.1rem;font-weight:700;color:var(--skill-color)}
.skill-row__desc{font-family:var(--serif);font-size:.78rem;color:var(--dim);line-height:1.5;margin-bottom:.6rem;font-style:italic}
.skill-row__controls{display:flex;gap:.5rem;align-items:center}
.skill-btn{width:32px;height:32px;border:1px solid var(--muted);background:transparent;color:var(--dim);font-family:var(--mono);font-size:1rem;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center}
.skill-btn:hover:not(:disabled){border-color:var(--skill-color);color:var(--skill-color)}
.skill-btn:disabled{opacity:.2;cursor:default}
.skill-bar{flex:1;height:6px;background:var(--bg);border-radius:3px;overflow:hidden}
.skill-bar__fill{height:100%;border-radius:3px;background:var(--skill-color);transition:width .3s}
.archetype-section{max-width:500px;margin:2rem auto 0}
.archetype-title{font-family:var(--mono);font-size:.65rem;letter-spacing:.2em;text-transform:uppercase;color:var(--dim);margin-bottom:.8rem;text-align:center}
.archetype-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:.5rem}
.arch-btn{background:var(--bg2);border:1px solid var(--bg4);padding:.8rem .5rem;text-align:center;cursor:pointer;transition:all .3s;font-family:inherit;color:inherit}
.arch-btn:hover,.arch-btn.sel{border-color:var(--gold);background:var(--bg3)}
.arch-btn__icon{font-size:1.3rem;margin-bottom:.2rem}
.arch-btn__name{font-family:var(--sans);font-size:.7rem;font-weight:600;color:var(--bright)}
.arch-btn__desc{font-family:var(--mono);font-size:.5rem;color:var(--dim);margin-top:.2rem}
.btn-create{display:block;max-width:500px;width:100%;margin:2rem auto 0;font-family:var(--mono);font-size:.8rem;letter-spacing:.1em;text-transform:uppercase;padding:1rem;border:1px solid var(--gold);color:var(--gold);background:transparent;cursor:pointer;transition:all .3s}
.btn-create:hover{background:var(--gold);color:var(--bg)}
.btn-create:disabled{opacity:.3;cursor:default}

/* ============ GAME SCREEN ============ */
#gameScreen{padding:0}
.g-top{position:sticky;top:0;z-index:50;background:rgba(10,11,15,.92);backdrop-filter:blur(10px);border-bottom:1px solid var(--bg4);padding:.5rem 1rem;display:flex;align-items:center;justify-content:space-between}
.g-top__loc{font-family:var(--mono);font-size:.6rem;color:var(--dim);letter-spacing:.1em}
.g-top__ch{font-family:var(--sans);font-size:.75rem;font-weight:600;color:var(--bright)}
.g-top__btns{display:flex;gap:.3rem}
.g-btn{width:34px;height:34px;border:1px solid var(--bg4);background:transparent;color:var(--dim);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:.9rem;transition:all .2s;position:relative}
.g-btn:hover{border-color:var(--dim);color:var(--bright)}
.g-btn .notif{position:absolute;top:3px;right:3px;width:6px;height:6px;border-radius:50%;background:var(--red-glow)}

.g-body{flex:1;padding:1.2rem;max-width:640px;margin:0 auto;width:100%;padding-bottom:3rem}

/* Narrative blocks */
.nb{margin-bottom:1.2rem;opacity:0;transform:translateY(12px);animation:nUp .5s ease forwards}
.nb:nth-child(2){animation-delay:.2s}.nb:nth-child(3){animation-delay:.4s}.nb:nth-child(4){animation-delay:.6s}
.nb:nth-child(5){animation-delay:.8s}.nb:nth-child(6){animation-delay:1s}.nb:nth-child(7){animation-delay:1.2s}
.nb:nth-child(8){animation-delay:1.4s}.nb:nth-child(9){animation-delay:1.6s}.nb:nth-child(10){animation-delay:1.8s}
@keyframes nUp{to{opacity:1;transform:translateY(0)}}

.nt{font-size:1.02rem;line-height:1.75}.nt strong{color:var(--gold);font-weight:600}.nt em{color:var(--bright)}

/* Skill thought (Disco Elysium) */
.skill-thought{padding:.8rem 1rem;margin:1rem 0;border-left:3px solid var(--thought-color);background:var(--thought-bg);font-family:var(--serif);font-size:.9rem;font-style:italic;line-height:1.6;position:relative}
.skill-thought__label{font-family:var(--mono);font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--thought-color);margin-bottom:.3rem;font-style:normal}

/* Skill check */
.skill-check{background:var(--bg3);border:1px solid var(--bg4);padding:1rem;margin:1.2rem 0;text-align:center;position:relative;overflow:hidden}
.skill-check__label{font-family:var(--mono);font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;color:var(--dim);margin-bottom:.4rem}
.skill-check__name{font-family:var(--sans);font-size:.85rem;font-weight:700;margin-bottom:.3rem}
.skill-check__result{font-family:var(--mono);font-size:.7rem;margin-top:.4rem;padding:.3rem .8rem;display:inline-block}
.skill-check__result.pass{color:var(--sang);border:1px solid var(--sang);background:rgba(60,168,90,.08)}
.skill-check__result.fail{color:var(--red);border:1px solid var(--red);background:rgba(196,48,48,.08)}

/* Evidence found */
.ev-found{background:var(--bg2);border:1px solid var(--gold);padding:1rem;margin:1.2rem 0;animation:evFlash .6s ease}
@keyframes evFlash{0%{box-shadow:0 0 30px rgba(201,164,62,.3)}100%{box-shadow:none}}
.ev-found__tag{font-family:var(--mono);font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--gold);margin-bottom:.3rem}
.ev-found__name{font-family:var(--sans);font-size:.9rem;font-weight:700;color:var(--bright);margin-bottom:.3rem}
.ev-found__desc{font-family:var(--serif);font-size:.82rem;color:var(--dim);line-height:1.5}

/* Dialogue */
.dlg{background:var(--bg2);border:1px solid var(--bg4);padding:1rem 1.2rem;margin:1.2rem 0;position:relative;border-radius:0 8px 8px 0;border-left:3px solid var(--dim)}
.dlg__text{font-family:var(--serif);font-size:.95rem;font-style:italic;color:var(--bright);line-height:1.6}
.dlg__who{font-family:var(--mono);font-size:.6rem;color:var(--dim);margin-top:.5rem;letter-spacing:.05em}

/* System message */
.sys-msg{text-align:center;padding:.8rem;font-family:var(--mono);font-size:.65rem;color:var(--dim);letter-spacing:.1em;border-top:1px solid var(--bg4);border-bottom:1px solid var(--bg4);margin:1.5rem 0}

/* Choices */
.choices{margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--bg4);opacity:0;animation:nUp .5s ease 2s forwards}
.choices__label{font-family:var(--mono);font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--muted);text-align:center;margin-bottom:1rem}
.ch-btn{display:block;width:100%;text-align:left;background:var(--bg2);border:1px solid var(--bg4);padding:1rem 1.2rem;margin-bottom:.7rem;cursor:pointer;transition:all .3s;font-family:inherit;color:inherit;position:relative;overflow:hidden}
.ch-btn::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--gold);transform:scaleY(0);transition:transform .3s;transform-origin:bottom}
.ch-btn:hover::before,.ch-btn:active::before{transform:scaleY(1)}
.ch-btn:hover,.ch-btn:active{border-color:var(--gold);transform:translateX(4px)}
.ch-btn__key{font-family:var(--mono);font-size:.55rem;color:var(--gold);letter-spacing:.15em;text-transform:uppercase;margin-bottom:.2rem}
.ch-btn__text{font-family:var(--serif);font-size:.92rem;line-height:1.5;color:var(--text)}
.ch-btn__meta{font-family:var(--mono);font-size:.55rem;color:var(--muted);margin-top:.3rem}
.ch-btn__req{color:var(--proc);font-style:italic}
.ch-btn.locked{opacity:.4;cursor:default;transform:none!important}
.ch-btn.locked::before{display:none}

/* Boss fight (Phoenix Wright) */
.boss-area{background:var(--bg2);border:2px solid var(--red);padding:1.5rem;margin:1.5rem 0;position:relative}
.boss-area::before{content:'‚öîÔ∏è CONFRONTATION';position:absolute;top:-10px;left:12px;background:var(--bg);padding:0 .6rem;font-family:var(--mono);font-size:.6rem;letter-spacing:.2em;color:var(--red)}
.boss-health{margin-bottom:1rem}
.boss-health__label{font-family:var(--mono);font-size:.6rem;color:var(--dim);margin-bottom:.3rem;display:flex;justify-content:space-between}
.boss-health__bar{height:8px;background:var(--bg);border-radius:4px;overflow:hidden}
.boss-health__fill{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--red),var(--flair));transition:width .5s}
.boss-text{font-family:var(--serif);font-size:.95rem;line-height:1.6;margin-bottom:1rem}
.ev-select{display:grid;grid-template-columns:1fr 1fr;gap:.5rem;margin-top:1rem}
.ev-opt{background:var(--bg3);border:1px solid var(--bg4);padding:.7rem;cursor:pointer;transition:all .2s;text-align:center;font-family:inherit;color:inherit}
.ev-opt:hover{border-color:var(--gold);background:var(--bg4)}
.ev-opt__name{font-family:var(--sans);font-size:.7rem;font-weight:600;color:var(--bright)}
.ev-opt__tag{font-family:var(--mono);font-size:.5rem;color:var(--dim)}

/* OVERLAYS */
.overlay{position:fixed;inset:0;background:rgba(10,11,15,.95);z-index:200;display:none;flex-direction:column;overflow-y:auto;padding:1rem}
.overlay.on{display:flex}
.ov-header{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;margin-bottom:1rem;border-bottom:1px solid var(--bg4);position:sticky;top:0;background:rgba(10,11,15,.95);z-index:1}
.ov-header h3{font-family:var(--sans);font-size:1rem;font-weight:700}
.ov-close{width:36px;height:36px;background:transparent;border:1px solid var(--bg4);color:var(--dim);font-size:1.1rem;cursor:pointer;display:flex;align-items:center;justify-content:center}
.ov-close:hover{border-color:var(--dim);color:var(--bright)}

/* Stats in overlay */
.os-row{margin-bottom:1.2rem}
.os-row__top{display:flex;justify-content:space-between;margin-bottom:.2rem}
.os-row__name{font-family:var(--mono);font-size:.65rem;letter-spacing:.1em;text-transform:uppercase}
.os-row__val{font-family:var(--sans);font-size:.9rem;font-weight:700}
.os-row__bar{height:5px;background:var(--bg);border-radius:3px;overflow:hidden}
.os-row__fill{height:100%;border-radius:3px;transition:width .6s}
.os-row__hint{font-family:var(--serif);font-size:.7rem;color:var(--muted);margin-top:.2rem;font-style:italic}

/* Evidence overlay */
.evi{background:var(--bg2);border:1px solid var(--bg4);padding:.8rem;margin-bottom:.6rem}
.evi.lock{opacity:.25;border-style:dashed}
.evi__tag{font-family:var(--mono);font-size:.5rem;letter-spacing:.15em;text-transform:uppercase;margin-bottom:.2rem}
.evi__name{font-family:var(--sans);font-size:.8rem;font-weight:600;color:var(--bright)}
.evi__desc{font-family:var(--serif);font-size:.75rem;color:var(--dim);line-height:1.4;margin-top:.2rem}

/* Ending */
#endScreen{justify-content:center;align-items:center;text-align:center;padding:2rem}
.end-badge{font-family:var(--mono);font-size:.55rem;letter-spacing:.3em;text-transform:uppercase;color:var(--gold);margin-bottom:1rem}
.end-title{font-family:var(--sans);font-size:clamp(1.5rem,7vw,2.8rem);font-weight:900;line-height:1.1;margin-bottom:1.5rem}
.end-text{font-family:var(--serif);font-size:.95rem;color:var(--dim);max-width:500px;margin:0 auto 2rem;line-height:1.7}
.end-stats{display:grid;grid-template-columns:1fr 1fr;gap:.8rem;max-width:350px;margin:0 auto 2rem}
.end-s{background:var(--bg2);border:1px solid var(--bg4);padding:.8rem}
.end-s__v{font-family:var(--sans);font-size:1.3rem;font-weight:900;color:var(--gold)}
.end-s__l{font-family:var(--mono);font-size:.5rem;letter-spacing:.1em;text-transform:uppercase;color:var(--muted);margin-top:.1rem}
.end-btns{display:flex;gap:.8rem;justify-content:center;flex-wrap:wrap}
.end-btn{font-family:var(--mono);font-size:.7rem;letter-spacing:.08em;text-transform:uppercase;padding:.7rem 2rem;border:1px solid var(--dim);color:var(--dim);background:transparent;cursor:pointer;transition:all .3s}
.end-btn:hover{border-color:var(--gold);color:var(--gold)}
.end-cta{font-family:var(--serif);font-size:.8rem;color:var(--muted);max-width:450px;margin:2rem auto 0;line-height:1.6}
.end-cta a{color:var(--gold);text-decoration:none;border-bottom:1px solid rgba(201,164,62,.3)}

/* Stat change notif */
.sc-notif{position:fixed;top:50px;right:.8rem;background:var(--bg3);border:1px solid var(--bg4);padding:.4rem .8rem;font-family:var(--mono);font-size:.65rem;z-index:100;animation:scSlide 2.2s ease forwards;pointer-events:none}
.sc-notif.pos{border-color:var(--sang);color:var(--sang)}
.sc-notif.neg{border-color:var(--red);color:var(--red)}
@keyframes scSlide{0%{transform:translateX(120%);opacity:0}10%{transform:translateX(0);opacity:1}80%{transform:translateX(0);opacity:1}100%{transform:translateX(120%);opacity:0}}

/* ============ MAP HUB ============ */
.map-hub{padding:1.5rem;padding-bottom:4rem}
.map-header{text-align:center;margin-bottom:1.5rem}
.map-header h2{font-family:var(--sans);font-size:1.4rem;font-weight:800;color:var(--bright)}
.map-header p{font-family:var(--mono);font-size:.6rem;color:var(--dim);letter-spacing:.1em;margin-top:.3rem}
.map-grid{display:flex;flex-direction:column;gap:.8rem;max-width:500px;margin:0 auto}
.map-loc{background:var(--bg2);border:1px solid var(--bg4);padding:1.2rem;cursor:pointer;transition:all .3s;position:relative;overflow:hidden}
.map-loc::after{content:'';position:absolute;top:0;right:0;width:50px;height:100%;background:linear-gradient(90deg,transparent,rgba(201,164,62,.03));pointer-events:none}
.map-loc:hover{border-color:var(--gold);transform:translateX(4px)}
.map-loc.visited{border-left:3px solid var(--sang)}
.map-loc.locked{opacity:.3;cursor:default;transform:none!important}
.map-loc.locked:hover{border-color:var(--bg4)}
.map-loc__zone{font-family:var(--mono);font-size:.5rem;letter-spacing:.2em;text-transform:uppercase;color:var(--dim);margin-bottom:.3rem}
.map-loc__name{font-family:var(--sans);font-size:.95rem;font-weight:700;color:var(--bright);margin-bottom:.2rem}
.map-loc__desc{font-family:var(--serif);font-size:.8rem;color:var(--dim);line-height:1.4}
.map-loc__tag{position:absolute;top:.8rem;right:.8rem;font-family:var(--mono);font-size:.5rem;padding:.2rem .5rem;border:1px solid var(--bg4)}
.map-loc__tag.new{border-color:var(--gold);color:var(--gold)}
.map-loc__tag.done{border-color:var(--sang);color:var(--sang)}
.map-loc__tag.boss{border-color:var(--red);color:var(--red);animation:bossTag 2s ease-in-out infinite}
@keyframes bossTag{0%,100%{opacity:1}50%{opacity:.5}}

/* ============ CODEX ============ */
.codex-grid{display:flex;flex-direction:column;gap:.6rem;padding-bottom:2rem}
.codex-entry{background:var(--bg2);border:1px solid var(--bg4);overflow:hidden;transition:border-color .3s}
.codex-entry.lock{opacity:.2;border-style:dashed}
.codex-entry.lock .codex-body{display:none}
.codex-head{padding:.8rem 1rem;cursor:pointer;display:flex;justify-content:space-between;align-items:center}
.codex-head__name{font-family:var(--sans);font-size:.85rem;font-weight:600;color:var(--bright)}
.codex-head__cat{font-family:var(--mono);font-size:.5rem;letter-spacing:.15em;text-transform:uppercase}
.codex-body{padding:0 1rem .8rem;display:none}
.codex-body.open{display:block}
.codex-body p{font-family:var(--serif);font-size:.8rem;color:var(--dim);line-height:1.5;margin-bottom:.4rem}
.codex-body .codex-ref{font-family:var(--mono);font-size:.55rem;color:var(--muted);font-style:italic;margin-top:.3rem}

/* ============ QUEST LOG ============ */
.quest{background:var(--bg2);border:1px solid var(--bg4);padding:.8rem 1rem;margin-bottom:.5rem}
.quest.active{border-left:3px solid var(--gold)}
.quest.done{border-left:3px solid var(--sang);opacity:.6}
.quest__name{font-family:var(--sans);font-size:.8rem;font-weight:600;color:var(--bright)}
.quest__desc{font-family:var(--serif);font-size:.75rem;color:var(--dim);margin-top:.2rem}
.quest__prog{font-family:var(--mono);font-size:.55rem;color:var(--gold);margin-top:.3rem}

/* ============ XP BAR ============ */
.xp-bar{position:fixed;bottom:0;left:0;right:0;height:3px;background:var(--bg);z-index:40}
.xp-bar__fill{height:100%;background:linear-gradient(90deg,var(--gold),var(--rhet));transition:width .8s ease;width:0}

/* ============ SAVE INDICATOR ============ */
.save-icon{position:fixed;bottom:12px;right:12px;font-family:var(--mono);font-size:.55rem;color:var(--muted);z-index:40;opacity:0;transition:opacity .5s}
.save-icon.show{opacity:1}

/* ============ LEVEL UP ============ */
#levelUp{position:fixed;inset:0;background:rgba(10,11,15,.95);z-index:500;display:none;justify-content:center;align-items:center;flex-direction:column;text-align:center;padding:2rem}
#levelUp.on{display:flex}
.lvl-title{font-family:var(--frak);font-size:clamp(2rem,8vw,3.5rem);color:var(--gold);margin-bottom:.5rem}
.lvl-sub{font-family:var(--mono);font-size:.7rem;color:var(--dim);letter-spacing:.15em;margin-bottom:2rem}
.lvl-skill{font-family:var(--sans);font-size:1.2rem;font-weight:700;margin-bottom:1.5rem}
.lvl-btn{font-family:var(--mono);font-size:.7rem;padding:.6rem 2rem;border:1px solid var(--gold);color:var(--gold);background:transparent;cursor:pointer}

@media(max-width:768px){.ev-select{grid-template-columns:1fr}}
</style>
</head>
<body>

<div class="scr on" id="bootScr"></div>
<div class="scr" id="titleScr"></div>
<div class="scr" id="createScreen"></div>
<div class="scr" id="mapScreen"></div>
<div class="scr" id="gameScreen"></div>
<div class="scr" id="endScreen"></div>

<div id="loadTip"><span class="tip-icon">üí°</span><span id="tipText"></span></div>
<div id="deathScreen"><h2>Grill√©</h2><p>Votre couverture est compromise. L'enqu√™te s'arr√™te ici.</p><p style="font-family:var(--mono);font-size:.55rem;color:var(--muted);margin-top:1rem">¬´ Ashen one, you must link the First Flame. ¬ª ‚Äî Ou, dans votre cas, survivre √† la commission parlementaire.</p><button onclick="respawn()" style="font-family:var(--mono);font-size:.65rem;padding:.5rem 1.5rem;border:1px solid var(--red);color:var(--red);background:transparent;cursor:pointer;margin-top:1rem">üî• Revenir au feu de camp</button></div>
<div id="achievePop"><span class="ach-icon">üèÜ</span><div><div class="ach-title"></div><div class="ach-desc"></div></div></div>
<div id="codec"></div>
<div id="levelUp"><div class="lvl-title">Niveau Sup√©rieur</div><div class="lvl-sub" id="lvlSub"></div><div class="lvl-skill" id="lvlSkill"></div><button class="lvl-btn" onclick="closeLevelUp()">Continuer</button></div>
<div class="overlay" id="statsOv"></div>
<div class="overlay" id="evidOv"></div>
<div class="overlay" id="codexOv"></div>
<div class="overlay" id="questOv"></div>
<div class="xp-bar"><div class="xp-bar__fill" id="xpFill"></div></div>
<div class="save-icon" id="saveIcon">üíæ Sauvegarde...</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// THE ELDER SCROLLS OF BRUXELLES
// Game Engine ‚Äî Phase 1
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const G = {
  skills: { rhet:3, flair:3, reseau:3, sang:3, proc:3, arch:3 },
  points: 6,
  evidence: new Set(),
  achievements: new Set(),
  scene: 'prologue_1',
  flags: {},
  hp: 100, // "credibility HP" for boss fights
  bossHP: 0,
  history: []
};

const SKILLS = {
  rhet: { name:'Rh√©torique', color:'var(--rhet)', bg:'var(--rhet-bg)', desc:'La voix politique dans votre t√™te. Analyse le discours, d√©tecte le spin, construit l\'argumentaire.' },
  flair: { name:'Flair Financier', color:'var(--flair)', bg:'var(--flair-bg)', desc:'L\'instinct de l\'argent. Suit les flux, rep√®re les anomalies, sent la fraude √† dix kilom√®tres.' },
  reseau: { name:'R√©seau', color:'var(--reseau)', bg:'var(--reseau-bg)', desc:'Qui conna√Æt qui. Cartographie les connexions, identifie les alliances, active les contacts.' },
  sang: { name:'Sang-Froid', color:'var(--sang)', bg:'var(--sang-bg)', desc:'Le calme sous la temp√™te. R√©siste √† l\'intimidation, encaisse la pression, garde le cap.' },
  proc: { name:'Proc√©dure', color:'var(--proc)', bg:'var(--proc-bg)', desc:'La lettre de la loi. Ma√Ætrise des immunit√©s, des d√©lais, des voies de recours et des pi√®ges juridiques.' },
  arch: { name:'Archive', color:'var(--arch)', bg:'var(--arch-bg)', desc:'La m√©moire des scandales. Connecte les pr√©c√©dents, exhume les dossiers oubli√©s, recoupe les dates.' }
};

const EVIDENCE = {
  'cash-ing':{tag:'FINANCIER',name:'Relev√©s ING (2008-2018)',desc:'700-800K‚Ç¨ de d√©p√¥ts cash. Aucune d√©claration en 10 ans.',c:'var(--flair)'},
  'billets-500':{tag:'MAT√âRIEL',name:'Billets de 500‚Ç¨',desc:'7 000‚Ç¨ retrouv√©s dont des coupures retir√©es en 2019.',c:'var(--red)'},
  'loterie':{tag:'FINANCIER',name:'Donn√©es Loterie Nationale',desc:'Limite de 500‚Ç¨/semaine atteinte chaque semaine. Profil unique en Belgique.',c:'var(--gold)'},
  'kpmg':{tag:'AUDIT',name:'Rapport KPMG',desc:'Audit concluant au risque de blanchiment. Profil ¬´ politiquement sensible ¬ª.',c:'var(--gold)'},
  'surete-fonti':{tag:'CLASSIFI√â',name:'Rapports S√ªret√© ‚Äî Fontinoy',desc:'¬´ Le d√©cideur √† la R√©gie des b√¢timents est clairement Fontinoy. ¬ª',c:'var(--sang)'},
  'bakchich':{tag:'CLASSIFI√â',name:'Bakchich 50K‚Ç¨ Kinshasa',desc:'Besix refuse un bakchich de 50K demand√© par Fontinoy.',c:'var(--sang)'},
  'million':{tag:'CLASSIFI√â',name:'Paiement occulte 1M‚Ç¨',desc:'Fontinoy conditionne le d√©m√©nagement police √† 1M‚Ç¨ occulte.',c:'var(--sang)'},
  'kazakh-loi':{tag:'L√âGISLATIF',name:'Loi Transaction P√©nale',desc:'Texte sur la table le 31/01/2011. Vot√© le m√™me jour.',c:'var(--proc)'},
  'kazakh-chodiev':{tag:'JUDICIAIRE',name:'Transaction Chodiev',desc:'3,5M‚Ç¨ vers√©s. Contrat h√©licopt√®res 10 jours apr√®s.',c:'var(--proc)'},
  'libye':{tag:'DIPLOMATIQUE',name:'Fonds libyens ‚Äî Euroclear',desc:'10 milliards‚Ç¨ √©vapor√©s des 16,1 gel√©s.',c:'var(--reseau)'},
  'enveloppe':{tag:'CORRUPTION',name:'Enveloppe 50K‚Ç¨ (Libye)',desc:'Fontinoy accus√© d\'avoir accept√© un pot-de-vin.',c:'var(--red)'},
  'carmeuse':{tag:'CONFLIT D\'INT√âR√äTS',name:'Administrateur Carmeuse',desc:'Reynders reste admin r√©mun√©r√© 1 an apr√®s sa nomination de ministre.',c:'var(--rhet)'},
  'notionnels':{tag:'FISCALIT√â',name:'Int√©r√™ts Notionnels',desc:'Loi r√©dig√©e par la FEB. Milliards siphonn√©s.',c:'var(--proc)'},
  'brulin':{tag:'PLACEMENT',name:'Nomination Brulin ‚Äî S√ªret√©',desc:'Ex-cabinet Reynders nomm√© n¬∞3 S√ªret√©. Moment de la mise √† l\'√©cart d\'Ullens.',c:'var(--sang)'},
  'theunissen':{tag:'ART',name:'Galerie Theunissen ‚Äî Sablon',desc:'Fontinoy s\'y rend ¬´ quotidiennement ¬ª. Circuit Gu√©ant.',c:'var(--gold)'},
  'prignon':{tag:'FAMILIAL',name:'Double compte Prignon',desc:'√âpouse magistrate utilisant un 2e compte joueur.',c:'var(--flair)'},
  'frere':{tag:'R√âSEAU',name:'Lien Fr√®re-Reynders',desc:'Villa Marrakech, propri√©t√© Burdinne, L√©gion d\'honneur.',c:'var(--reseau)'},
  'fortis':{tag:'CRISE',name:'Rapport Morgan Stanley',desc:'BNP acquiert Fortis ¬´ pour rien ¬ª. 500K actionnaires l√©s√©s.',c:'var(--flair)'},
  'ullens':{tag:'OBSTRUCTION',name:'Classement Ullens sept. 2019',desc:'Class√© sans suite 1 semaine avant l\'audition commissaire.',c:'var(--red)'},
  'gare-mons':{tag:'MARCH√âS',name:'Gare de Mons ‚Äî Calatrava',desc:'37M‚Ç¨ ‚Üí 480M‚Ç¨. Accord secret Fontinoy-Bourlard.',c:'var(--arch)'},
  'deripaska':{tag:'OLIGARCHIE',name:'ASBL Deripaska ‚Äî Uccle',desc:'878K‚Ç¨ via ASBL. Fondation artistique.',c:'var(--red)'},
  'ctif':{tag:'ANTI-BLANCHIMENT',name:'Transmission CTIF ‚Äî 2023',desc:'ING signale 800K‚Ç¨ de mouvements suspects. 5 ans apr√®s l\'entretien.',c:'var(--flair)'},
  'prince':{tag:'DIPLOMATIQUE',name:'Photo prince narcotrafiquant',desc:'Reynders avec Nayef Al-Shaalan, condamn√© pour 2t de coca√Øne.',c:'var(--arch)'},
  'audenaert':{tag:'POLICE',name:'Affaire Audenaert-Breevast',desc:'Dir. police re√ßoit 100K‚Ç¨ de Breevast. Fontinoy d√©cideur.',c:'var(--sang)'}
};

const TIPS = [
  "¬´ It's dangerous to go alone. Take this. ¬ª ‚Äî Votre premier indice est votre meilleure arme.",
  "Le Flair Financier sent le cash noir comme un limier sent le gibier.",
  "Dans ce monde, l'immunit√© parlementaire est l'√©quivalent du bouclier hylien.",
  "Astuce : Chaque comp√©tence √† 6+ d√©bloque des options de dialogue secr√®tes.",
  "¬´ War... war never changes. ¬ª ‚Äî Ni la corruption syst√©mique en Belgique.",
  "Conseil de pro : Les billets de 500‚Ç¨ sont les ¬´ √©toiles rouges ¬ª de ce jeu.",
  "La Loterie Nationale redistribue 60% des mises. Le reste, c'est le prix du blanchiment.",
  "Tous les personnages de ce jeu b√©n√©ficient de la pr√©somption d'innocence.",
  "La ¬´ loi Fontinoy ¬ª de 2010 a supprim√© la limite d'√¢ge de 65 ans. Juste pour lui.",
  "Si votre Sang-Froid tombe √† 0, c'est le Game Over. Comme dans Dark Souls mais en moins gothique.",
  "La gare de Mons est pass√©e de 37M‚Ç¨ √† 480M‚Ç¨. C'est plus cher qu'un DLC √† ce prix-l√†.",
  "¬´ Do you get to the Cloud District very often? ¬ª ‚Äî Non, mais au Sablon, quotidiennement.",
  "Le G10 c'est comme un raid √† 10 joueurs, sauf que le loot c'est la politique mon√©taire mondiale.",
  "‚öñÔ∏è Sources : M√©dor, BX1, Le Soir, Le Vif, The Brussels Times, rapports parlementaires.",
  "¬´ The cake is a lie. ¬ª ‚Äî Et les ¬´ ventes d'art ¬ª aussi, apparemment.",
  "¬´ Would you kindly ¬ª signaler 800K‚Ç¨ de cash suspect ? ING a attendu 10 ans.",
  "L'immunit√© du commissaire europ√©en, c'est le Star Power de Mario : temporaire, mais √ßa change tout.",
  "Comme disait Sun Tzu (et Solid Snake) : la patience est la plus grande des armes.",
  "¬´ I used to be an investigator like you, then I took a classified report to the knee. ¬ª",
  "La CTIF c'est l'Oracle dans Matrix ‚Äî elle voit tout, mais ne parle que quand elle veut.",
  "¬´ Stay a while and listen. ¬ª ‚Äî Deckard Cain n'a jamais eu un dossier aussi √©pais.",
  "Reynders a pr√©sid√© le G10 ET blanchissait via des tickets √† gratter. Dual class build l√©gendaire.",
  "Le Sablon c'est le Grand Bazaar de WoW mais avec de vrais antiquaires complices.",
  "¬´ MISSION FAILED ‚Äî We'll get 'em next time. ¬ª ‚Äî Le classement Ullens de 2019, en r√©sum√©.",
  "Chaque zone de la carte de Bruxelles est un donjon. Le Palais de Justice est le raid final.",
  "Fontinoy √† la SNCB depuis 1967 : plus vieux PNJ actif de l'histoire du gaming belge.",
  "Fun fact : le mot ¬´ bakchich ¬ª vient du persan bakhshƒ´sh. Fontinoy en demandait 50K pour Kinshasa.",
  "¬´ Hey! Listen! ¬ª ‚Äî Navi a moins de choses utiles √† dire que votre comp√©tence Rh√©torique.",
  "Le rapport KPMG, c'est comme trouver un log audio dans un survival horror : tout s'explique.",
  "¬´ You died. ¬ª Mais contrairement √† Dark Souls, le respawn n'efface pas les preuves."
];

// ‚îÄ‚îÄ CODEX DATABASE ‚îÄ‚îÄ
const CODEX = {
  reynders: { cat:'PERSONNAGE', name:'Didier Reynders', color:'var(--red)',
    text:'N√© en 1958 √† Li√®ge. Licenci√© en droit (ULi√®ge). Pr√©sident de la SNCB √† 29 ans (1986). Ministre des Finances (1999-2011), Affaires √©trang√®res (2011-2019), Commissaire europ√©en √† la Justice (2019-2024). Inculp√© de blanchiment le 16 octobre 2025. Son parcours est celui d\'un homme qui n\'a jamais quitt√© le pouvoir ‚Äî il a juste chang√© de bureau.',
    ref:'Sources : M√©dor, Le Vif, Brussels Times',
    unlock:'prologue_1' },
  fontinoy: { cat:'PERSONNAGE', name:'Jean-Claude Fontinoy', color:'var(--sang)',
    text:'N√© en 1945. Ing√©nieur SNCB depuis 1967. Rencontre Reynders en 1986. D√©crit par la S√ªret√© comme ¬´ le d√©cideur ¬ª √† la R√©gie des b√¢timents. Pr√©sident de la SNCB (loi sur mesure en 2010 pour supprimer la limite d\'√¢ge). Inculp√© d\'association de malfaiteurs le 16 f√©vrier 2026. Fr√©quentait quotidiennement la galerie Theunissen au Sablon.',
    ref:'Sources : Rapports S√ªret√© de l\'√âtat, M√©dor n¬∞39',
    unlock:'act1_clan' },
  theunissen: { cat:'PERSONNAGE', name:'Olivier Theunissen', color:'var(--gold)',
    text:'Antiquaire, galerie au Sablon (rue de la R√©gence). Fontinoy s\'y rendait ¬´ quasiment quotidiennement ¬ª. Inculp√© d\'association de malfaiteurs en f√©vrier 2026. Circuit pr√©sum√© de fausses factures d\'art ‚Äî comparable √† l\'affaire Gu√©ant en France.',
    ref:'Sources : M√©dor, Le Soir',
    unlock:'act1_clan' },
  prignon: { cat:'PERSONNAGE', name:'Bernadette Prignon', color:'var(--proc)',
    text:'√âpouse de Reynders. Pr√©sidente de chambre √† la Cour d\'appel de Li√®ge. Utilisait un second compte joueur √† la Loterie Nationale. Non inculp√©e √† ce stade. Sa s≈ìur Dani√®le fut procureure du Roi √† Li√®ge. L\'institution judiciaire li√©geoise est un fief familial.',
    ref:'Sources : M√©dor, Het Laatste Nieuws',
    unlock:'act1_loterie' },
  ullens: { cat:'PERSONNAGE', name:'Nicolas Ullens', color:'var(--sang)',
    text:'Ancien inspecteur de la S√ªret√© de l\'√âtat (2007-2018). A d√©nonc√© le r√©seau Fontinoy d√®s 2012. Mis √† l\'√©cart apr√®s la nomination de Brulin en 2015. D√©pose plainte en 2019 ‚Äî class√©e sans suite une semaine avant l\'audition de Reynders au Parlement europ√©en. Son avocat Me Deswaef d√©nonce publiquement l\'absence de ¬´ devoirs d\'enqu√™te simples et √©l√©mentaires ¬ª.',
    ref:'Sources : M√©dor, RTBF, De Standaard',
    unlock:'act1_ullens' },
  ing: { cat:'INSTITUTION', name:'ING Belgique', color:'var(--flair)',
    text:'Banque ayant h√©berg√© les d√©p√¥ts cash de Reynders pendant 10 ans (2008-2018). L\'interroge en 2018, accepte l\'explication ¬´ ventes d\'art ¬ª sans preuve. Ne signale √† la CTIF qu\'en 2023. Vis√©e par une information judiciaire pour trafic d\'influence en ao√ªt 2025. Au conseil d\'admin : Luc Bertrand (ami de Reynders) et connexion Wunsch (BNB).',
    ref:'Sources : KU Leuven (Pr. Colaert), Le Soir, De Tijd',
    unlock:'act1_ing' },
  loterie: { cat:'INSTITUTION', name:'Loterie Nationale', color:'var(--gold)',
    text:'Institution publique sous tutelle du ministre des Finances (Reynders 1999-2011). D√©tecte le profil anormal en 2021 via ses algorithmes. Commande un audit KPMG en 2022. Signale au parquet en mars 2022. A fait ce qu\'ING n\'a pas fait en 10 ans : son travail.',
    ref:'Sources : Rapport KPMG, M√©dor, BX1',
    unlock:'act1_loterie' },
  kazakhgate: { cat:'AFFAIRE', name:'Le Kazakhgate', color:'var(--proc)',
    text:'2011 : loi sur la transaction p√©nale √©largie, vot√©e en un jour, qui permet √† l\'oligarque Chodiev d\'√©chapper √† 48 chefs d\'inculpation contre 3,5M‚Ç¨. 10 jours apr√®s : contrat d\'h√©licopt√®res France-Kazakhstan. Commission d\'enqu√™te parlementaire (2017-18) : ¬´ immixtion inacceptable des autorit√©s fran√ßaises ¬ª. Reynders blanchi par la majorit√©. Cash en billets de 500‚Ç¨ document√© dans l\'affaire ‚Äî les m√™mes coupures retrouv√©es chez Reynders en 2024.',
    ref:'Sources : Commission parlementaire, M√©dor, Le Soir',
    unlock:'act1_kazakh' },
  libye: { cat:'AFFAIRE', name:'Fonds libyens gel√©s', color:'var(--reseau)',
    text:'16,1 milliards‚Ç¨ d\'actifs libyens gel√©s chez Euroclear en 2011 (r√©solution ONU). 10 milliards ¬´ √©vapor√©s ¬ª ‚Äî interpr√©tation controvers√©e sur le sort des int√©r√™ts. Fontinoy accus√© d\'avoir accept√© une enveloppe de 50 000‚Ç¨ maquill√©e en ¬´ projet environnemental ¬ª. Reynders ministre des Affaires √©trang√®res au moment des faits.',
    ref:'Sources : Reuters, Le Vif, Parlement',
    unlock:'act1_sources' },
  regie: { cat:'INSTITUTION', name:'R√©gie des B√¢timents', color:'var(--arch)',
    text:'Administration f√©d√©rale responsable des b√¢timents de l\'√âtat. Terrain de jeu de Fontinoy pendant 30+ ans. Gare de Mons (37‚Üí480M‚Ç¨), ambassade de Kinshasa (bakchich Besix), d√©m√©nagement police f√©d√©rale (1M‚Ç¨ occulte). Chaque projet = une commission pour l\'interm√©diaire.',
    ref:'Sources : Rapports S√ªret√©, M√©dor, Cour des comptes',
    unlock:'act1_clan' }
};

// ‚îÄ‚îÄ QUEST SYSTEM ‚îÄ‚îÄ
const QUESTS = {
  main_circuit: { name:'Reconstituer le circuit du blanchiment', desc:'Tracez le parcours de l\'argent : de sa source myst√©rieuse aux comptes ING, puis aux bureaux de tabac.', check:()=>G.evidence.has('cash-ing')&&G.evidence.has('loterie') },
  main_clan: { name:'Identifier le Clan', desc:'Cartographiez le triangle Reynders-Fontinoy-Theunissen et le r√©seau de placement.', check:()=>G.evidence.has('surete-fonti')&&G.evidence.has('theunissen')&&G.evidence.has('brulin') },
  main_source: { name:'D\'o√π vient l\'argent ?', desc:'Trouvez l\'origine des 700-800K‚Ç¨ en cash. Kazakhgate ? Fonds libyens ? March√©s publics ?', check:()=>G.evidence.has('kazakh-loi')||G.evidence.has('enveloppe')||G.evidence.has('gare-mons') },
  side_ullens: { name:'Le lanceur d\'alerte', desc:'Retrouvez l\'agent de la S√ªret√© r√©duit au silence.', check:()=>G.evidence.has('ullens') },
  side_kpmg: { name:'Le rapport fant√¥me', desc:'Obtenez le rapport KPMG de la Loterie Nationale.', check:()=>G.evidence.has('kpmg') },
  boss: { name:'‚öîÔ∏è La Confrontation', desc:'Accumulez assez d\'indices pour affronter le syst√®me en commission parlementaire.', check:()=>G.evidence.size>=7 }
};

// ‚îÄ‚îÄ XP & LEVEL SYSTEM ‚îÄ‚îÄ
let xp = 0;
let level = 1;
const XP_PER_LEVEL = 30;
function addXP(amount, reason) {
  xp += amount;
  updateXPBar();
  if (xp >= level * XP_PER_LEVEL) {
    xp -= level * XP_PER_LEVEL;
    level++;
    levelUp();
  }
  autoSave();
}
function updateXPBar() {
  const pct = (xp / (level * XP_PER_LEVEL)) * 100;
  const bar = document.getElementById('xpFill');
  if(bar) bar.style.width = pct + '%';
}
function levelUp() {
  const el = document.getElementById('levelUp');
  document.getElementById('lvlSub').textContent = `Niveau ${level} atteint`;
  // Find lowest skill
  const lowest = Object.entries(G.skills).sort((a,b)=>a[1]-b[1])[0];
  const sk = SKILLS[lowest[0]];
  G.skills[lowest[0]]++;
  document.getElementById('lvlSkill').innerHTML = `<span style="color:${sk.color}">${sk.name}</span> +1 ‚Üí ${G.skills[lowest[0]]}`;
  el.classList.add('on');
}
function closeLevelUp() {
  document.getElementById('levelUp').classList.remove('on');
}

// ‚îÄ‚îÄ AUTOSAVE ‚îÄ‚îÄ
function autoSave() {
  const si = document.getElementById('saveIcon');
  si.classList.add('show');
  setTimeout(()=>si.classList.remove('show'), 1500);
}

// ‚îÄ‚îÄ UNLOCKED CODEX ENTRIES ‚îÄ‚îÄ
function getUnlockedCodex() {
  return Object.entries(CODEX).filter(([id,c]) => G.history.includes(c.unlock) || G.scene === c.unlock);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SCENE DATABASE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

const SCENES = {

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PROLOGUE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
prologue_1: {
  location: 'Gare du Midi ‚Äî Arriv√©e',
  chapter: 'Prologue',
  chapterTitle: 'Vous avez re√ßu une lettre',
  blocks: [
    { t:'sys', text:'‚Äî Chargement du monde... Les Parchemins de Bruxelles v1.0 ‚Äî' },
    { t:'text', text:'Le train s\'arr√™te dans un soupir de freins. <strong>Gare du Midi, Bruxelles.</strong> L\'air a cette odeur particuli√®re de diesel et de gaufres qui signale les grandes capitales belges.' },
    { t:'text', text:'Vous √™tes ici parce qu\'une lettre anonyme est arriv√©e √† votre bureau il y a dix jours. Pas un mail ‚Äî une lettre papier, timbr√©e √† l\'ancienne, manuscrite. Dedans, une seule phrase et une cl√© USB : <em>¬´ Le Vizir gratte des tickets. Tout est sur la cl√©. ¬ª</em>' },
    { t:'thought', skill:'arch', text:'Le Vizir. C\'est comme √ßa que les cercles de pouvoir belges l\'appellent. Quatre d√©cennies au sommet. Ministre des Finances, Affaires √©trang√®res, Commissaire europ√©en. Si quelqu\'un vous avait dit qu\'il blanchissait de l\'argent via des tickets √† gratter, vous auriez ri. Vous ne riez plus.' },
    { t:'text', text:'La cl√© USB contient des relev√©s bancaires partiels, des captures d\'√©cran de comptes joueurs de la Loterie Nationale, et un organigramme dessin√© √† la main. Au centre : un nom entour√© trois fois au stylo rouge.' },
    { t:'thought', skill:'flair', text:'700 √† 800 000 euros en cash. Sur un compte √† vue. Pendant dix ans. Et personne ‚Äî ni la banque, ni la CTIF, ni la S√ªret√© ‚Äî n\'a bronch√©. L\'odeur du cash rance, c\'est ici qu\'elle commence.' },
    { t:'evidence', id:'cash-ing' },
    { t:'sys', text:'üéÆ ¬´ It\'s dangerous to go alone! Take this. ¬ª ‚Äî Votre premier indice a √©t√© ajout√© au Tableau d\'indices (üìã).' }
  ],
  choices: [
    { key:'A', text:'Examiner les relev√©s bancaires en d√©tail. Suivre l\'argent ‚Äî c\'est toujours la premi√®re r√®gle.', meta:'‚Üí Piste financi√®re ¬∑ Flair +1', effects:{flair:1}, next:'act1_ing', tip:'Follow the money. Toujours.' },
    { key:'B', text:'√âtudier l\'organigramme. Qui sont les noms autour du Vizir ? Le r√©seau est la cl√©.', meta:'‚Üí Piste r√©seau ¬∑ R√©seau +1', effects:{reseau:1}, next:'act1_clan', tip:'Un homme ne blanchit pas seul. Cherchez le clan.' },
    { key:'C', text:'V√©rifier d\'abord la cl√© USB elle-m√™me. Qui l\'a envoy√©e ? Et pourquoi maintenant ?', meta:'‚Üí Piste informateur ¬∑ Archive +1 ¬∑ Prudent', effects:{arch:1}, next:'act1_source', tip:'Le messager est parfois plus important que le message.' }
  ]
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ACTE I ‚Äî PISTE ING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_ing: {
  location: 'Quartier Europ√©en ‚Äî Si√®ge ING, av. Marnix',
  chapter: 'Acte I',
  chapterTitle: 'Suivre l\'argent',
  blocks: [
    { t:'text', text:'Le si√®ge d\'ING Belgique se dresse comme une forteresse de verre dans le quartier europ√©en. Vous y avez un contact ‚Äî une ancienne de la compliance, partie en mauvais termes. Elle a accept√© de vous retrouver dans un Starbucks voisin. Discr√©tion obligatoire.' },
    { t:'thought', skill:'flair', text:'Les banques sont des forteresses pour les riches et des prisons pour les pauvres. ING a gard√© un ministre dans son coffre-fort pendant dix ans sans jamais poser de questions. √áa s\'appelle du trafic d\'influence ‚Äî ou de la complicit√©.' },
    { t:'dlg', text:'J\'ai vu les d√©p√¥ts en 2018. On m\'a demand√© de convoquer le client. Il a parl√© de ¬´ ventes d\'art ¬ª. Aucune facture. Aucun re√ßu. Mon directeur m\'a dit de classer. J\'ai class√©. On classe tous.', who:'Ancienne responsable compliance ING ‚Äî sous couvert d\'anonymat' },
    { t:'check', skill:'flair', dc:5, pass:'Vous rep√©rez une incoh√©rence : les d√©p√¥ts cash cessent exactement en 2018 ‚Äî l\'ann√©e o√π ING interroge son client. Mais l\'argent ne dispara√Æt pas. Il change de canal.', fail:'Les chiffres sont denses. Vous manquez le pattern. L\'ancienne de la compliance vous le signale elle-m√™me, avec un sourire triste.' },
    { t:'text', text:'Elle glisse vers vous une serviette en papier. Dessus, un nom : <strong>Loterie Nationale</strong>. <em>¬´ Apr√®s 2018, le cash n\'entre plus par la banque. Il entre par les bureaux de tabac. Billets √† gratter. Comptes joueurs. Demandez √† la Loterie. ¬ª</em>' },
    { t:'evidence', id:'loterie' },
    { t:'thought', skill:'arch', text:'Attendez. Attendez. Le Vizir a √©t√© ministre des Finances pendant 12 ans. Il exer√ßait la tutelle directe sur... la Loterie Nationale. Il blanchit via une institution qu\'il a lui-m√™me supervis√©e. C\'est un serpent qui se mord la queue avec un billet de 500‚Ç¨ entre les crocs.' },
    { t:'dlg', text:'Et il y a autre chose. Au conseil d\'administration d\'ING, il y a Luc Bertrand. Le ¬´ vieil ami ¬ª. Et Pierre Wunsch ‚Äî ancien chef de cabinet du client ‚Äî est gouverneur de la BNB. La BNB supervise ING. Vous voyez le probl√®me ?', who:'L\'ancienne compliance officer' },
    { t:'evidence', id:'carmeuse' }
  ],
  choices: [
    { key:'A', text:'Se rendre imm√©diatement au si√®ge de la Loterie Nationale pour v√©rifier le signalement.', meta:'‚Üí Le circuit du blanchiment ¬∑ Flair +1', effects:{flair:1}, next:'act1_loterie' },
    { key:'B', text:'Fouiller les archives du conseil d\'administration d\'ING. Si Bertrand et Wunsch prot√©geaient le client, c\'est une piste judiciaire.', meta:'‚Üí Le r√©seau de protection ¬∑ R√©seau +1', effects:{reseau:1}, next:'act1_protection', req:{reseau:4}, reqFail:'Votre r√©seau n\'est pas assez d√©velopp√© pour acc√©der aux PV du conseil. Vous devez d\'abord √©largir vos contacts.' },
    { key:'C', text:'Prendre du recul. Analyser la chronologie : pourquoi ING a-t-elle attendu 2023 pour signaler √† la CTIF ?', meta:'‚Üí La chronologie suspecte ¬∑ Proc√©dure +1', effects:{proc:1}, next:'act1_chrono' }
  ]
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LOTERIE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_loterie: {
  location: 'Si√®ge Loterie Nationale ‚Äî Boulevard Anspach',
  chapter: 'Acte I',
  chapterTitle: 'Le blanchiment par le grattage',
  blocks: [
    { t:'text', text:'Le directeur de la compliance de la Loterie vous re√ßoit dans un bureau aseptis√©. Il est nerveux. Vous aussi.' },
    { t:'thought', skill:'sang', text:'Calme. La Loterie a elle-m√™me signal√© au parquet en mars 2022. Ils ne sont pas l\'ennemi ici. Ils ont fait ce qu\'ING n\'a pas fait pendant dix ans.' },
    { t:'dlg', text:'En 2021, nos algorithmes ont d√©tect√© un profil anormal. Deux comptes joueurs ‚Äî le sien et celui de son √©pouse ‚Äî atteignant quasi syst√©matiquement la limite l√©gale de 500 euros par semaine. Chaque semaine. Pendant des ann√©es. C\'est le seul profil en Belgique avec ce pattern.', who:'Direction Compliance, Loterie Nationale' },
    { t:'check', skill:'flair', dc:4, pass:'Vous faites le calcul instantan√©ment : 500‚Ç¨ √ó 2 comptes √ó 52 semaines = ~52 000‚Ç¨/an. Sur 5 ans : ~260 000‚Ç¨ mis√©s. Avec un taux de retour de 60%, environ 100 000‚Ç¨ ¬´ perdus ¬ª ‚Äî le co√ªt du blanchiment.', fail:'Les chiffres vous √©chappent un instant, mais le directeur vous les r√©sume patiemment.' },
    { t:'evidence', id:'kpmg' },
    { t:'text', text:'Le directeur ajoute un d√©tail qui vous glace : <em>¬´ Le comportement est inconsistant avec les joueurs compulsifs typiques. Un addict rejoue ses gains. Ici, c\'est du cash frais √† chaque fois. Ce n\'est pas du jeu ‚Äî c\'est une op√©ration. ¬ª</em>' },
    { t:'thought', skill:'rhet', text:'Rh√©torique se r√©veille. La d√©fense dira ¬´ addiction au jeu ¬ª. C\'est l\'argument √©vident. Mais la Loterie vient de le d√©sarmer avant m√™me qu\'il soit formul√©. Du cash frais √† chaque fois ‚Äî ce n\'est pas de la d√©pendance, c\'est de la m√©thodologie.' },
    { t:'evidence', id:'prignon' },
    { t:'thought', skill:'proc', text:'Et l\'√©pouse. Bernadette Prignon. Pr√©sidente de chambre √† la Cour d\'appel de Li√®ge. Une magistrate. Qui blanchit de l\'argent via un second compte joueur. L\'institution judiciaire est compromise de l\'int√©rieur. C\'est le paradoxe parfait.' },
    { t:'sys', text:'üèÜ ACHIEVEMENT UNLOCKED : ¬´ Follow The Money ¬ª ‚Äî Vous avez reconstitu√© le circuit complet du blanchiment.' }
  ],
  choices: [
    { key:'A', text:'D\'o√π vient le cash ? La Loterie blanchit, mais l\'origine est la vraie question. Remonter aux sources.', meta:'‚Üí Les sources du cash ¬∑ Archive +1', effects:{arch:1}, next:'act1_sources' },
    { key:'B', text:'Enqu√™ter sur l\'√©pouse. Une magistrate complice, c\'est une piste d√©vastatrice.', meta:'‚Üí Le clan familial ¬∑ Proc√©dure +1', effects:{proc:1}, next:'act1_prignon' }
  ],
  onEnter: () => { achieve('follow_money','Follow the Money','Circuit ING‚ÜíLoterie reconstitu√©.'); }
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ACTE I ‚Äî PISTE CLAN ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_clan: {
  location: 'Caf√© du Sablon ‚Äî Bruxelles',
  chapter: 'Acte I',
  chapterTitle: 'Le Clan',
  blocks: [
    { t:'text', text:'L\'organigramme de la cl√© USB est rudimentaire mais √©loquent. Au centre : le Vizir. √Ä sa droite imm√©diate : un nom soulign√© trois fois ‚Äî <strong>Jean-Claude Fontinoy</strong>. Autour d\'eux, comme les branches d\'un arbre v√©n√©neux, des noms dans des bulles connect√©es par des lignes : SNCB, R√©gie des B√¢timents, Beliris, SFPI, BNB, S√ªret√© de l\'√âtat...' },
    { t:'thought', skill:'reseau', text:'Fontinoy. N√© en 1945. Ing√©nieur SNCB depuis 1967. Rencontre le Vizir en 1986 quand ce dernier prend la pr√©sidence de la SNCB √† 29 ans. Quarante ans de symbiose. Si le Vizir est le cerveau, Fontinoy est les mains. Les mains dans le cambouis. Les mains dans le cash.' },
    { t:'text', text:'Vous √™tes au Sablon, √† cinquante m√®tres de la galerie d\'antiquit√©s d\'<strong>Olivier Theunissen</strong>, rue de la R√©gence. Un ancien chauffeur de Fontinoy, retrouv√© par un journaliste, a d√©clar√© que le vieil ing√©nieur s\'y rendait <em>¬´ quasiment quotidiennement ¬ª</em>.' },
    { t:'evidence', id:'theunissen' },
    { t:'check', skill:'reseau', dc:4, pass:'Vous connectez les points : Reynders justifie son cash par des ¬´ ventes d\'art ¬ª. Fontinoy fr√©quente une galerie d\'antiquit√©s. Theunissen vend des antiquit√©s. Le triangle est √©vident : fausses factures, ventes fictives, blanchiment artistique. C\'est le m√™me sch√©ma que l\'affaire Gu√©ant en France.', fail:'Les connexions restent floues. Vous notez les noms mais le sch√©ma complet vous √©chappe pour l\'instant.' },
    { t:'dlg', text:'Fonti, c\'est la machine √† cash. Il est partout depuis 40 ans. Les gares, les ambassades, la R√©gie des b√¢timents. Quand Besix a refus√© de payer 50 000 pour Kinshasa, c\'est lui qui a dit non au contrat. Lui. Pas le ministre. Lui.', who:'Source polici√®re, rencontre au Parc Royal' },
    { t:'evidence', id:'surete-fonti' },
    { t:'evidence', id:'bakchich' },
    { t:'thought', skill:'arch', text:'Un rapport de la S√ªret√© de 2010 ‚Äî deux mots vous hantent : ¬´ un paiement occulte d\'un million d\'euros ¬ª. C\'est ce que Fontinoy aurait exig√© pour le d√©m√©nagement de la police f√©d√©rale. Un. Million. Pour un d√©m√©nagement. La banalit√© du mal a un prix, et il est √† sept chiffres.' },
    { t:'evidence', id:'million' },
    { t:'sys', text:'üèÜ ACHIEVEMENT : ¬´ Le Bestiaire ¬ª ‚Äî Vous avez identifi√© le Triangle : Reynders, Fontinoy, Theunissen.' }
  ],
  choices: [
    { key:'A', text:'Chercher les preuves mat√©rielles. Si Fontinoy est la ¬´ machine √† cash ¬ª, l\'argent du Vizir vient de lui.', meta:'‚Üí Les sources du cash ¬∑ Flair +1', effects:{flair:1}, next:'act1_sources' },
    { key:'B', text:'Investiguer le r√©seau de placement : les anciens chefs de cabinet aux postes strat√©giques.', meta:'‚Üí Le r√©seau de protection ¬∑ R√©seau +1', effects:{reseau:1}, next:'act1_protection' },
    { key:'C', text:'Confronter directement un proche de Fontinoy. Risqu√©, mais les t√©moins sont la cl√©.', meta:'[Sang-Froid ‚â• 5 requis] ‚Üí Confrontation directe', effects:{sang:1}, next:'act1_confrontation', req:{sang:5}, reqFail:'Votre Sang-Froid n\'est pas assez √©lev√© pour ce genre de confrontation. Pas encore.' }
  ],
  onEnter: () => { achieve('bestiaire','Le Bestiaire','Triangle Reynders-Fontinoy-Theunissen identifi√©.'); }
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ACTE I ‚Äî SOURCE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_source: {
  location: 'Votre appartement temporaire ‚Äî Saint-Gilles',
  chapter: 'Acte I',
  chapterTitle: 'Le messager',
  blocks: [
    { t:'text', text:'Vous examinez l\'enveloppe √† la lumi√®re. Papier standard A4, timbre belge, cachet de la poste d\'<strong>Uccle</strong>. Uccle ‚Äî le quartier hupp√© du sud de Bruxelles o√π vit le Vizir. Co√Øncidence ?' },
    { t:'thought', skill:'proc', text:'L\'envoi depuis Uccle est soit un acte de provocation calcul√©e, soit une b√™tise d\'amateur. Si c\'est un insider du syst√®me qui vous envoie √ßa, il conna√Æt les protocoles. Il sait qu\'on remonte les lettres. Il veut que vous le trouviez.' },
    { t:'check', skill:'arch', dc:5, pass:'Vous reconnaissez le style de l\'organigramme. Vous avez d√©j√† vu ce type de sch√©ma ‚Äî dans les annexes d\'un article de M√©dor de 2021, sign√© Philippe Engels. Cofondateur du magazine d\'investigation. Auteur du livre ¬´ Le Clan Reynders ¬ª. Si quelqu\'un poss√®de ces documents, c\'est lui ou quelqu\'un de son entourage.', fail:'Le style de l\'organigramme ne vous dit rien. Vous notez les d√©tails pour v√©rification ult√©rieure.' },
    { t:'text', text:'La cl√© USB contient aussi un fichier PDF ‚Äî un rapport d\'audit partiel de <strong>KPMG</strong>, command√© par la Loterie Nationale en 2022. Le rapport conclut √† un ¬´ risque √©lev√© de blanchiment ¬ª li√© √† un client dont l\'identit√© est d√©crite comme ¬´ politiquement sensible ¬ª.' },
    { t:'evidence', id:'kpmg' },
    { t:'thought', skill:'flair', text:'Le rapport KPMG date de 2022. Le signalement au parquet aussi. Mais l\'inculpation n\'arrive qu\'en octobre 2025. Trois ans. Pourquoi ? L\'immunit√© du Commissaire europ√©en ? Ou autre chose ? Quelqu\'un a prot√©g√© la cible pendant trois ans.' },
    { t:'codec', name:'??? (Num√©ro masqu√©)', icon:'üì±', text:'Vous avez re√ßu mon colis. Bien. Maintenant √©coutez : ne cherchez pas qui je suis. Cherchez d\'o√π vient l\'argent. La Loterie, c\'est la sortie du tuyau. L\'entr√©e, c\'est Fontinoy. C\'est toujours Fontinoy. Il est la machine √† cash depuis quarante ans. Trouvez comment la machine fonctionne.' },
    { t:'sys', text:'üìû ¬´ Colonel, can you hear me? ¬ª ‚Äî Communication CODEC termin√©e. L\'informateur a raccroch√©.' }
  ],
  choices: [
    { key:'A', text:'Suivre le conseil de l\'informateur : enqu√™ter sur Fontinoy et la ¬´ machine √† cash ¬ª.', meta:'‚Üí Le Clan ¬∑ Archive +1', effects:{arch:1}, next:'act1_clan' },
    { key:'B', text:'Ignorer l\'informateur et suivre votre propre piste : les relev√©s bancaires ING.', meta:'‚Üí Piste financi√®re ¬∑ Flair +1', effects:{flair:1}, next:'act1_ing' },
    { key:'C', text:'Chercher Philippe Engels. S\'il est la source, autant travailler ensemble.', meta:'‚Üí Alliance journaliste ¬∑ R√©seau +1', effects:{reseau:1}, next:'act1_engels' }
  ]
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PROTECTION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_protection: {
  location: 'Archives parlementaires ‚Äî Chambre des Repr√©sentants',
  chapter: 'Acte I',
  chapterTitle: 'Le r√©seau de placement',
  blocks: [
    { t:'text', text:'Les documents publics de la Chambre sont un labyrinthe de proc√®s-verbaux et de questions parlementaires. Mais quand vous commencez √† cartographier les <strong>anciens chefs de cabinet de Reynders</strong>, le sch√©ma explose.' },
    { t:'thought', skill:'reseau', text:'Ce n\'est pas un r√©seau d\'influence. C\'est une occupation militaire du sommet de l\'√âtat. Chaque poste strat√©gique, un loyaliste. Chaque institution de contr√¥le, un gardien du temple.' },
    { t:'text', text:'<strong>Peter Praet</strong> ‚Üí directoire de la BCE. <strong>Pierre Wunsch</strong> ‚Üí gouverneur de la BNB (qui supervise les banques). <strong>Koen Van Loo</strong> ‚Üí directeur de la SFPI (bras financier de l\'√âtat). <strong>Olivier H√©nin</strong> ‚Üí SNCB + FSMA (autorit√© des march√©s). <strong>Alexia Bertrand</strong> ‚Üí cheffe de cabinet, fille du pr√©sident d\'Ackermans & van Haaren.' },
    { t:'evidence', id:'brulin' },
    { t:'thought', skill:'arch', text:'Et le pire : <strong>Hugues Brulin</strong>, ancien cabinet Reynders, nomm√© num√©ro 3 de la S√ªret√© de l\'√âtat en ao√ªt 2015. Le moment exact o√π le Kazakhgate devient br√ªlant. Le moment exact o√π un agent nomm√© Ullens, qui enqu√™tait sur Fontinoy, est mis √† l\'√©cart. Brulin contr√¥lait les dossiers de l\'int√©rieur.' },
    { t:'text', text:'<strong>Frank Jaumin</strong>, autre ancien du cabinet, prend le contre-espionnage. La S√ªret√© de l\'√âtat ‚Äî l\'organe cens√© surveiller les r√©seaux de corruption ‚Äî √©tait contr√¥l√©e par les gens qu\'elle aurait d√ª surveiller.' },
    { t:'check', skill:'reseau', dc:6, pass:'Vous r√©alisez l\'ampleur syst√©mique : Wunsch √† la BNB supervise ING qui couvre Reynders. Brulin √† la S√ªret√© neutralise les enqu√™teurs internes. Van Loo √† la SFPI contr√¥le les participations de l\'√âtat dans Fortis/BNP. C\'est un filet de s√©curit√© √† 360 degr√©s.', fail:'Le r√©seau est immense. Vous captez les liens directs mais les connexions de second degr√© vous √©chappent encore.' },
    { t:'sys', text:'üèÜ ACHIEVEMENT : ¬´ The Lore Master ¬ª ‚Äî Vous avez cartographi√© le r√©seau de placement.' }
  ],
  choices: [
    { key:'A', text:'Chercher Nicolas Ullens, l\'agent de la S√ªret√© r√©duit au silence. S\'il parle, tout s\'effondre.', meta:'[Sang-Froid ‚â• 4] ‚Üí Le lanceur d\'alerte', effects:{sang:1}, next:'act1_ullens', req:{sang:4}, reqFail:'Approcher un ex-agent de la S√ªret√© demande des nerfs d\'acier. Vous n\'√™tes pas encore pr√™t.' },
    { key:'B', text:'Utiliser les archives parlementaires pour retracer les questions sans r√©ponse sur Reynders.', meta:'‚Üí Le dossier parlementaire ¬∑ Proc√©dure +1', effects:{proc:1}, next:'act1_parlement' }
  ],
  onEnter: () => { achieve('loremaster','The Lore Master','R√©seau de placement cartographi√©.'); }
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ULLENS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_ullens: {
  location: 'Parc du Cinquantenaire ‚Äî Banc isol√©',
  chapter: 'Acte I',
  chapterTitle: 'Le lanceur d\'alerte',
  blocks: [
    { t:'text', text:'Rendez-vous convenu par messagerie chiffr√©e. Nicolas Ullens, ancien inspecteur de la S√ªret√© de l\'√âtat (2007-2018), arrive avec dix minutes de retard. Il v√©rifie trois fois derri√®re lui avant de s\'asseoir.' },
    { t:'thought', skill:'sang', text:'Il a peur. Apr√®s tout ce temps, il a encore peur. Menaces de mort, harc√®lement moral, mise √† l\'√©cart. Et le pire : le classement sans suite de septembre 2019. Tout ce qu\'il savait, balay√© en une phrase : ¬´ faute du moindre d√©lit ¬ª.' },
    { t:'dlg', text:'J\'ai tout donn√© √† la police judiciaire en avril 2019. Kinshasa, le Kazakhgate, les fonds libyens, les gares, Fontinoy. Des ann√©es de travail. Cinq mois plus tard, class√© sans suite. Une semaine avant l\'audition de Reynders pour le poste de commissaire. Une. Semaine. Vous croyez aux co√Øncidences ?', who:'Nicolas Ullens, ex-inspecteur S√ªret√© de l\'√âtat' },
    { t:'evidence', id:'ullens' },
    { t:'check', skill:'sang', dc:5, pass:'Vous maintenez son regard sans ciller. Il voit que vous ne flancherez pas. Il sort un carnet de sa poche.', fail:'Votre malaise est visible. Ullens h√©site. Puis il continue quand m√™me ‚Äî il a trop besoin que quelqu\'un l\'√©coute.' },
    { t:'dlg', text:'Mon avocat, Deswaef, l\'a dit publiquement : ¬´ Des devoirs d\'enqu√™te simples et √©l√©mentaires n\'ont pas √©t√© effectu√©s. Une enqu√™te patrimoniale classique. Ou m√™me simplement interroger les grandes banques. ¬ª Et vous savez quoi ? C\'est exactement ces v√©rifications qui ont fini par le coincer. ING, la Loterie. Ce que j\'avais demand√© en 2019. Six ans trop tard.', who:'Ullens' },
    { t:'thought', skill:'proc', text:'Le timing du classement est d√©vastateur. 25 septembre 2019 : class√© sans suite. 2 octobre 2019 : audition de Reynders au Parlement europ√©en. Si le dossier avait √©t√© ouvert, la candidature de commissaire √©tait morte. Quelqu\'un a prot√©g√© le processus de nomination.' },
    { t:'text', text:'Ullens vous regarde longuement. <em>¬´ Je ne peux pas t√©moigner en public ‚Äî j\'ai une enqu√™te pour violation du secret professionnel sur le dos. Mais je peux vous dire une chose : pour savoir d\'o√π vient l\'argent de Reynders, il faut enqu√™ter sur le tandem. Reynders-Fontinoy. C\'est un bin√¥me. Depuis 1986. Et la machine n\'a jamais cess√© de tourner. ¬ª</em>' },
    { t:'sys', text:'üìû CODEC incoming...' },
    { t:'codec', name:'Nicolas Ullens', icon:'üîç', text:'Trois pistes pour la source du cash. Premi√®rement : le Kazakhgate. Des millions en billets de 500 ont circul√©. Deuxi√®mement : les fonds libyens ‚Äî des r√©tro-commissions sur 10 milliards. Troisi√®mement : les march√©s publics ‚Äî gares, ambassade, R√©gie des b√¢timents. Fontinoy prenait des commissions sur chaque projet. C\'est lui qui alimentait la machine.' }
  ],
  choices: [
    { key:'A', text:'Suivre la piste du Kazakhgate. Si des billets de 500‚Ç¨ ont circul√©, la connexion avec ceux retrouv√©s chez Reynders est directe.', meta:'‚Üí Le Kazakhgate ¬∑ Archive +1', effects:{arch:1}, next:'act1_kazakh' },
    { key:'B', text:'Creuser les march√©s publics et Fontinoy. La ¬´ machine √† cash ¬ª quotidienne est plus tra√ßable qu\'un deal g√©opolitique.', meta:'‚Üí La machine Fontinoy ¬∑ Flair +1', effects:{flair:1}, next:'act1_fontinoy_deep' },
    { key:'C', text:'Aller directement √† la confrontation. Vous avez assez d\'indices pour secouer quelqu\'un.', meta:'[7 indices minimum] ‚Üí ‚öîÔ∏è BOSS FIGHT', effects:{}, next:'boss_1', req:{evidence:7}, reqFail:'Vous n\'avez pas assez d\'indices pour une confrontation. Continuez l\'enqu√™te.' }
  ]
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ SOURCES DU CASH ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_sources: {
  location: 'Bureau improvis√© ‚Äî Archives de M√©dor',
  chapter: 'Acte I',
  chapterTitle: 'D\'o√π vient l\'argent ?',
  blocks: [
    { t:'text', text:'La question centrale. Celle qui obs√®de les enqu√™teurs, les journalistes, et maintenant vous. <strong>D\'o√π vient le million d\'euros en cash ?</strong> Reynders dit ¬´ ventes d\'art ¬ª. Aucune trace. Alors quoi ?' },
    { t:'thought', skill:'flair', text:'Trois hypoth√®ses convergent. Trois art√®res qui alimentent la m√™me rivi√®re de cash noir. Comme trois donjons dans un m√™me monde ouvert ‚Äî il faut les explorer tous pour comprendre le boss final.' },
    { t:'text', text:'<strong>Hypoth√®se 1 : Le Kazakhgate.</strong> En d√©cembre 2011, le milliardaire Patokh Chodiev remet √† son avocate Catherine Degoul <strong>5 millions d\'euros en billets de 500</strong> √† l\'h√¥tel Hyatt de Zurich. Au total, 13,3 millions d\'honoraires et commissions document√©s, dont 4 millions ¬´ introuvables ¬ª circulant en cash. Des billets de 500‚Ç¨ ‚Äî les m√™mes retrouv√©s chez Reynders en d√©cembre 2024.' },
    { t:'evidence', id:'kazakh-loi' },
    { t:'text', text:'<strong>Hypoth√®se 2 : Les fonds libyens.</strong> 16,1 milliards gel√©s chez Euroclear. 10 milliards ¬´ √©vapor√©s ¬ª. Fontinoy accus√© d\'avoir touch√© une enveloppe de 50 000‚Ç¨ dans le cadre de ces fonds.' },
    { t:'evidence', id:'enveloppe' },
    { t:'text', text:'<strong>Hypoth√®se 3 : Les march√©s publics.</strong> Gare de Mons (37‚Üí480M‚Ç¨), ambassade de Kinshasa, d√©m√©nagement de la police f√©d√©rale. Fontinoy comme interm√©diaire syst√©matique, pr√©levant des commissions sur chaque projet.' },
    { t:'evidence', id:'gare-mons' },
    { t:'thought', skill:'arch', text:'Le fil rouge, c\'est Fontinoy. Toujours. Partout. Comme un boss r√©current dans une saga ‚Äî il appara√Æt dans chaque chapitre, sous une forme diff√©rente, mais c\'est toujours lui. La ¬´ machine √† cash ¬ª qui alimentait le Vizir depuis 1986.' }
  ],
  choices: [
    { key:'A', text:'Assez d\'indices. Il est temps de passer √† la confrontation.', meta:'[6+ indices requis] ‚Üí ‚öîÔ∏è BOSS FIGHT : Commission parlementaire', effects:{rhet:1}, next:'boss_1', req:{evidence:6}, reqFail:'Vous n\'avez pas assez d\'indices. Continuez d\'enqu√™ter.' },
    { key:'B', text:'Approfondir encore le Kazakhgate. C\'est la piste g√©opolitique la plus explosive.', meta:'‚Üí Le Kazakhgate ¬∑ Rh√©torique +1', effects:{rhet:1}, next:'act1_kazakh' }
  ]
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ KAZAKHGATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_kazakh: {
  location: 'Archives de la commission d\'enqu√™te parlementaire (2017-2018)',
  chapter: 'Acte I',
  chapterTitle: 'Kazakhgate',
  blocks: [
    { t:'text', text:'Le Kazakhgate. L\'affaire d\'√âtat qui aurait d√ª faire tomber le Vizir il y a dix ans. Celle qui implique l\'√âlys√©e, des oligarques, des milliards en contrats d\'armement, et une loi vot√©e en une journ√©e pour √©teindre des poursuites p√©nales.' },
    { t:'text', text:'<strong>27 janvier 2011.</strong> Le gouvernement Leterme II, en affaires courantes, conclut un accord. Le <strong>31 janvier</strong>, le cabinet Reynders met un texte sur la table : la loi sur la transaction p√©nale √©largie. <strong>3 mars</strong> : d√©pos√© en commission des Finances ‚Äî pas en commission Justice. Vot√© le m√™me jour. C\'est une blitzkrieg l√©gislative.' },
    { t:'thought', skill:'proc', text:'Proc√©dure hurle dans votre t√™te : commission des Finances au lieu de la Justice. Un texte p√©nal pass√© par la porte de la fiscalit√©. C\'est une man≈ìuvre de contournement parlementaire ‚Äî le genre de tour qu\'on ne remarque que si on conna√Æt l\'architecture institutionnelle belge par c≈ìur.' },
    { t:'check', skill:'proc', dc:5, pass:'Vous identifiez le m√©canisme exact : en passant par les Finances plut√¥t que la Justice, le texte √©vitait l\'examen par les p√©nalistes de la Chambre ‚Äî ceux qui auraient imm√©diatement vu que la loi √©tait taill√©e sur mesure.', fail:'Le d√©tail proc√©dural vous √©chappe, mais la chronologie parle d\'elle-m√™me : une loi p√©nale en un mois, c\'est du jamais-vu.' },
    { t:'evidence', id:'kazakh-chodiev' },
    { t:'text', text:'<strong>17 juin 2011</strong> : transaction p√©nale conclue ‚Äî 3,5 millions (contre 23 annonc√©s). <strong>27 juin</strong> : contrat de 45 h√©licopt√®res sign√© au Salon du Bourget. <strong>10 jours d\'√©cart.</strong> L\'oligarque paye, la loi √©teint les poursuites, la France vend ses h√©licopt√®res, tout le monde est content. Sauf les 48 chefs d\'inculpation qui disparaissent.' },
    { t:'thought', skill:'rhet', text:'La commission d\'enqu√™te a travaill√© 16 mois. 177 t√©moins. ~500 pages de rapport. Conclusion unanime : immixtion ¬´ inacceptable ¬ª des autorit√©s fran√ßaises. Mais aucun grief retenu contre Reynders. Vote de la majorit√© MR-N-VA-CD&V-Open VLD. L\'opposition dit ¬´ conclusions rabot√©es ¬ª. Van der Maelen : ¬´ Des indices mais pas de preuves. ¬ª L\'art de l\'esquive port√© au rang de discipline olympique.' },
    { t:'sys', text:'üèÜ ACHIEVEMENT : ¬´ Deep Lore Unlocked ¬ª ‚Äî Le Kazakhgate n\'a plus de secrets pour vous.' }
  ],
  choices: [
    { key:'A', text:'Vous avez assez d\'indices. Direction la confrontation.', meta:'[7+ indices] ‚Üí ‚öîÔ∏è BOSS FIGHT', effects:{rhet:1}, next:'boss_1', req:{evidence:7}, reqFail:'Il vous faut encore des preuves pour √™tre cr√©dible en confrontation.' },
    { key:'B', text:'Retourner voir Ullens. Avec le Kazakhgate en poche, il a peut-√™tre d\'autres connexions √† r√©v√©ler.', meta:'‚Üí Ullens (si pas encore vu)', effects:{arch:1}, next:'act1_ullens' }
  ],
  onEnter: () => { achieve('deeplore','Deep Lore Unlocked','Kazakhgate ma√Ætris√©.'); }
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ BOSS FIGHT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
boss_1: {
  location: '‚öîÔ∏è Commission des Finances ‚Äî Chambre des Repr√©sentants',
  chapter: 'Acte I ‚Äî BOSS',
  chapterTitle: 'OBJECTION !',
  isBoss: true,
  bossName: 'L\'Impunit√© du Syst√®me',
  bossHP: 100,
  blocks: [
    { t:'sys', text:'‚öîÔ∏è CONFRONTATION ‚Äî Les faits contre le syst√®me. Pr√©sentez vos indices.' },
    { t:'text', text:'La commission des Finances est en session. Le d√©put√© de la majorit√© qui d√©fend le statu quo prend la parole. C\'est votre adversaire ‚Äî pas une personne, mais l\'<strong>architecture de l\'impunit√©</strong> elle-m√™me. Chaque argument qu\'il avance, vous devez le contrer avec un indice.' },
    { t:'thought', skill:'rhet', text:'Respire. C\'est comme un boss fight. Il a ses patterns d\'attaque ‚Äî les ¬´ c\'est une chasse aux sorci√®res ¬ª, les ¬´ laissons la justice faire son travail ¬ª, les ¬´ on ne commente pas une instruction en cours ¬ª. √Ä chaque pattern, vous avez une fen√™tre d\'attaque. Utilisez vos indices.' },
  ],
  bossPhases: [
    {
      text: '¬´ Les d√©p√¥ts en esp√®ces ne prouvent rien. De nombreux citoyens utilisent du cash pour des raisons parfaitement l√©gales. C\'est une vendetta politique. ¬ª',
      who: 'D√©put√© de la majorit√©',
      correctEvidence: ['cash-ing','billets-500','ctif'],
      wrongResponse: 'Votre argument manque de punch. Le d√©put√© sourit. L\'assistance murmure.',
      rightResponse: '¬´ OBJECTION ! ¬ª ‚Äî Vous pr√©sentez les relev√©s ING : 700-800 000‚Ç¨ en cash sur dix ans. Des billets de 500‚Ç¨ retir√©s de circulation. Et ING elle-m√™me, apr√®s dix ans de silence, a fini par signaler. Ce n\'est pas du cash ¬´ l√©gal ¬ª. C\'est un pattern de blanchiment caract√©ris√©.',
      damage: 35
    },
    {
      text: '¬´ La Loterie Nationale ? Beaucoup de Belges jouent au loto. Vous criminalisez un loisir. C\'est grotesque. ¬ª',
      who: 'D√©put√© de la majorit√©',
      correctEvidence: ['loterie','kpmg','prignon'],
      wrongResponse: 'L\'argument ¬´ loterie = loisir ¬ª tient la route aupr√®s du public. Vous perdez du terrain.',
      rightResponse: '¬´ OBJECTION ! ¬ª ‚Äî Le rapport KPMG conclut au risque de blanchiment. Profil unique en Belgique : deux comptes saturant la limite l√©gale chaque semaine. Et l\'√©pouse ‚Äî magistrate ! ‚Äî utilise un second compte. La Loterie elle-m√™me dit que ce comportement est ¬´ inconsistant avec un joueur compulsif ¬ª.',
      damage: 35
    },
    {
      text: '¬´ La commission d\'enqu√™te sur le Kazakhgate a blanchi Reynders. La justice a class√© Ullens. Vous recyclez des accusations d√©j√† r√©fut√©es. ¬ª',
      who: 'D√©put√© de la majorit√©',
      correctEvidence: ['ullens','kazakh-loi','brulin','kazakh-chodiev'],
      wrongResponse: 'Sans preuve concr√®te de la connexion, le d√©put√© marque un point.',
      rightResponse: '¬´ OBJECTION ! ¬ª ‚Äî Le classement Ullens est intervenu une semaine avant l\'audition de Reynders au Parlement europ√©en. Brulin, ancien cabinet Reynders, contr√¥lait la S√ªret√© au moment de la neutralisation d\'Ullens. Et la loi du Kazakhgate a √©t√© vot√©e en un jour en commission des Finances ‚Äî pas de la Justice. Le syst√®me s\'est prot√©g√© lui-m√™me.',
      damage: 40
    }
  ],
  victory: {
    text: 'Le d√©put√© n\'a plus d\'arguments. Le silence tombe sur la commission. Puis, lentement, un applaudissement isol√©. Puis deux. La proposition de commission d\'enqu√™te est mise aux voix.',
    next: 'ending_1'
  },
  defeat: {
    text: 'Le syst√®me a tenu. Vos preuves n\'√©taient pas assez solides, vos arguments pas assez tranchants. La commission passe au point suivant de l\'ordre du jour. Vous avez perdu cette bataille ‚Äî pas la guerre.',
    next: 'ending_2'
  }
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ENDINGS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
ending_1: {
  type:'ending',
  title: 'Le Syst√®me Tremble',
  text: 'La commission d\'enqu√™te est vot√©e. Pour la premi√®re fois en 25 ans, le syst√®me Reynders fait l\'objet d\'un examen parlementaire officiel. Pas seulement le blanchiment ‚Äî tout. Le Kazakhgate, les fonds libyens, les march√©s publics, le r√©seau de placement. Le vizir est nu.\n\nCe n\'est pas la fin. C\'est le d√©but de la fin de l\'impunit√©.',
  badge: 'VICTOIRE ‚Äî ACTE I COMPL√âT√â'
},
ending_2: {
  type:'ending',
  title: 'Le Combat Continue',
  text: 'Le syst√®me a r√©sist√©. Mais l\'instruction judiciaire continue. Le juge Leroux poursuit son travail. Fontinoy et Theunissen sont inculp√©s. ING fait face √† une information judiciaire. Les faits sont t√™tus ‚Äî plus t√™tus que les majorit√©s parlementaires.\n\nVous n\'avez pas gagn√© aujourd\'hui. Mais vous avez pos√© les fondations. La prochaine fois, le mur tombera.',
  badge: 'L\'ENQU√äTE CONTINUE ‚Äî ACTE I COMPL√âT√â'
},

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ADDITIONAL SCENES (stubs for other paths) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
act1_prignon: { location:'Palais de Justice ‚Äî Li√®ge', chapter:'Acte I', chapterTitle:'La magistrate',
  blocks:[
    {t:'text',text:'Bernadette Prignon, √©pouse de Reynders, pr√©side une chambre √† la Cour d\'appel de Li√®ge. Sa s≈ìur, Dani√®le Reynders, fut procureure du Roi de la m√™me juridiction. L\'institution judiciaire li√©geoise est un fief familial.'},
    {t:'thought',skill:'proc',text:'Une magistrate qui participe √† un circuit de blanchiment via des comptes joueurs. C\'est la n√©gation de tout ce que l\'institution judiciaire repr√©sente. Et personne ne l\'a d√©tect√© ‚Äî parce que personne ne surveille les surveillants.'},
    {t:'evidence',id:'prignon'},
    {t:'text',text:'√Ä Li√®ge, les murs ont des oreilles. Votre visite ne passe pas inaper√ßue. Un SMS arrive : <em>¬´ Vous posez des questions sur la mauvaise personne au mauvais endroit. ¬ª</em>'},
    {t:'thought',skill:'sang',text:'Intimidation classique. Le genre de message qu\'on envoie quand on veut que vous partiez. Le genre de message qui confirme que vous √™tes au bon endroit.'}
  ],
  choices:[
    {key:'A',text:'Ignorer la menace et continuer. Chercher les sources du cash.',meta:'‚Üí Sources ¬∑ Sang-Froid +1',effects:{sang:1},next:'act1_sources'},
    {key:'B',text:'Changer de piste. Trop expos√© ici. Retour √† Bruxelles.',meta:'‚Üí R√©seau de protection ¬∑ Prudent',effects:{proc:1},next:'act1_protection'}
  ]
},
act1_chrono: { location:'Votre bureau ‚Äî Analyse chronologique', chapter:'Acte I', chapterTitle:'La chronologie suspecte',
  blocks:[
    {t:'text',text:'Vous √©talez la chronologie sur votre bureau. Mars 2022 : la Loterie signale. Ao√ªt 2023 : le parquet demande des infos ‚Äî 17 mois plus tard. Fin 2023 : ING signale √† la CTIF. 30 novembre 2024 : fin du mandat. 3 d√©cembre : perquisitions. Le timing est chirurgical.'},
    {t:'evidence',id:'ctif'},
    {t:'thought',skill:'proc',text:'17 mois entre le signalement de la Loterie et la premi√®re demande du parquet. C\'est le temps de l\'immunit√©. Les enqu√™teurs ne pouvaient pas agir tant que le Commissaire europ√©en √©tait en fonction sans alerter le Coll√®ge des commissaires. Ils ont attendu. Patiemment. Strat√©giquement.'},
    {t:'text',text:'Et ING ? 2008-2018 : aucune d√©claration. 2018 : interroge le client, classe. 2023 : signale enfin. Cinq ans entre l\'interrogatoire et le signalement. La professeure Colaert de la KU Leuven appelle √ßa une violation ¬´ flagrante ¬ª de la loi anti-blanchiment.'}
  ],
  choices:[
    {key:'A',text:'La complicit√© d\'ING est un scandale en soi. Creuser le volet bancaire.',meta:'‚Üí ING ¬∑ Proc√©dure +1',effects:{proc:1},next:'act1_ing'},
    {key:'B',text:'L\'attente du parquet montre que le dossier est solide. Chercher ce que le juge a trouv√© d\'autre.',meta:'‚Üí Les sources ¬∑ Flair +1',effects:{flair:1},next:'act1_sources'}
  ]
},
act1_parlement: { location:'Chambre des Repr√©sentants', chapter:'Acte I', chapterTitle:'Le dossier parlementaire',
  blocks:[
    {t:'text',text:'Les questions parlementaires de Marco Van Hees (PTB) sur Reynders remplissent des classeurs entiers. Vingt ans de travail document√©. Int√©r√™ts notionnels, centres de coordination, conflits d\'int√©r√™ts avec Carmeuse.'},
    {t:'evidence',id:'notionnels'},
    {t:'thought',skill:'rhet',text:'La ¬´ corruption id√©ologique ¬ª : un concept d√©velopp√© pour d√©crire Reynders. Pas l\'enrichissement personnel direct ‚Äî mais l\'assimilation totale de l\'int√©r√™t g√©n√©ral aux int√©r√™ts du grand capital. Sauf qu\'avec l\'inculpation pour blanchiment, la corruption ¬´ classique ¬ª n\'est plus une hypoth√®se.'},
    {t:'text',text:'Van Hees et Sofie Merckx ont d√©pos√© en janvier 2026 une proposition de commission d\'enqu√™te. Pas seulement le blanchiment ‚Äî les fonds libyens, le Kazakhgate, les march√©s publics. Quarante ans de syst√®me.'},
    {t:'evidence',id:'fortis'}
  ],
  choices:[
    {key:'A',text:'Assez d\'indices pour la confrontation ?',meta:'[6+ indices] ‚Üí ‚öîÔ∏è BOSS FIGHT',effects:{rhet:1},next:'boss_1',req:{evidence:6},reqFail:'Pas assez d\'indices encore.'},
    {key:'B',text:'Continuer √† accumuler les preuves. Le dossier doit √™tre en b√©ton.',meta:'‚Üí Sources du cash',effects:{arch:1},next:'act1_sources'}
  ]
},
act1_engels: { location:'Caf√© Belga ‚Äî Place Flagey', chapter:'Acte I', chapterTitle:'L\'alli√©',
  blocks:[
    {t:'text',text:'Philippe Engels vous retrouve au Caf√© Belga. Le journaliste qui a √©crit le livre <em>Le Clan Reynders</em>. Cofondateur de M√©dor. Laur√©at du prix Trace International. Cinq ans d\'enqu√™te dans les veines du syst√®me.'},
    {t:'dlg',text:'Le livre est sorti en avril 2021. 176 pages. Personne n\'a boug√©. Ni la justice, ni la politique, ni les m√©dias mainstream. Il a fallu que la Loterie Nationale ‚Äî la Loterie ! ‚Äî fasse le travail que personne n\'a voulu faire.',who:'Philippe Engels, M√©dor / Nationale 4'},
    {t:'thought',skill:'reseau',text:'Engels conna√Æt le dossier mieux que quiconque. L\'avoir comme alli√©, c\'est avoir acc√®s √† cinq ans de travail de terrain, de sources, de documents. C\'est la diff√©rence entre jouer solo et jouer en co-op.'},
    {t:'evidence',id:'surete-fonti'},
    {t:'text',text:'Il vous montre un article de M√©dor n¬∞39, juin 2025 : ¬´ D\'o√π vient l\'argent ? ¬ª. Un officier de police y est cit√© : <em>¬´ Pour savoir d\'o√π vient l\'argent de Reynders, il faut enqu√™ter sur le tandem Reynders-Fontinoy. ¬ª</em>'}
  ],
  choices:[
    {key:'A',text:'Travailler avec Engels sur la piste Fontinoy ‚Äî le tandem.',meta:'‚Üí Le Clan ¬∑ R√©seau +2',effects:{reseau:2},next:'act1_clan'},
    {key:'B',text:'Prendre vos distances. Garder votre ind√©pendance d\'enqu√™te.',meta:'‚Üí ING ¬∑ Solo ¬∑ Flair +1',effects:{flair:1},next:'act1_ing'}
  ]
},
act1_confrontation: { location:'Parking sous-terrain ‚Äî Quartier europ√©en', chapter:'Acte I', chapterTitle:'Face √† face',
  blocks:[
    {t:'text',text:'Un ancien collaborateur de Fontinoy √† la SNCB a accept√© de vous rencontrer. Pas dans un caf√© ‚Äî dans un parking souterrain. Il est nerveux.'},
    {t:'check',skill:'sang',dc:6,pass:'Vous restez calme. Votre posture inspire confiance. Il commence √† parler.',fail:'Votre tension est palpable. Il h√©site longuement avant de se lancer.'},
    {t:'dlg',text:'Fonti avait un bureau officieux au 12e √©tage de la SNCB. Pas de plaque. Pas de titre. Mais tout le monde savait que c\'est l√† que les d√©cisions se prenaient. Les promoteurs montaient, les contrats descendaient. Et l\'argent... l\'argent circulait.',who:'Ancien collaborateur SNCB, anonyme'},
    {t:'evidence',id:'audenaert'},
    {t:'text',text:'Il vous raconte la r√©union du 2 mai 2013 : Bart De Wever, Didier Reynders, Koen Blijweert et Jean-Claude Fontinoy, dans le ¬´ quartier g√©n√©ral ¬ª de la famille Blijweert. Objet : la transaction immobili√®re du RAC. Quatre hommes. Un deal immobilier. Et des dizaines de millions en jeu.'}
  ],
  choices:[
    {key:'A',text:'Direction les sources du cash. Fontinoy est la cl√©.',meta:'‚Üí D\'o√π vient l\'argent ? ¬∑ Flair +1',effects:{flair:1},next:'act1_sources'},
    {key:'B',text:'Aller directement au boss fight.',meta:'[7+ indices] ‚Üí ‚öîÔ∏è CONFRONTATION',effects:{},next:'boss_1',req:{evidence:7},reqFail:'Pas encore assez d\'indices.'}
  ]
},
act1_fontinoy_deep: { location:'Mozet, commune de Gesves ‚Äî Namur', chapter:'Acte I', chapterTitle:'La machine',
  blocks:[
    {t:'text',text:'Mozet. Village de la province de Namur. C\'est ici que vit Jean-Claude Fontinoy, 80 ans. Sa maison a √©t√© perquisitionn√©e en juin 2025. Vous n\'y entrerez pas, mais les voisins parlent.'},
    {t:'dlg',text:'Monsieur Fontinoy ? Oh il est discret. Mais il recevait du monde, hein. Des grosses voitures. Des costumes. Et il partait souvent tr√®s t√¥t le matin vers Bruxelles. Tous les jours. √Ä son √¢ge.',who:'Voisin, Mozet'},
    {t:'evidence',id:'gare-mons'},
    {t:'thought',skill:'arch',text:'La gare de Mons. L\'≈ìuvre embl√©matique du syst√®me Fontinoy. Budget initial : 37 millions. Budget final : 480 millions. Dix ans de retard. Un accord secret entre Fontinoy et Vincent Bourlard du PS. Et le 31 janvier 2025, √† l\'inauguration, Fontinoy ‚Äî 80 ans, sans aucun mandat officiel ‚Äî est photographi√© aux c√¥t√©s de l\'architecte Calatrava. Le fant√¥me au milieu de sa cath√©drale.'},
    {t:'text',text:'Seize jours plus tard, le 16 f√©vrier 2026, il est inculp√© pour association de malfaiteurs et faux en √©criture. La machine s\'est enfin arr√™t√©e.'}
  ],
  choices:[
    {key:'A',text:'Le dossier est complet. Direction la confrontation.',meta:'‚Üí ‚öîÔ∏è BOSS FIGHT',effects:{arch:1},next:'boss_1',req:{evidence:6},reqFail:'Encore quelques indices.'},
    {key:'B',text:'Revenir aux sources du cash pour consolider.',meta:'‚Üí Sources',effects:{flair:1},next:'act1_sources'}
  ]
}
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDERING ENGINE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

function show(id,d=0){document.querySelectorAll('.scr').forEach(s=>{s.classList.remove('on','vis')});setTimeout(()=>{const el=document.getElementById(id);el.classList.add('on');requestAnimationFrame(()=>requestAnimationFrame(()=>el.classList.add('vis')))},d)}

// ‚îÄ‚îÄ BOOT ‚îÄ‚îÄ
function boot(){
  const el=document.getElementById('bootScr');
  const lines=['> sys.init()','> Chargement des Parchemins de Bruxelles...','> D√©chiffrage des archives classifi√©es...','> 24 pi√®ces √† conviction index√©es','> 16 sc√®nes narratives charg√©es','> Moteur de skill checks : Disco Elysium Protocol‚Ñ¢','> Syst√®me d\'objection : Phoenix Wright Module‚Ñ¢','> ','> <span style="color:var(--red)">CLASSIFICATION: CITOYEN</span>','> <span style="color:var(--red)">DOSSIER: AFFAIRE REYNDERS</span>','> <span style="color:var(--red)">PR√âSOMPTION D\'INNOCENCE: ACTIVE</span>','> ','> Ready.<span style="display:inline-block;width:8px;height:14px;background:var(--sang);animation:blink 1s step-end infinite;vertical-align:middle;margin-left:2px"></span>'];
  const d=document.createElement('div');d.style.cssText='font-family:var(--mono);font-size:.65rem;color:var(--sang);max-width:500px;line-height:1.9;padding:2rem;text-align:left';
  el.style.cssText+='justify-content:center;align-items:center';el.appendChild(d);
  let i=0;const iv=setInterval(()=>{if(i<lines.length){d.innerHTML+=lines[i]+'\n';i++}else{clearInterval(iv);setTimeout(()=>{renderTitle();show('titleScr',300)},1800)}},160);
  show('bootScr');setTimeout(()=>el.classList.add('vis'),50);
}

// ‚îÄ‚îÄ TITLE ‚îÄ‚îÄ
function renderTitle(){
  document.getElementById('titleScr').innerHTML=`
  <div style="flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;padding:2rem;position:relative">
    <div style="position:absolute;inset:0;background:radial-gradient(ellipse at 30% 40%,rgba(196,56,56,.05) 0%,transparent 60%),radial-gradient(ellipse at 70% 60%,rgba(201,164,62,.03) 0%,transparent 50%)"></div>
    <div style="position:relative;z-index:1">
      <div style="font-family:var(--mono);font-size:.55rem;letter-spacing:.4em;color:var(--red);margin-bottom:1.5rem">RPG TEXTUEL D'INVESTIGATION</div>
      <h1 style="font-family:var(--sans);font-size:clamp(2rem,10vw,4.5rem);font-weight:900;line-height:.95;letter-spacing:-.03em;color:var(--bright)">LES<br>PARCHEMINS<br>DE BRUXELLES</h1>
      <p style="font-family:var(--serif);font-size:clamp(.9rem,3vw,1.3rem);font-style:italic;color:var(--dim);margin:1rem 0 2.5rem">L'Affaire Reynders</p>
      <p style="font-family:var(--sans);font-size:.8rem;color:var(--dim);max-width:380px;margin:0 auto 2rem;line-height:1.6">Disco Elysium √ó Phoenix Wright √ó Elder Scrolls. Incarnez un enqu√™teur. D√©veloppez vos comp√©tences. Collectez les indices. Confrontez le syst√®me.</p>
      <button onclick="renderCreate();show('createScreen',200)" style="font-family:var(--mono);font-size:.75rem;letter-spacing:.15em;text-transform:uppercase;padding:1rem 3rem;border:1px solid var(--gold);color:var(--gold);background:transparent;cursor:pointer;transition:all .3s;position:relative;overflow:hidden"><span style="position:relative;z-index:1">Nouvelle Partie</span></button>
      <p style="font-family:var(--mono);font-size:.5rem;color:var(--muted);margin-top:2.5rem;max-width:350px;line-height:1.6">‚öñÔ∏è Pr√©somption d'innocence ¬∑ Sources publiques ¬∑ CC BY-SA 4.0<br>ouaisfi.eu ¬∑ √âducation permanente</p>
    </div>
  </div>`;
}

// ‚îÄ‚îÄ CHARACTER CREATION (Disco Elysium) ‚îÄ‚îÄ
function renderCreate(){
  const pts=()=>G.points;
  const skHTML=Object.entries(SKILLS).map(([k,s])=>`
    <div class="skill-row" style="--skill-color:${s.color}">
      <div class="skill-row__top"><span class="skill-row__name">${s.name}</span><span class="skill-row__val" id="sv-${k}">${G.skills[k]}</span></div>
      <div class="skill-row__desc">${s.desc}</div>
      <div class="skill-row__controls">
        <button class="skill-btn" onclick="modSkill('${k}',-1)" id="sm-${k}">‚àí</button>
        <div class="skill-bar"><div class="skill-bar__fill" id="sb-${k}" style="width:${G.skills[k]*10}%;background:${s.color}"></div></div>
        <button class="skill-btn" onclick="modSkill('${k}',1)" id="sp-${k}">+</button>
      </div>
    </div>`).join('');

  const archetypes=[
    {icon:'üñäÔ∏è',name:'Journaliste',desc:'FLAIR 5 ¬∑ R√âSEAU 5',preset:{rhet:3,flair:5,reseau:5,sang:2,proc:2,arch:4}},
    {icon:'‚öñÔ∏è',name:'Juriste',desc:'PROC√âDURE 6 ¬∑ RH√âT 4',preset:{rhet:4,flair:3,reseau:2,sang:3,proc:6,arch:3}},
    {icon:'üîç',name:'Agent',desc:'SANG-FROID 5 ¬∑ ARCHIVE 5',preset:{rhet:2,flair:4,reseau:3,sang:5,proc:2,arch:5}}
  ];
  const archHTML=archetypes.map((a,i)=>`
    <button class="arch-btn" onclick="applyArch(${i})">
      <div class="arch-btn__icon">${a.icon}</div>
      <div class="arch-btn__name">${a.name}</div>
      <div class="arch-btn__desc">${a.desc}</div>
    </button>`).join('');

  document.getElementById('createScreen').innerHTML=`
    <div class="create-title">Qui √™tes-vous ?</div>
    <div class="create-sub">R√©partissez vos points de comp√©tence. Chaque skill vous parlera pendant l'enqu√™te.</div>
    <div class="create-points">Points restants : <strong id="ptsLeft">${G.points}</strong></div>
    <div class="skill-grid">${skHTML}</div>
    <div class="archetype-section">
      <div class="archetype-title">Ou choisissez un arch√©type</div>
      <div class="archetype-grid">${archHTML}</div>
    </div>
    <button class="btn-create" id="btnCreate" onclick="startGame()">Commencer l'enqu√™te</button>`;
  window._archetypes=archetypes;
  updateCreate();
}

function modSkill(k,d){
  const nv=G.skills[k]+d;
  if(nv<1||nv>8)return;
  if(d>0&&G.points<=0)return;
  G.skills[k]=nv;G.points-=d;
  updateCreate();
}
function applyArch(i){
  const a=window._archetypes[i];
  const total=Object.values(a.preset).reduce((s,v)=>s+v,0);
  G.points=24-total;
  Object.assign(G.skills,a.preset);
  updateCreate();
}
function updateCreate(){
  document.getElementById('ptsLeft').textContent=G.points;
  Object.keys(SKILLS).forEach(k=>{
    document.getElementById(`sv-${k}`).textContent=G.skills[k];
    document.getElementById(`sb-${k}`).style.width=(G.skills[k]*10)+'%';
    document.getElementById(`sm-${k}`).disabled=G.skills[k]<=1;
    document.getElementById(`sp-${k}`).disabled=G.points<=0||G.skills[k]>=8;
  });
}

// ‚îÄ‚îÄ START GAME ‚îÄ‚îÄ
function startGame(){
  G.scene='prologue_1';G.evidence=new Set();G.achievements=new Set();G.history=[];G.hp=100;G.flags={};
  xp=0;level=1;updateXPBar();
  renderScene();show('gameScreen',300);showTip();
}

// ‚îÄ‚îÄ MAP HUB ‚îÄ‚îÄ
function showMap(){
  const visited = new Set(G.history);
  const locations = [
    { id:'act1_ing', zone:'QUARTIER EUROP√âEN', name:'Si√®ge ING ‚Äî Avenue Marnix', desc:'La banque qui a gard√© un secret de 800K‚Ç¨ pendant 10 ans.', req:null, icon:'üè¶' },
    { id:'act1_clan', zone:'LE SABLON', name:'Galerie Theunissen & Caf√©', desc:'Le triangle du Sablon : antiquaires, cash et connexions quotidiennes.', req:null, icon:'üñºÔ∏è' },
    { id:'act1_source', zone:'SAINT-GILLES', name:'Votre planque ‚Äî Analyse', desc:'Examiner la cl√© USB et ses secrets.', req:null, icon:'üíª' },
    { id:'act1_loterie', zone:'CENTRE', name:'Loterie Nationale ‚Äî Bld Anspach', desc:'L√† o√π le cash devient ¬´ gains l√©gitimes ¬ª.', req:()=>G.evidence.has('cash-ing')||G.evidence.has('loterie'), icon:'üé∞' },
    { id:'act1_protection', zone:'RUE DE LA LOI', name:'Archives ‚Äî Chambre des Repr√©sentants', desc:'Le r√©seau de placement : qui contr√¥le quoi, et pour qui.', req:null, icon:'üèõÔ∏è' },
    { id:'act1_ullens', zone:'CINQUANTENAIRE', name:'Parc du Cinquantenaire ‚Äî Banc isol√©', desc:'L\'agent de la S√ªret√© r√©duit au silence.', req:()=>G.skills.sang>=4, icon:'üîç' },
    { id:'act1_kazakh', zone:'ARCHIVES', name:'Commission Kazakhgate (2017-18)', desc:'L\'affaire d\'√âtat : oligarques, milliards et lois sur mesure.', req:()=>G.evidence.size>=3, icon:'üìú' },
    { id:'act1_engels', zone:'FLAGEY', name:'Caf√© Belga ‚Äî Place Flagey', desc:'Philippe Engels, le journaliste qui sait tout. Alliance possible.', req:null, icon:'üñäÔ∏è' },
    { id:'act1_parlement', zone:'RUE DE LA LOI', name:'Commission des Finances', desc:'Questions sans r√©ponse. 20 ans de dossier.', req:()=>G.evidence.size>=4, icon:'‚öñÔ∏è' },
    { id:'boss_1', zone:'‚öîÔ∏è BOSS FIGHT', name:'Commission Parlementaire ‚Äî Confrontation', desc:'Vous avez les preuves ? Affrontez le syst√®me.', req:()=>G.evidence.size>=7, icon:'‚öîÔ∏è', isBoss:true }
  ];

  const locHTML = locations.map(loc => {
    const been = visited.has(loc.id);
    const locked = loc.req && !loc.req();
    const tagClass = loc.isBoss ? 'boss' : been ? 'done' : 'new';
    const tagText = loc.isBoss ? '‚öîÔ∏è BOSS' : been ? '‚úì VISIT√â' : '‚óè NOUVEAU';
    return `<div class="map-loc ${been?'visited':''} ${locked?'locked':''}" ${locked?'':`onclick="goToScene('${loc.id}')"`}>
      <div class="map-loc__zone">${loc.icon} ${loc.zone}</div>
      <div class="map-loc__name">${loc.name}</div>
      <div class="map-loc__desc">${locked?'üîí Conditions non remplies':loc.desc}</div>
      <div class="map-loc__tag ${tagClass}">${locked?'üîí':tagText}</div>
    </div>`;
  }).join('');

  document.getElementById('mapScreen').innerHTML = `<div class="map-hub">
    <div class="map-header">
      <h2>üó∫Ô∏è Carte de Bruxelles</h2>
      <p>Niveau ${level} ¬∑ ${G.evidence.size} indices ¬∑ Choisissez votre prochaine destination</p>
    </div>
    <div style="text-align:center;margin-bottom:1rem">
      <button class="g-btn" style="display:inline-flex;width:auto;padding:0 .8rem;font-family:var(--mono);font-size:.6rem;gap:.3rem" onclick="openCodex()">üìñ Codex</button>
      <button class="g-btn" style="display:inline-flex;width:auto;padding:0 .8rem;font-family:var(--mono);font-size:.6rem;gap:.3rem" onclick="openQuests()">üìã Qu√™tes</button>
      <button class="g-btn" style="display:inline-flex;width:auto;padding:0 .8rem;font-family:var(--mono);font-size:.6rem;gap:.3rem" onclick="openStats()">üìä Stats</button>
      <button class="g-btn" style="display:inline-flex;width:auto;padding:0 .8rem;font-family:var(--mono);font-size:.6rem;gap:.3rem" onclick="openEvid()">üóÇÔ∏è Indices</button>
    </div>
    <div class="map-grid">${locHTML}</div>
    <div style="text-align:center;margin-top:2rem;font-family:var(--mono);font-size:.55rem;color:var(--muted)">
      ¬´ A man chooses, a slave obeys. ¬ª ‚Äî Bienvenue √† Bruxelles.
    </div>
  </div>`;
  show('mapScreen', 200);
  showTip();
}

function goToScene(id) {
  G.scene = id;
  renderScene();
  show('gameScreen', 200);
}

// ‚îÄ‚îÄ CODEX OVERLAY ‚îÄ‚îÄ
function openCodex() {
  const ov = document.getElementById('codexOv');
  if(ov.classList.contains('on')){ov.classList.remove('on');return}
  const unlocked = getUnlockedCodex();
  const allEntries = Object.entries(CODEX);
  let html = allEntries.map(([id,c]) => {
    const isUnlocked = unlocked.some(([uid])=>uid===id);
    const oc = isUnlocked ? ' onclick="this.nextElementSibling.classList.toggle(\'open\')"' : '';
    const cls = isUnlocked ? '' : ' lock';
    const nm = isUnlocked ? c.name : '???';
    const co = isUnlocked ? c.color : 'var(--muted)';
    const bd = isUnlocked ? '<p>'+c.text+'</p><div class="codex-ref">'+c.ref+'</div>' : '';
    return '<div class="codex-entry'+cls+'"><div class="codex-head"'+oc+'><span class="codex-head__name">'+nm+'</span><span class="codex-head__cat" style="color:'+co+'">'+c.cat+'</span></div><div class="codex-body">'+bd+'</div></div>';
  }).join('');

  ov.innerHTML = `<div class="ov-header"><h3>üìñ Codex ‚Äî Bestiaire de Bruxelles</h3><button class="ov-close" onclick="this.closest('.overlay').classList.remove('on')">‚úï</button></div>
    <div style="font-family:var(--mono);font-size:.65rem;color:var(--gold);margin-bottom:1rem">${unlocked.length} / ${allEntries.length} entr√©es d√©bloqu√©es</div>
    <div class="codex-grid">${html}</div>`;
  ov.classList.add('on');
}

// ‚îÄ‚îÄ QUEST OVERLAY ‚îÄ‚îÄ
function openQuests() {
  const ov = document.getElementById('questOv');
  if(ov.classList.contains('on')){ov.classList.remove('on');return}
  let html = Object.entries(QUESTS).map(([id,q]) => {
    const done = q.check();
    return `<div class="quest ${done?'done':'active'}">
      <div class="quest__name">${done?'‚úì':id.startsWith('side')?'‚óá':'‚óÜ'} ${q.name}</div>
      <div class="quest__desc">${q.desc}</div>
      <div class="quest__prog">${done?'COMPL√âT√âE':'EN COURS'}</div>
    </div>`;
  }).join('');
  ov.innerHTML = `<div class="ov-header"><h3>üìã Journal de qu√™tes</h3><button class="ov-close" onclick="this.closest('.overlay').classList.remove('on')">‚úï</button></div>${html}
    <div style="font-family:var(--mono);font-size:.55rem;color:var(--muted);text-align:center;margin-top:1rem">
      ¬´ The right man in the wrong place can make all the difference in the world. ¬ª ‚Äî G-Man
    </div>`;
  ov.classList.add('on');
}

// ‚îÄ‚îÄ RENDER SCENE ‚îÄ‚îÄ
function renderScene(){
  const sc=SCENES[G.scene];if(!sc)return;
  if(sc.type==='ending'){renderEnding(sc);return}
  if(sc.onEnter)sc.onEnter();
  if(!G.history.includes(G.scene)) G.history.push(G.scene);

  // XP for visiting new scene
  if(!G.flags['visited_'+G.scene]){G.flags['visited_'+G.scene]=true;addXP(5,'Nouvelle sc√®ne explor√©e')}

  let html=`<div class="g-top">
    <div><div class="g-top__loc">üìç ${sc.location}</div><div class="g-top__ch">${sc.chapter} ‚Äî ${sc.chapterTitle}</div></div>
    <div class="g-top__btns">
      <button class="g-btn" onclick="openCodex()" title="Codex">üìñ</button>
      <button class="g-btn" onclick="openStats()" title="Stats">üìä</button>
      <button class="g-btn${G.evidence.size>0?' has-new':''}" onclick="openEvid()" title="Indices">üóÇÔ∏è</button>
      <button class="g-btn" onclick="openQuests()" title="Qu√™tes">üìã</button>
    </div>
  </div><div class="g-body">`;

  sc.blocks.forEach(b=>{
    if(b.t==='text') html+=`<div class="nb"><div class="nt">${b.text}</div></div>`;
    else if(b.t==='dlg') html+=`<div class="nb"><div class="dlg"><div class="dlg__text">${b.text}</div><div class="dlg__who">‚Äî ${b.who}</div></div></div>`;
    else if(b.t==='sys') html+=`<div class="nb"><div class="sys-msg">${b.text}</div></div>`;
    else if(b.t==='thought'){
      const sk=SKILLS[b.skill];
      html+=`<div class="nb"><div class="skill-thought" style="--thought-color:${sk.color};--thought-bg:${sk.bg}"><div class="skill-thought__label">${sk.name} [${G.skills[b.skill]}]</div>${b.text}</div></div>`;
    }
    else if(b.t==='evidence'){
      const ev=EVIDENCE[b.id];if(!ev)return;
      const isNew = !G.evidence.has(b.id);
      G.evidence.add(b.id);
      if(isNew) {
        addXP(10,'Indice collect√© : '+ev.name);
        if(G.evidence.size===1) achieve('first_blood','First Blood','Premier indice collect√©. L\'enqu√™te commence.');
        if(G.evidence.size===5) achieve('collector','Le Collectionneur','5 indices en poche. Vous y voyez plus clair.');
        if(G.evidence.size===10) achieve('obsessed','Obs√©d√© textuel','10 indices. Vous ne dormez plus.');
        if(G.evidence.size===15) achieve('archivist','L\'Archiviste','15 indices. La m√©moire du syst√®me.');
        if(G.evidence.size>=20) achieve('completionist','The Completionist','20+ indices. Respect.');
      }
      html+=`<div class="nb"><div class="ev-found"><div class="ev-found__tag">‚óÜ ${isNew?'INDICE COLLECT√â':'INDICE (d√©j√† obtenu)'} ‚Äî ${ev.tag}</div><div class="ev-found__name">${ev.name}</div><div class="ev-found__desc">${ev.desc}</div></div></div>`;
    }
    else if(b.t==='check'){
      const sk=SKILLS[b.skill];const val=G.skills[b.skill];const pass=val>=b.dc;
      const labels=['Trivial','Facile','Moyen','Difficile','Tr√®s difficile','H√©ro√Øque','L√©gendaire'];
      const diff=labels[Math.min(Math.max(b.dc-2,0),6)];
      if(pass) addXP(8,'Skill check r√©ussi');
      html+=`<div class="nb"><div class="skill-check"><div class="skill-check__label">[${diff.toUpperCase()}: ${sk.name} ${b.dc}]</div><div class="skill-check__name" style="color:${sk.color}">Votre ${sk.name} : ${val}</div><div class="skill-check__result ${pass?'pass':'fail'}">${pass?'‚úì R√âUSSI':'‚úó √âCHOU√â'}</div></div><div class="nt" style="margin-top:.8rem">${pass?b.pass:b.fail}</div></div>`;
    }
    else if(b.t==='codec'){
      html+=`<div class="nb"><div style="background:rgba(0,40,0,.2);border:1px solid var(--sang);padding:1.2rem;text-align:center"><div style="font-family:var(--mono);font-size:.55rem;letter-spacing:.2em;color:var(--sang);margin-bottom:.5rem">üìû CODEC ‚Äî ${b.name}</div><div style="font-size:2rem;margin-bottom:.5rem">${b.icon}</div><div style="font-family:var(--serif);font-size:.9rem;color:#aaffaa;line-height:1.6;font-style:italic;text-align:left">${b.text}</div></div></div>`;
    }
  });

  // BOSS FIGHT
  if(sc.isBoss){
    html+=renderBoss(sc);
  }
  // Normal choices
  else if(sc.choices){
    const letters=['A','B','C','D'];
    html+=`<div class="choices"><div class="choices__label">‚ñ∏ Que faites-vous ?</div>`;
    sc.choices.forEach((c,i)=>{
      let locked=false;let lockMsg='';
      if(c.req){
        if(c.req.evidence&&G.evidence.size<c.req.evidence){locked=true;lockMsg=c.reqFail}
        Object.entries(c.req).forEach(([k,v])=>{if(k!=='evidence'&&G.skills[k]<v){locked=true;lockMsg=c.reqFail}});
      }
      const reqText=c.req?Object.entries(c.req).map(([k,v])=>k==='evidence'?`${v}+ indices`:`${SKILLS[k]?.name||k} ‚â• ${v}`).join(' ¬∑ '):'';
      html+=`<button class="ch-btn ${locked?'locked':''}" ${locked?'disabled':''}onclick="choose('${G.scene}',${i})">
        <div class="ch-btn__key">Option ${letters[i]}</div>
        <div class="ch-btn__text">${c.text}</div>
        <div class="ch-btn__meta">${c.meta}${reqText?' ¬∑ <span class="ch-btn__req">['+reqText+']</span>':''}</div>
        ${locked?'<div style="font-family:var(--mono);font-size:.55rem;color:var(--red);margin-top:.3rem">üîí '+lockMsg+'</div>':''}
      </button>`;
    });
    // MAP RETURN button (not for prologue)
    if(G.scene !== 'prologue_1') {
      html+=`<button class="ch-btn" style="border-color:var(--arch);margin-top:.5rem" onclick="showMap()">
        <div class="ch-btn__key" style="color:var(--arch)">üó∫Ô∏è Carte</div>
        <div class="ch-btn__text">Retourner √† la carte de Bruxelles</div>
        <div class="ch-btn__meta">Choisir une autre destination ¬∑ Explorer librement</div>
      </button>`;
    }
    html+=`</div>`;
  }

  html+=`</div>`;
  document.getElementById('gameScreen').innerHTML=html;
  window.scrollTo(0,0);
  autoSave();
}

// ‚îÄ‚îÄ BOSS FIGHT RENDERER ‚îÄ‚îÄ
let bossPhase=0;
function renderBoss(sc){
  bossPhase=0;G.bossHP=sc.bossHP;
  let html=`<div class="boss-area" id="bossArea">
    <div class="boss-health"><div class="boss-health__label"><span>${sc.bossName}</span><span id="bossHPText">${G.bossHP}%</span></div>
    <div class="boss-health__bar"><div class="boss-health__fill" id="bossHPBar" style="width:${G.bossHP}%"></div></div></div>
    <div id="bossContent"></div></div>`;
  setTimeout(()=>renderBossPhase(sc),500);
  return html;
}
function renderBossPhase(sc){
  const content=document.getElementById('bossContent');
  if(!content)return;
  if(bossPhase>=sc.bossPhases.length){
    // Victory check
    if(G.bossHP<=0){
      content.innerHTML=`<div class="nt">${sc.victory.text}</div><button class="btn-create" style="margin-top:1rem" onclick="G.scene='${sc.victory.next}';renderScene();show('gameScreen')">Continuer</button>`;
    }else{
      content.innerHTML=`<div class="nt">${sc.defeat.text}</div><button class="btn-create" style="margin-top:1rem" onclick="G.scene='${sc.defeat.next}';renderScene();show('gameScreen')">Continuer</button>`;
    }
    return;
  }
  const phase=sc.bossPhases[bossPhase];
  const available=[...G.evidence].map(id=>EVIDENCE[id]).filter(Boolean);
  const evHTML=available.map(ev=>{
    const id=[...G.evidence].find(k=>EVIDENCE[k]===ev);
    return`<button class="ev-opt" onclick="bossPresent('${id}')"><div class="ev-opt__tag">${ev.tag}</div><div class="ev-opt__name">${ev.name}</div></button>`;
  }).join('');

  content.innerHTML=`
    <div class="dlg"><div class="dlg__text">${phase.text}</div><div class="dlg__who">‚Äî ${phase.who}</div></div>
    <div style="font-family:var(--mono);font-size:.6rem;color:var(--gold);text-align:center;margin:1rem 0;letter-spacing:.15em">PR√âSENTEZ UN INDICE POUR CONTRER</div>
    <div class="ev-select">${evHTML}</div>`;
  window._currentScene=sc;
}
function bossPresent(evidenceId){
  const sc=window._currentScene;
  const phase=sc.bossPhases[bossPhase];
  const correct=phase.correctEvidence.includes(evidenceId);
  const content=document.getElementById('bossContent');

  if(correct){
    G.bossHP=Math.max(0,G.bossHP-phase.damage);
    document.getElementById('bossHPBar').style.width=G.bossHP+'%';
    document.getElementById('bossHPText').textContent=G.bossHP+'%';
    addXP(20,'OBJECTION r√©ussie !');
    // Show OBJECTION
    const obj=document.createElement('div');obj.className='objection on';obj.innerHTML='<h2>OBJECTION !</h2>';
    document.body.appendChild(obj);
    setTimeout(()=>{obj.remove();
      content.innerHTML=`<div class="nt" style="color:var(--sang)">${phase.rightResponse}</div>
        <button class="btn-create" style="margin-top:1rem" onclick="advanceBoss()">Continuer ‚ñ∏</button>`;
    },1200);
  }else{
    G.hp=Math.max(0,G.hp-15);
    content.innerHTML=`<div class="nt" style="color:var(--red)">${phase.wrongResponse}</div>
      <div style="font-family:var(--mono);font-size:.7rem;color:var(--red);text-align:center;margin:.5rem 0">Cr√©dibilit√© -15 (${G.hp}/100)</div>
      <button class="btn-create" style="margin-top:.5rem" onclick="advanceBoss()">Continuer ‚ñ∏</button>`;
    if(G.hp<=0){
      setTimeout(()=>{
        document.getElementById('deathScreen').classList.add('on');
      },800);
      return;
    }
  }
}
function advanceBoss(){bossPhase++;renderBossPhase(window._currentScene)}

// ‚îÄ‚îÄ RESPAWN (Dark Souls bonfire) ‚îÄ‚îÄ
function respawn(){
  document.getElementById('deathScreen').classList.remove('on');
  G.hp=50;
  showMap();
  showTip('üî• Vous renaissez au feu de camp. Votre cr√©dibilit√© est √† 50%. Collectez plus d\'indices avant de retenter.');
}

// ‚îÄ‚îÄ CHOICES ‚îÄ‚îÄ
function choose(sceneId,idx){
  const sc=SCENES[sceneId];const c=sc.choices[idx];
  if(c.effects){
    Object.entries(c.effects).forEach(([k,v])=>{
      if(SKILLS[k]){
        G.skills[k]=Math.min(10,Math.max(0,G.skills[k]+v));
        statNotif(SKILLS[k].name,v);
      }
    });
  }
  if(c.evidence)G.evidence.add(c.evidence);
  if(c.tip)showTip(c.tip);
  addXP(3,'Choix effectu√©');

  // Check quest completion
  Object.entries(QUESTS).forEach(([id,q])=>{
    if(!G.flags['quest_'+id] && q.check()){
      G.flags['quest_'+id]=true;
      achieve('quest_'+id,'Qu√™te compl√©t√©e',''+q.name);
      addXP(15,'Qu√™te compl√©t√©e');
    }
  });

  G.scene=c.next;

  // If coming from prologue, show map after first scene
  if(sceneId==='prologue_1'){
    setTimeout(()=>{renderScene();show('gameScreen',200);
      // After first scene played, unlock map
      G.flags.mapUnlocked=true;
    },300);
    return;
  }

  setTimeout(()=>{
    renderScene();
    window.scrollTo({top:0,behavior:'smooth'});
  },300);
}

// ‚îÄ‚îÄ STAT NOTIFICATION ‚îÄ‚îÄ
function statNotif(name,d){
  const el=document.createElement('div');
  el.className=`sc-notif ${d>0?'pos':'neg'}`;
  el.textContent=`${name} ${d>0?'+':''}${d}`;
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),2400);
}

// ‚îÄ‚îÄ ACHIEVEMENT ‚îÄ‚îÄ
function achieve(id,title,desc){
  if(G.achievements.has(id))return;G.achievements.add(id);
  const pop=document.getElementById('achievePop');
  pop.querySelector('.ach-title').textContent=title;
  pop.querySelector('.ach-desc').textContent=desc;
  pop.classList.add('show');
  setTimeout(()=>pop.classList.remove('show'),3500);
}

// ‚îÄ‚îÄ TIPS ‚îÄ‚îÄ
function showTip(custom){
  const text=custom||TIPS[Math.floor(Math.random()*TIPS.length)];
  document.getElementById('tipText').textContent=text;
  const el=document.getElementById('loadTip');el.classList.add('show');
  setTimeout(()=>el.classList.remove('show'),5000);
}

// ‚îÄ‚îÄ STATS OVERLAY ‚îÄ‚îÄ
function openStats(){
  const ov=document.getElementById('statsOv');
  if(ov.classList.contains('on')){ov.classList.remove('on');return}
  const colors={rhet:'var(--rhet)',flair:'var(--flair)',reseau:'var(--reseau)',sang:'var(--sang)',proc:'var(--proc)',arch:'var(--arch)'};
  let rows=Object.entries(SKILLS).map(([k,s])=>`
    <div class="os-row"><div class="os-row__top"><span class="os-row__name" style="color:${colors[k]}">${s.name}</span><span class="os-row__val" style="color:${colors[k]}">${G.skills[k]}/10</span></div>
    <div class="os-row__bar"><div class="os-row__fill" style="width:${G.skills[k]*10}%;background:${colors[k]}"></div></div>
    <div class="os-row__hint">${s.desc}</div></div>`).join('');

  const xpPct = Math.round((xp / (level * XP_PER_LEVEL)) * 100);
  const questsDone = Object.values(QUESTS).filter(q=>q.check()).length;

  ov.innerHTML=`<div class="ov-header"><h3>üìä Fiche d'enqu√™teur</h3><button class="ov-close" onclick="this.closest('.overlay').classList.remove('on')">‚úï</button></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:.6rem;margin-bottom:1.5rem">
      <div style="background:var(--bg2);border:1px solid var(--bg4);padding:.8rem;text-align:center">
        <div style="font-family:var(--sans);font-size:1.5rem;font-weight:900;color:var(--gold)">${level}</div>
        <div style="font-family:var(--mono);font-size:.5rem;color:var(--muted);letter-spacing:.1em">NIVEAU</div>
      </div>
      <div style="background:var(--bg2);border:1px solid var(--bg4);padding:.8rem;text-align:center">
        <div style="font-family:var(--sans);font-size:1.5rem;font-weight:900;color:var(--bright)">${G.evidence.size}</div>
        <div style="font-family:var(--mono);font-size:.5rem;color:var(--muted);letter-spacing:.1em">INDICES</div>
      </div>
      <div style="background:var(--bg2);border:1px solid var(--bg4);padding:.8rem;text-align:center">
        <div style="font-family:var(--sans);font-size:1.5rem;font-weight:900;color:var(--sang)">${G.achievements.size}</div>
        <div style="font-family:var(--mono);font-size:.5rem;color:var(--muted);letter-spacing:.1em">TROPH√âES</div>
      </div>
      <div style="background:var(--bg2);border:1px solid var(--bg4);padding:.8rem;text-align:center">
        <div style="font-family:var(--sans);font-size:1.5rem;font-weight:900;color:var(--proc)">${questsDone}/${Object.keys(QUESTS).length}</div>
        <div style="font-family:var(--mono);font-size:.5rem;color:var(--muted);letter-spacing:.1em">QU√äTES</div>
      </div>
    </div>
    <div style="margin-bottom:1.5rem">
      <div style="font-family:var(--mono);font-size:.6rem;color:var(--gold);margin-bottom:.3rem">XP: ${xp} / ${level*XP_PER_LEVEL} (${xpPct}%)</div>
      <div style="height:4px;background:var(--bg);border-radius:2px;overflow:hidden"><div style="height:100%;background:var(--gold);width:${xpPct}%;border-radius:2px;transition:width .3s"></div></div>
    </div>
    <div style="font-family:var(--mono);font-size:.6rem;color:var(--dim);margin-bottom:1rem;letter-spacing:.1em">COMP√âTENCES</div>
    ${rows}
    <div style="margin-top:1.5rem;font-family:var(--mono);font-size:.55rem;color:var(--muted);text-align:center">
      Cr√©dibilit√© : ${G.hp}/100 ¬∑ Sc√®nes visit√©es : ${G.history.length}<br>
      ¬´ I'm Commander Shepard, and this is my favorite dossier on the Citadel. ¬ª
    </div>`;
  ov.classList.add('on');
}

// ‚îÄ‚îÄ EVIDENCE OVERLAY ‚îÄ‚îÄ
function openEvid(){
  const ov=document.getElementById('evidOv');
  if(ov.classList.contains('on')){ov.classList.remove('on');return}
  let items='';
  Object.entries(EVIDENCE).forEach(([id,ev])=>{
    const has=G.evidence.has(id);
    items+=`<div class="evi ${has?'':'lock'}"><div class="evi__tag" style="color:${has?ev.c:'var(--muted)'}">${has?ev.tag:'???'}</div><div class="evi__name">${has?ev.name:'Indice verrouill√©'}</div><div class="evi__desc">${has?ev.desc:'Continuez l\'enqu√™te.'}</div></div>`;
  });
  ov.innerHTML=`<div class="ov-header"><h3>Tableau d'indices</h3><button class="ov-close" onclick="this.closest('.overlay').classList.remove('on')">‚úï</button></div>
    <div style="font-family:var(--mono);font-size:.7rem;color:var(--gold);margin-bottom:1rem">${G.evidence.size} / ${Object.keys(EVIDENCE).length} collect√©s</div>
    ${items}`;
  ov.classList.add('on');
}

// ‚îÄ‚îÄ ENDING ‚îÄ‚îÄ
function renderEnding(sc){
  const questsDone = Object.values(QUESTS).filter(q=>q.check()).length;
  const codexUnlocked = getUnlockedCodex().length;
  const totalCodex = Object.keys(CODEX).length;
  const completionPct = Math.round(((G.evidence.size + codexUnlocked + questsDone + G.achievements.size) / (Object.keys(EVIDENCE).length + totalCodex + Object.keys(QUESTS).length + 10)) * 100);

  const achList = [...G.achievements].map(a => `<span style="color:var(--gold)">üèÜ ${a}</span>`).join(' ¬∑ ');

  document.getElementById('endScreen').innerHTML=`
    <div class="end-badge">${sc.badge}</div>
    <h2 class="end-title">${sc.title}</h2>
    <p class="end-text">${sc.text}</p>
    <div class="end-stats">
      <div class="end-s"><div class="end-s__v">${level}</div><div class="end-s__l">Niveau</div></div>
      <div class="end-s"><div class="end-s__v">${G.evidence.size}/${Object.keys(EVIDENCE).length}</div><div class="end-s__l">Indices</div></div>
      <div class="end-s"><div class="end-s__v">${codexUnlocked}/${totalCodex}</div><div class="end-s__l">Codex</div></div>
      <div class="end-s"><div class="end-s__v">${questsDone}/${Object.keys(QUESTS).length}</div><div class="end-s__l">Qu√™tes</div></div>
      <div class="end-s"><div class="end-s__v">${G.achievements.size}</div><div class="end-s__l">Troph√©es</div></div>
      <div class="end-s"><div class="end-s__v">${G.history.length}</div><div class="end-s__l">Sc√®nes</div></div>
      <div class="end-s"><div class="end-s__v">${Math.max(...Object.values(G.skills))}</div><div class="end-s__l">Max Skill</div></div>
      <div class="end-s"><div class="end-s__v">${completionPct}%</div><div class="end-s__l">Compl√©tion</div></div>
    </div>
    ${achList ? `<div style="font-family:var(--mono);font-size:.55rem;color:var(--dim);margin-bottom:1.5rem;max-width:400px;line-height:2">${achList}</div>` : ''}
    <div class="end-btns">
      <button class="end-btn" onclick="G.skills={rhet:3,flair:3,reseau:3,sang:3,proc:3,arch:3};G.points=6;renderCreate();show('createScreen',200)">üîÑ New Game</button>
      <button class="end-btn" onclick="ngPlus()" style="border-color:var(--gold);color:var(--gold)">‚≠ê New Game+</button>
    </div>
    <div style="font-family:var(--mono);font-size:.55rem;color:var(--muted);margin:1.5rem auto 0;max-width:400px;text-align:center">
      ${completionPct < 50 ? '¬´ Your princess is in another castle. ¬ª ‚Äî Il reste beaucoup √† d√©couvrir. Rejouez avec un autre build.' : ''}
      ${completionPct >= 50 && completionPct < 80 ? '¬´ Not bad, kid. ¬ª ‚Äî Han Solo approuverait. Mais il reste des indices cach√©s.' : ''}
      ${completionPct >= 80 ? '¬´ You\'re pretty good. ¬ª ‚Äî Revolver Ocelot. Vous avez presque tout trouv√©.' : ''}
    </div>
    <div class="end-cta">
      <strong style="color:var(--bright)">Ce jeu est bas√© sur des faits r√©els.</strong><br>
      Toutes les informations proviennent de sources judiciaires et m√©diatiques publiques.<br>
      Pr√©somption d'innocence pour toutes les personnes mentionn√©es.<br><br>
      üìñ <a href="https://medor.coop" target="_blank">M√©dor</a> ¬∑ <a href="https://pour.press/didier-reynders-lhomme-qui-parle-a-la-poche-des-riches/" target="_blank">POUR.press</a> ¬∑ <a href="https://bx1.be" target="_blank">BX1</a><br>
      üèõÔ∏è <a href="https://www.ptb.be/presse/la-commission-finances-examine-la-proposition-du-ptb-pour-une-commission-denquete-sur" target="_blank">Proposition commission d'enqu√™te PTB</a><br><br>
      <span style="font-family:var(--mono);font-size:.55rem;color:var(--muted)">ouaisfi.eu ¬∑ Les Parchemins de Bruxelles v1.0 ¬∑ CC BY-SA 4.0</span>
    </div>`;
  show('endScreen',300);
  achieve('acte1','Acte I compl√©t√©','Vous avez termin√© le premier acte.');
}

// ‚îÄ‚îÄ NEW GAME+ ‚îÄ‚îÄ
function ngPlus() {
  // Keep skills but reset story
  G.scene='prologue_1';
  G.evidence=new Set();
  G.history=[];
  G.hp=100;
  G.flags={ng_plus:true};
  xp=0;
  // Bonus: +1 to all skills in NG+
  Object.keys(G.skills).forEach(k=>G.skills[k]=Math.min(10,G.skills[k]+1));
  achieve('ng_plus','New Game+','La boucle temporelle commence. +1 √† toutes les comp√©tences.');
  renderScene();
  show('gameScreen',300);
  showTip('New Game+ activ√©. Vos comp√©tences ont √©t√© augment√©es. ¬´ Time is a flat circle. ¬ª ‚Äî Rust Cohle');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INIT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
boot();
</script>
</body>
</html>
